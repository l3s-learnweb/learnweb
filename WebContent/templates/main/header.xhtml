<html xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core" xmlns:p="http://primefaces.org/ui">

<ui:composition>

	<header id="header">
	
		<link rel="stylesheet" type="text/css" href="#{request.contextPath}/resources/css/tooltipster.css"></link>
		<script type="text/javascript" src="#{request.contextPath}/resources/js/jquery.tooltipster.min.js"></script>
		
		<script>

		$(document).ready(function() {

			   // first on page load, initiate the Tooltipster plugin
			   $('.tooltip').tooltipster({
				   animation: 'fall',
				   delay: 200,
				   theme: 'tooltipster-default',
				   touchDevices: false,
				   trigger: 'hover'
				});

			   // then immediately show the tooltip
			  $('.tooltip').tooltipster('show');

			   // as soon as a key is pressed on the keyboard, hide the tooltip.
			  $(window).keypress(function() {
			      $('.tooltip').tooltipster('hide');
			   });
		});
    	</script>
	
		<div id="main_menu_bar" style="background-color: #{menuBean.bannerColor}; #{menuBean.bannerImage}">			
		
			<img src="#{request.contextPath}/resources/main-template/img/ajax-loader.gif" alt="Loading" id="loadingsymbol"/>
			<p:ajaxStatus onstart="document.getElementById('loadingsymbol').style.visibility='visible';" onsuccess="document.getElementById('loadingsymbol').style.visibility='hidden';" />			
		 
			<form action="#{request.contextPath}/lw/search.jsf" method="get" onsubmit="removeViewstate(this);" id="searchform">
				<a href="#{menuBean.bannerLink}" id="learnweb_logo">Logo</a>
				<input type="search" name="query" value="#{searchBean.query}" size="50" maxlength="100" id="searchfield" />
				<input type="hidden" name="action" value="#{searchBean.searchMode}" />
				<input type="submit" value=" " id="searchbutton" title="#{msg.searchLabel}" />
			</form>
			<div class="userbar">
				<ul>
					<li>
						<a href="#{request.contextPath}/lw/myhome/resources.jsf" id="myresources">
							<h:outputText value="#{msg.myResourcesTitle}" />
						</a>
					</li>
					<li>
						<a href="#{request.contextPath}/lw/myhome/groups.jsf" id="mygroups">
							<h:outputText value="#{msg.groupOverview}" />
						</a>
					</li>
					<li>
						<a href="#{request.contextPath}/lw/myhome/activity.jsf" id="activitystream">
							<h:outputText value="#{msg.activity_stream}" />
						</a>
					</li>	
					<li>
						<a href="#{request.contextPath}/lw/myhome/profile.jsf" id="profile">
							<h:outputText value="#{msg.myProfileTitle}" />
						</a>
					</li>				
					<li>
						<img alt="" src="#{request.contextPath}/resources/main-template/img/dropdownmenu.png" height="28" width="28" class="menu" tabindex="0" />

						<ul>
							
							<li class="menupoint">
								<h:outputText value="#{msg.my_stuff}" />
							</li>
							
							<li>
								<a href="#{request.contextPath}/lw/myhome/resources.jsf" id="moremyresources">
									<h:outputText value="#{msg.myResourcesTitle}" />
								</a>
							</li>
							<li>
								<a href="#{request.contextPath}/lw/myhome/groups.jsf" id="moremygroups">
									<h:outputText value="#{msg.groupOverview}" />
								</a>
							</li>
							<li>
								<a href="#{request.contextPath}/lw/myhome/activity.jsf" id="moreactivitystream">
									<h:outputText value="#{msg.activity_stream}" />
								</a>
							</li>							
							<li>
								<a href="#{request.contextPath}/lw/myhome/profile.jsf" id="moreprofile">
									<h:outputText value="#{msg.myProfileTitle}" />
								</a>
							</li>
							<li>
								<a href="#{request.contextPath}/lw/myhome/comments.jsf">
									<h:outputText value="#{msg.myCommentsTitle}" />
								</a>
							</li>
							<li>
								<a href="#{request.contextPath}/lw/myhome/tags.jsf">
									<h:outputText value="#{msg.myTags}" />
								</a>
							</li>
							<!--  
							<li>
								<a href="#{request.contextPath}/lw/myhome/profile.jsf" id="profile">
									<h:outputText value="#{msg.myProfileTitle}" />
								</a>
							</li>
							-->
							<!-- 							
							<li>
								<a href="#{request.contextPath}/lw/myhome/services.jsf">
									<h:outputText value="#{msg.web2_0services}" />
								</a>
							</li>
							 -->
							
							<li>
								<a href="#{request.contextPath}/lw/user/login.jsf" id="login">#{msg.loginLabel}</a>
							</li>
							<li>
								<h:form id="logout">
									<h:commandLink action="#{loginBean.logout}" rendered="#{userBean.loggedIn}" immediate="true" title="#{msg.logoutLabel}" value="#{msg.logoutLabel}" />
								</h:form>
							</li>
							<ui:fragment rendered="#{userBean.admin}">
								<li class="menupoint">
									<h:outputText value="#{msg.admin}" />
								</li>
								<li>
									<a href="#{request.contextPath}/lw/admin/courses.jsf">
										<h:outputText value="#{msg.courses}" />
									</a>
								</li>
								<li>
									<a href="#{request.contextPath}/lw/admin/users.jsf">
										<h:outputText value="#{msg.users}" />
									</a>
								</li>
								<li>
									<a href="#{request.contextPath}/lw/admin/adminmsg.jsf">
										<h:outputText value="#{msg.admin_messages_Title}" />
									</a>
								</li>
								<li>
									<a href="#{request.contextPath}/lw/admin/adminchangelog.jsf">
										<h:outputText value="#{msg.change_log}" />
									</a>
								</li>
							</ui:fragment>
							<ui:fragment rendered="#{userBean.admin || userBean.moderator}">
								<li class="menupoint">
									<h:outputText value="#{msg.moderator}" />
								</li>
								<!-- 
								<li>
									<a href="#{request.contextPath}/lw/admin/notification.jsf">
										<h:outputText value="#{msg.notification}" />
									</a>
								</li>
								 -->
								<li>
									<a href="#{request.contextPath}/lw/admin/users_moderator.jsf">
										<h:outputText value="#{msg.users}" />
									</a>
								</li>
								<li>
									<a href="#{request.contextPath}/lw/admin/courses.jsf">
										<h:outputText value="#{msg.courses}" />
									</a>
								</li>
								<li>
									<a href="#{request.contextPath}/lw/admin/organisation.jsf">
										<h:outputText value="#{msg.organization}" />
									</a>
								</li>
								<!-- 
								<li>
									<a href="#{request.contextPath}/lw/admin/text_analysis.jsf">
										<h:outputText value="#{msg.text_analysis}" />
									</a>
								</li>
								<li>
									<a href="#{request.contextPath}/lw/admin/statistics.jsf">
										<h:outputText value="#{msg.statistics}" />
									</a>
								</li>
								 -->
								<li>
									<a href="#{request.contextPath}/lw/transcript_log.jsf">
										<h:outputText value="Transcript Log" />
									</a>
								</li>
							</ui:fragment>
						</ul>
					</li>
				</ul>
			</div>
	
			<div id="language_selector" class="hover-white" tabindex="0">
				<img alt="#{userBean.localeCode}" src="#{request.contextPath}/resources/main-template/img/flag_#{userBean.localeCode}.png" />

				<h:form>
					<ul>
						<li>
							<h:commandLink action="#{userBean.setLocaleCode('de')}" styleClass="language_de">Deutsch</h:commandLink>
						</li>
						<li>
							<h:commandLink action="#{userBean.setLocaleCode('en')}" styleClass="language_en">English</h:commandLink>
						</li>
						<li>
							<h:commandLink action="#{userBean.setLocaleCode('it')}" styleClass="language_it">Italiano</h:commandLink>
						</li>
						<li>
							<h:commandLink action="#{userBean.setLocaleCode('pt')}" styleClass="language_pt">PortuguÃªs</h:commandLink>
						</li>
					</ul>
				</h:form>
			</div>

			<p:graphicImage value="/resources/main-template/img/question.png" alt="#{msg.help}" onclick="footerToggle();" rendered="#{not empty helpText}" id="informationonscreen" />


			<h:outputLink id="loginbutton" value="#{request.contextPath}/lw/user/login.jsf" rendered="#{not userBean.loggedIn}" class="hover-white">
				#{msg.loginLabel}
			</h:outputLink>

			<h:form>
				<h:commandLink action="#{loginBean.logout}" rendered="#{userBean.loggedIn}" immediate="true" title="#{msg.logoutLabel}">
					<img alt="#{msg.logoutLabel}" src="#{request.contextPath}/resources/main-template/img/logout.png" id="logoutbutton" class="hover-white" />
				</h:commandLink>
			</h:form>

		</div>

		<ui:insert name="sub_menu_bar">

		</ui:insert>

	</header>

			
	
	<h:form>
		<p:ajaxExceptionHandler type="javax.faces.application.ViewExpiredException" update="expiredExceptionDialog" onexception="PF('exceptionDialog').show();" />

		<p:ajaxExceptionHandler type="java.lang.Exception" update="exceptionDialog" onexception="PF('expiredExceptionDialog').show();" />

		<p:dialog id="exceptionDialog" header="Exception '#{pfExceptionHandler.type}' occured!" widgetVar="exceptionDialog" height="500px">
        Message: #{pfExceptionHandler.message} <br />
        StackTrace: <h:outputText value="#{pfExceptionHandler.formattedStackTrace}" escape="false" />
			<br />

		</p:dialog>

		<p:dialog id="expiredExceptionDialog" header="ViewExpiredException occured!" widgetVar="expiredExceptionDialog" height="500px">
        Sorry your Session has timed out. Please reload the page.
        <p:button onclick="document.location.href = document.location.href;" value="Reload!"
				rendered="#{pfExceptionHandler.type == 'javax.faces.application.ViewExpiredException'}" />
		</p:dialog>
	</h:form>


</ui:composition>

</html>