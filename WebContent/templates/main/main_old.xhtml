<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      lang="#{userBean.localeCode}">

<!--@elvariable id="pageTitle" type="java.lang.String"-->
<!--@elvariable id="helpText" type="java.lang.String"-->
<!--@elvariable id="loginRequired" type="java.lang.Boolean"-->
<!--@elvariable id="disableGrowl" type="java.lang.Boolean"-->

<f:view locale="#{userBean.locale}" contentType="text/html">
    <ui:insert name="metadata"/>

    <h:head>
        <title><h:outputText value="#{pageTitle}" escape="false"/> - #{msg['application.name']}</title>
        <link rel="shortcut icon" href="#{request.contextPath}/resources/icon/favicon.ico"/>
        <base href="#{request.contextPath}/lw/"/>
        <ui:insert name="head-meta"/>

        <h:outputScript library="primefaces" name="jquery/jquery.js" target="head"/>
        <h:outputScript target="head" name="vendor/jquery-migrate-v3.0.1/jquery-migrate-3.0.1.js"/>
        <h:outputScript library="main-template" name="default2.js"/>

        <h:outputStylesheet name="vendor/nanoscroller-v0.8.7/nanoscroller.css"/>
        <h:outputScript name="vendor/nanoscroller-v0.8.7/jquery.nanoscroller.min.js"/>

 <h:outputStylesheet library="primefaces-omega" name="theme.css"/>
        
        <h:outputStylesheet library="main-template" name="main.css"/>
        <h:outputStylesheet library="main-template" name="responsive_design.css"/>
        
       
    </h:head>

    <h:body>
        <ui:decorate template="/templates/main/tooltips.xhtml"/>
        <ui:decorate template="/templates/main/header.xhtml"/>

        <style type="text/css">
            .ui-layout-north {
                height: 46px !important;
            }
        </style>
        <p:layout fullPage="true" widgetVar="mainLayout">
            <p:layoutUnit position="north" resizable="false" closable="false" collapsible="false" styleClass="northunit" style="display:block; height:46px;">
                <script type="text/javascript">

                    function scroller() {
                        try {
                            $(".nano").nanoScroller({
                                paneClass: 'pane',
                                sliderClass: 'slider',
                                contentClass: 'content',
                                alwaysVisible: true
                            });
                        } catch (e) {
                            console.log('scroller problem', e);
                        }
                    }

                    $(document).ready(function () {
                        if ($(".ui-layout-unit-content", "#right_pane")) {
                            $(".ui-layout-unit-content", "#center_pane").addClass("nano");
                            $(".ui-layout-unit-content", "#right_pane").addClass("nano");
                            $(".ui-layout-unit-content", "#right_pane").wrapInner('&lt;div class="content" /&gt;');
                            $(".ui-layout-unit-content", "#left_pane").addClass("nano");
                        }
                        scroller();
                        setInterval("scroller()", 500);
                    });
                </script>

                <ui:insert name="sub_menu_bar"></ui:insert>

            </p:layoutUnit>

            <p:layoutUnit id="left_pane" rendered="#{userBean.loggedIn}" position="west" size="223" resizable="false" closable="false" collapsible="false">
                <div class="content">
                    <ui:decorate template="/templates/main/group_menu.xhtml"/>
                </div>
            </p:layoutUnit>

            <ui:insert name="right_layout"/>

            <p:layoutUnit id="center_pane" position="center">
                <h:panelGroup layout="block" styleClass="#{loginRequired and !userBean.loggedIn? 'small_page':'content'}">
                    <p:messages id="message" escape="false"/>

                    <ui:fragment rendered="#{loginRequired and !userBean.loggedIn}">
                        <ui:include src="/templates/user/login.xhtml"/>
                    </ui:fragment>

                    <ui:fragment rendered="#{!loginRequired || userBean.loggedIn}">
                        <ui:insert name="center_layout"></ui:insert>
                    </ui:fragment>
                </h:panelGroup>
            </p:layoutUnit>

        </p:layout>

        <ui:insert name="bottom_panel"></ui:insert>

        <h:panelGroup layout="block" id="footer" rendered="#{not empty helpText and (!loginRequired || userBean.loggedIn)}" styleClass="#{userBean.getPreference('helptext_hide')? 'display-none':''}">
            <h:outputText value="?" id="footer_question_mark" class="align-center"/>
            <h:outputText value="#{helpText}" escape="false" style="padding: 0.7rem 10rem; display:block; font-size:1.5rem;"/>
            <a href="#" onclick="return footerClose();" id="footer_close" title="#{msg.close}"></a>
        </h:panelGroup>

        <h:form styleClass="display-none">
            <p:remoteCommand actionListener="#{userBean.setPreferenceRemote()}" name="setPreferenceRemote" async="true" immediate="true" process="@this"/>
        </h:form>

        <p:growl id="growl" rendered="#{userBean.loggedIn and not disableGrowl}"/>
    </h:body>
</f:view>

</html>

