<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:p="http://primefaces.org/ui">

<!--@elvariable id="resources" type="java.util.LinkedList<de.l3s.learnweb.resource.ResourceDecorator>"-->

<h:outputStylesheet name="vendor/tooltipster-v3.3.0/tooltipster.min.css"/>
<h:outputScript name="vendor/tooltipster-v3.3.0/jquery.tooltipster.min.js" target="head"/>
<div class="d-flex flex-column bg-white">
    <p:repeat value="#{resources}" var="res">
        <h:panelGroup layout="block" styleClass="m-2 font-weight-bold border-bottom" rendered="#{res.tempId gt 1 and res.tempId % 10 eq 1}">
            <h:outputText value="#{msg.page} "/>
            <h:outputText value="#{(res.tempId+9) / 10}">
                <f:convertNumber maxFractionDigits="0"/>
            </h:outputText>
        </h:panelGroup>

        <div class="resource m-2" style="max-width: 48em;" id="resource_#{res.tempId}">
            <div class="tooltip-container">
                <div class="tooltip-data shadow">
                    <div class="tooltip-item">
                        <span onclick="setSelectedResource([{name:'resource_id', value:#{res.tempId}}]); PF('resource_dialog').show(); return false;">
                            <h:outputLink value="#" rendered="#{userBean.loggedIn}" styleClass="text-decoration-none"/>
                            <span>#{msg.addToMyResources}</span>
                        </span>
                    </div>
                    <div class="tooltip-item">
                        <ui:fragment rendered="${res.archived}">
                            <span>
                                #{msg['Archive.captured_between']}
                                <a href="#{res.firstArchivedObject.archiveUrl}" style="color:green;" target="_blank">
                                    <h:outputText value="${res.firstArchivedObject.timestamp}"><f:convertDateTime type="date" dateStyle="short"/></h:outputText>
                                </a> #{msg['Archive.captured_between_and']}
                                <a href="#{res.lastArchivedObject.archiveUrl}" style="color:green;" target="_blank">
                                    <h:outputText value="#{res.lastArchivedObject.timestamp}"><f:convertDateTime type="date"
                                                                                                                 dateStyle="short"/></h:outputText>
                                </a>
                            </span>
                        </ui:fragment>
                    </div>
                    <div class="tooltip-item">
                        <ui:fragment  rendered="#{not empty res.group}">
                            <p:outputLabel for="@next" value="#{msg.group}:" styleClass="mr-1 font-weight-bold my-0"/>
                            <h:outputLink value="group/resources.jsf" title="#{res.group.description}">
                                <f:param name="group_id" value="#{res.group.id}"/>
                                <h:outputText value="#{res.group.title}"/>
                            </h:outputLink>
                        </ui:fragment>
                    </div>
                    <div class="tooltip-item">
                        <ui:fragment rendered="#{not empty res.getMetadataValue('collector')}">
                            <p:outputLabel for="@next" value="#{msg.collector}: " styleClass="mr-1 font-weight-bold my-0"/>
                            <h:outputText value="#{res.getMetadataValue('collector')}"/>
                        </ui:fragment>
                    </div>
                    <div class="tooltip-item">
                        <ui:fragment rendered="#{empty res.getMetadataValue('collector') and not empty res.ownerUser.fullName}">
                            <p:outputLabel for="@next" value="#{msg.collector}:" styleClass="mr-1 font-weight-bold my-0"/>
                            <h:outputText value="#{res.resource.ownerUser.fullName}"/>
                        </ui:fragment>
                    </div>
                </div>
            </div>
        <div>
            <div>
                <h:outputLink styleClass="resourceWebLink text-truncate overflow-hidden" target="_blank" style="font-size: 1.2rem;" value="#{res.urlProxied}">
                    <span class="d-block text-truncate">
                    <h:outputText value="#{res.title}" escape="false"/>
                    </span>
                </h:outputLink>
            </div>
            <div>
                <div class="d-flex">
                    <div class="text-truncate overflow-hidden" style="color: #006621;">
                    <h:outputText rendered="#{res.id != -1}" escape="true">#{msg['application.name']} <span style="font-family:Verdana, Arial, sans-serif;">&#187;</span> #{res.url}</h:outputText>
                    <h:outputText rendered="#{res.id == -1}" escape="true" target="_blank">#{res.url}</h:outputText>
                    </div>
                </div>
            </div>
            <span class="block-with-text d-block w-100">
                 <h:outputText value="#{res.snippet}" escape="false"></h:outputText>
            </span>
        </div>
        </div>
    </p:repeat>
</div>
</ui:composition>