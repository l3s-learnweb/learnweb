<!DOCTYPE html>
<html 
	xmlns:ui="http://java.sun.com/jsf/facelets" 
	xmlns:h="http://java.sun.com/jsf/html" 
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">
<h:head></h:head>
<h:body>

<h3>Rowspan</h3>
<h:form prependId="false">
    <p:dataTable id="my_table" var="car" value="#{rowGroupView.cars}" sortBy="#{car.brand}">
        <p:ajax event="filter" oncomplete="groupRow(0);"/>
        	
        <p:column headerText="Brand" filterBy="#{car.brand}" filterable="true">        	
            <h:outputText value="#{car.brand}" />
        </p:column>
        <p:column headerText="Year" filterBy="#{car.year}" filterable="true">
            <h:outputText value="#{car.year}" />
        </p:column>
        <p:column headerText="Color" filterFunction="#{car.color}" filterable="true">
            <h:outputText value="#{car.color}" />
        </p:column>
        <p:column headerText="Id" filterBy="#{car.id}" filterable="true">
            <h:outputText value="#{car.id}" />
        </p:column>
    </p:dataTable>
</h:form>	

<script type="text/javascript" >
//<![CDATA[
var groupRow = function(colIndex) {
    var rows = $('#my_table').find('tr');
    var groupStartIndex = null, rowGroupCellData = null, rowGroupCount = null;
    
    for(var i = 0; i < rows.length; i++) {
        var row = rows.eq(i);
        var column = row.children('td').eq(colIndex);
        var columnData = column.text();
        console.log(columnData);
        if(rowGroupCellData != columnData) {                    
            groupStartIndex = i;
            rowGroupCellData = columnData;
            rowGroupCount = 1;
        }
        else {
            column.remove();
            rowGroupCount++;
        }
        
        if(groupStartIndex != null && rowGroupCount > 1) {
            rows.eq(groupStartIndex).children('td').eq(colIndex).attr('rowspan', rowGroupCount);
        }
    }
};

$(document).ready(function() {
	groupRow(0);
});
//]]>
</script>					
</h:body>
</html>
