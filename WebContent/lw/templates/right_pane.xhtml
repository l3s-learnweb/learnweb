<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">

	<ui:composition> 

	<p:layoutUnit rendered="#{userBean.loggedIn}" position="east" size="38%" resizable="false" closable="false" collapsible="false" 
		header="#{bean.clickedResource.id eq -1? msg.click_to_view_details : bean.clickedResource.title}" id="right_pane">

		<h:outputScript library="resource-pane-template" name="resource-pane.js"/>
		<h:outputStylesheet library="resource-pane-template" name="resource-pane.css"/>

		<h:form id="remote_form">
			<p:remoteCommand name="update_datagrid" update=":datagrid :add_resource_panel" oncomplete="update_header()"/>
		</h:form>

		<div id="right_pane_wrapper">
			<p:panel id="add_resource_panel">
				<script type="text/javascript">
					function update_header()
					{
						if(#{bean.newResourceClicked})
						{
							$(".ui-layout-unit-header","#right_pane").html("#{msg.upload_resource}");
						}
						else if(#{bean.editResourceClicked})
						{
							$(".ui-layout-unit-header","#right_pane").html("#{msg.edit_resource} - #{bean.clickedResource.title}");
						}
						else
						{
							$(".ui-layout-unit-header","#right_pane").html("#{bean.clickedResource.title}");
						}
						console.log('scoller', $('#right_pane .content').scrollTop());
						
						$('#right_pane .content').scrollTop(0);
						
						scroller();
						lightbox_load();
				   
					}
					
				</script>
				<ui:fragment rendered="#{bean.newResourceClicked and !bean.editResourceClicked}">
			
					<h:form id="add_resource_form" class="grey_border">
					
						<table id="add_resource_table">
							<tr>
								<td>
									#{msg.resource_type}*:
								</td>
								<td>
									<h:selectOneMenu id="type" value="#{addResourceBean.resource.storageType}" 
										valueChangeListener="#{addResourceBean.clearForm}">
										
										<f:selectItem itemLabel="URL" itemValue="2" />
										<f:selectItem itemLabel="#{msg.file}" itemValue="1" />
										
										<p:ajax update="@form" immediate="true" listener="#{addResourceBean.doNothing}"/>
									</h:selectOneMenu>
								</td>
								<td rowspan="3" class="align-right" style="padding: 0px !important;">
									<h:outputText id="preview" escape="false" value="#{addResourceBean.resource.embeddedSize1}"/>
								</td>
							</tr>
							<p:row id="resource_input" rendered="#{addResourceBean.resource.storageType == 1}">
								<td>
									#{msg.file}*:
								</td>
								<td>
									<p:commandButton value="#{msg.choose_file}" onclick="PF('file_dialog').show()"/>
								</td>
							</p:row>
							<p:row id="resource_input2" rendered="#{addResourceBean.resource.storageType == 2}">
								<td>
									URL*:
								</td>
								<td>									
									<p:inputText value="#{addResourceBean.resource.url}" styleClass="add_field" required="true" 
										requiredmessage="#{msg.mandatory_field}" id="url_input" 
										rendered="#{addResourceBean.resource.storageType == 2}"/>
								</td>
							</p:row>
							<tr>
								<td>
									#{msg.add_to}*:
								</td>
								<td>
									<h:selectOneMenu value="#{addResourceBean.resourceTargetGroupId}">
										<f:selectItem itemLabel="#{msg.myResourcesTitle}" itemValue="0" />
										<f:selectItem itemLabel="------------" itemValue="-1" itemDisabled="true" />
										<f:selectItems var="group" value="#{userBean.user.writeAbleGroups}" itemLabel="#{group.title}" 
											itemValue="#{group.id}" />
									</h:selectOneMenu>
								</td>
							</tr>
							<tr>
								<td>
									#{msg.title}*:
								</td>
								<td colspan="2">
									<p:inputText value="#{addResourceBean.resource.title}" styleClass="add_field" required="true" 
										requiredmessage="#{msg.mandatory_field}" id="title_input" />
								</td>
							</tr>
							<tr>
								<td>
									#{msg.author}:
								</td>
								<td colspan="2">
									<p:inputText value="#{addResourceBean.resource.author}" styleClass="add_field" />
								</td>
							</tr>
							<tr>
								<td colspan="3">
									#{msg.description}:
								</td>
							</tr>							
							<tr>
								<td colspan="3">
									<p:inputTextarea id="description" value="#{addResourceBean.resource.description}" autoResize="true" 
										styleClass="add_field" style="min-height:100px;"/>
								</td>
							</tr>
							<tr>
								<td colspan="3">
									<p:commandButton value="#{msg.addResource}" styleClass="float-right" update=":growl :add_resource_panel" 
										action="#{addResourceBean.addResource}" ajax="true" oncomplete="update_datagrid();">
										<f:setPropertyActionListener target="#{bean.reloadLogs}" value="true"/>	
										<f:setPropertyActionListener target="#{bean.clickedResource}" value="#{addResourceBean.resource}"/>
										<f:setPropertyActionListener target="#{resourceDetailBean.clickedResource}" value="#{addResourceBean.resource}"/>
									</p:commandButton>
									
									<p:commandButton value="#{msg.cancel}" styleClass="float-right" partialSubmit="true" process="@this" 
										actionListener="#{addResourceBean.cancelUpload}" ajax="true" update=":add_resource_panel" 
										oncomplete="update_header()" style="margin-right:0.5em;">
										<f:setPropertyActionListener target="#{bean.newResourceClicked}" value="false"/>
									</p:commandButton>
								</td>
							</tr>
							<tr>
								<td>
									* #{msg.mandatory_field}
								</td>
							</tr>
						</table>									
					</h:form>
			</ui:fragment>
				
				<h:panelGroup rendered="#{!bean.newResourceClicked and !bean.editResourceClicked and bean.clickedResource.id != -1}" 
					layout="block">						
					<ui:fragment rendered="#{resourceDetailBean.clickedResource.type.toLowerCase() eq 'text' or resourceDetailBean.clickedResource.type eq 'pdf' or resourceDetailBean.clickedResource.type.toLowerCase() eq 'video' or resourceDetailBean.clickedResource.type.toLowerCase() eq 'image'}">
						<div class="align-center">

							<div id="lightbox">
								<div id="lightbox_background" onclick="lightbox_close();"></div>
								
								<div id="lightbox_container">	
									<div id="lightbox_title">
										<h:outputText value="#{resourceDetailBean.clickedResource.title}" escape="false" />
										<a href="#" onclick="lightbox_close(); return false;" id="lightbox_close" title="close"></a>
									</div>
									<div id="lightbox_content">
										<ui:fragment rendered="#{resourceDetailBean.clickedResource.type eq 'text'}">
										    <div style="overflow:auto; height:100%; width:100%; text-align:center;">
										    	<img src="#{resourceDetailBean.clickedResource.thumbnail4.url}" 
										    		height="#{resourceDetailBean.clickedResource.thumbnail4.height}"
										    		width="#{resourceDetailBean.clickedResource.thumbnail4.width}" />
										    </div>	
									    </ui:fragment>
									    <ui:fragment rendered="#{resourceDetailBean.clickedResource.type eq 'pdf'}">
										   	<iframe src="#{resourceDetailBean.clickedResource.url}" style="width:100%; height:100%; "/>									    	
									    </ui:fragment>
									    <ui:fragment rendered="#{resourceDetailBean.clickedResource.type eq 'Image'}">
										    	<img src="#{resourceDetailBean.clickedResource.thumbnail4.url}" 
										    		height="#{resourceDetailBean.clickedResource.thumbnail4.height}" 
										    		width="#{resourceDetailBean.clickedResource.thumbnail4.width}" 
										    		style="height:auto; width:auto; max-height:100%; max-width:100%; display:block; margin:0 auto; position: relative; 
										    		top: 50%; transform: translateY(-50%);-moz-transform:translateY(-50%);-webkit-transform:translateY(-50%);
										    		-o-transform:translateY(-50%);-ms-transform:translateY(-50%);"/>	
									    </ui:fragment>							
									</div>
								</div>
							</div>						
						 
									
							<ui:fragment rendered="#{resourceDetailBean.clickedResource.type == 'Video' and resourceDetailBean.clickedResource.source != 'Yovisto'}">
								<div class="preview_box" style="min-height:400px; max-height:500px; height:100%;">
									<h:outputText value='#{resourceDetailBean.clickedResource.embedded}' escape="false" />
								</div>
							</ui:fragment>
							<ui:fragment rendered="#{resourceDetailBean.clickedResource.type == 'Video' and resourceDetailBean.clickedResource.source == 'Yovisto'}">
								<div class="preview_box" style="height:400px; width:100%;">
									<h:outputText value='#{resourceDetailBean.clickedResource.embedded}' escape="false" />
								</div>
							</ui:fragment>								
							<ui:fragment rendered="#{resourceDetailBean.clickedResource.type != 'text' and resourceDetailBean.clickedResource.type != 'pdf' and resourceDetailBean.clickedResource.type != 'Video' and resourceDetailBean.clickedResource.type != 'Image'}">
								<div class="preview_box">
									<h:outputText value='#{resourceDetailBean.clickedResource.embeddedSize3.replaceAll("/>","").replaceAll(">","").concat(" style=\"max-width:100%\" />")}' 
										escape="false"/>
								</div>
							</ui:fragment>
							<ui:fragment rendered="#{(resourceDetailBean.clickedResource.type eq 'text' or resourceDetailBean.clickedResource.type eq 'pdf' or resourceDetailBean.clickedResource.type eq 'Image') and not empty resourceDetailBean.clickedResource.thumbnail3}">
									<img class="preview_box" src="#{resourceDetailBean.clickedResource.thumbnail3.url}" 
										height="#{resourceDetailBean.clickedResource.thumbnail3.height}" onmouseup="lightbox_open();" 
										width="#{resourceDetailBean.clickedResource.thumbnail3.width}" 
										style="max-width: 100%; height: auto; margin:0 auto; display:block; cursor: -webkit-zoom-in; cursor: -moz-zoom-in; cursor:zoom-in;"/>	
							</ui:fragment>
							<ui:fragment rendered="#{(resourceDetailBean.clickedResource.type eq 'text' or resourceDetailBean.clickedResource.type eq 'pdf') and empty resourceDetailBean.clickedResource.thumbnail3}">
								<div class="preview_box" style="display: inline-block">
									<a target="_blank" class="newsfeed_query_link" style="padding: 0px" 
										href="#{resourceDetailBean.clickedResource.url}">
										<h:outputText value='#{resourceDetailBean.clickedResource.embeddedSize3.replaceAll("/>","").replaceAll(">","").concat(" style=\"max-width:100%\" />")}' escape="false"/>
									</a>
								</div>
							</ui:fragment>
							<ui:fragment rendered="#{resourceDetailBean.clickedResource.type eq 'Image' and empty resourceDetailBean.clickedResource.thumbnail3}">
								<div class="preview_box">
									<h:outputText value='#{resourceDetailBean.clickedResource.embeddedSize3.replaceAll("/>","").replaceAll(">","").concat(" style=\"max-width:100%\" />")}' escape="false"/>
								</div>
							</ui:fragment>
						</div>
						<div class="align-center" style="padding-top: 10px">
							<a class="hyperlink" href="#{resourceDetailBean.clickedResource.url}" target="_blank">
								<h:outputText styleClass="hyperlink" 
									rendered="#{resourceDetailBean.clickedResource.type eq 'text' or resourceDetailBean.clickedResource.type eq 'pdf'}" 
									value="#{resourceDetailBean.clickedResource.url}"/>
							</a>
						</div>
					</ui:fragment>
					
					<style type="text/css">
						#resources_informations_table a:hover, #resources_informations_table a:focus{
							text-decoration:underline; 
						}
					</style>
					
					<table id="resources_informations_table">
						<ui:fragment rendered="${not empty resourceDetailBean.clickedResource.fileName and not resourceDetailBean.clickedResource.source.equals('LORO')}">
							<tr>
								<td>
									<span class="resource_field">
										#{msg.file}: 
									</span>
								</td>
								<td>
									<a href="#{resourceDetailBean.clickedResource.getUrl()}">
										#{resourceDetailBean.clickedResource.fileName}
									</a>
								</td>
							</tr>
						</ui:fragment>

						<ui:fragment rendered="${empty resourceDetailBean.clickedResource.fileName and resourceDetailBean.clickedResource.type.toLowerCase() != 'text' and resourceDetailBean.clickedResource.type != 'pdf' and resourceDetailBean.clickedResource.type.toLowerCase() != 'video' and resourceDetailBean.clickedResource.type.toLowerCase() != 'image'}">
							<tr>
								<td>
									<span class="resource_field">
										#{msg.resource}: 
									</span>
								</td>
								<td>
									<a style="color: #22e" href="#{resourceDetailBean.clickedResource.getUrl()}">
										#{resourceDetailBean.clickedResource.url}
									</a>
								</td>
							</tr>
						</ui:fragment>

						<ui:fragment rendered="#{not empty resourceDetailBean.clickedResource.author}">
							<tr>
								<td>
									<span class="resource_field">
										#{msg.author}: 
									</span>
								</td>
								<td>
									<h:outputText value="#{resourceDetailBean.clickedResource.author}"/>
								</td>
							</tr>
						</ui:fragment>
						<tr>
							<td>
								<span class="resource_field">
									#{msg.source}: 
								</span>
							</td>
							<td>
								<a href="#{resourceDetailBean.clickedResource.getUrl()}">
									<h:outputText value="#{resourceDetailBean.clickedResource.source}" />
								</a>
							</td>
						</tr>
						
						<ui:repeat var="entry" value="#{resourceDetailBean.clickedResource.metadataEntries}">
							<tr>
								<td>
									<span class="resource_field">
										<h:outputText value="${utilBean.getLocaleMessage(entry.key, '')}" />: 
									</span>
								</td>
								<td>
									<h:outputText value="#{entry.value}" />									
								</td>
							</tr>
						</ui:repeat>
						
						<ui:fragment rendered="#{not empty resourceDetailBean.clickedResource.groups}">
							<tr>
								<td>
									<span class="resource_field">
										<h:outputFormat value="#{msg.group_s}:">
											<f:param value="#{resourceDetailBean.clickedResource.groups.size()}" />
										</h:outputFormat>
									</span>
								</td>
								<td>
									<ui:repeat var="group" value="#{resourceDetailBean.clickedResource.groups}">
										<h:outputLink value="group/overview.jsf" style="display:inline-block; margin-right:1rem;">
											<f:param name="group_id" value="#{group.id}" />
											<h:outputText value="#{group.title}" />
										</h:outputLink>
									</ui:repeat>
								</td>
							</tr>
						</ui:fragment>
						<ui:fragment rendered="#{resourceDetailBean.clickedResource.source == 'TED' or resourceDetailBean.clickedResource.source == 'TEDx'}">
							<tr>
								<td>
									<span class="resource_field">
										#{msg.transcript}: 
									</span>
								</td>
								<td>
									<h:outputLink value="ted_transcript.jsf" style="text-decoration:underline;">
										<f:param name="resource_id" value="#{resourceDetailBean.clickedResource.id}" />
										#{msg.link_to_transcript}
									</h:outputLink>
								</td>
							</tr>
						</ui:fragment>						
						<ui:fragment rendered="#{not empty resourceDetailBean.clickedResource.creationDate}">
							<tr>
								<td>
									<span class="resource_field">
										#{msg.date}:
									</span>
								</td>
								<td>
									<h:outputText value="#{resourceDetailBean.clickedResource.creationDate}">
										<f:convertDateTime type="date" dateStyle="long" timeZone="#{userBean.timeZone}"/>
									</h:outputText>
								</td>
							</tr>
						</ui:fragment>
					</table>

					<h:panelGroup rendered="#{not empty resourceDetailBean.clickedResource.description}">
							<div class="resource_field" style="padding-top: 10px">
								#{msg.description}
							</div>
							<h:outputText id="resource_description" value="#{resourceDetailBean.clickedResource.descriptionHTML}" 
								escape="false" />
					</h:panelGroup>
							
							<h:form id="archive_current_form" rendered="#{resourceDetailBean.clickedResource.storageType != 1 and !groupDetailBean.group.readOnly}">
								<span class="resource_field">
									#{msg.current_version}: 
								</span>
								<p:commandButton action="#{resourceDetailBean.archiveCurrentVersion}" styleClass="greenbutton" 
									value="#{msg['Archive.now']}" update=":growl :archive_view :archive_view_options" style="margin-top:10px"/>
							</h:form>
									
							<h:panelGroup id="archive_view_options" layout="block">
								<h:panelGroup layout="block" style="padding-top: 15px;" 
									rendered="#{not empty resourceDetailBean.clickedResource.archiveUrls}">
									<span class="resource_field" style="position:relative;">
										#{msg['Archive.versions']} (
										<span style="color:red">
											#{resourceDetailBean.clickedResource.archiveUrls.size()}
										</span>
										): 
									</span>
									
									<p:commandButton id="list_button" styleClass="greenbutton" value="#{msg.list_view}" 
										onclick="return open_list_view();" />
									<p:commandButton id="timeline_button" styleClass="greenbutton" value="#{msg.timeline_view}" 
										onclick="return open_timeline_view();" />
								</h:panelGroup>
							</h:panelGroup>
							<h:panelGroup id="archive_view" layout="block">
								<h:panelGroup id="archive_list_view" layout="block" 
									rendered="#{not empty resourceDetailBean.clickedResource.archiveUrls}">
									<ul>
										<ui:repeat var="entry" value="#{resourceDetailBean.clickedResource.archiveUrls}">
											<li>
												<a href="#{entry.archiveUrl}" target="_blank">
													<h:outputText value="${userBean.formatDate(entry.timestamp)}"/>
												</a>
											</li>
										</ui:repeat>
									</ul>
								</h:panelGroup>
								<h:panelGroup id="timeline_view" layout="block" 
									rendered="#{not empty resourceDetailBean.clickedResource.archiveUrls}">
									<ui:decorate template="/lw/templates/archive_timeline_template.xhtml">
									</ui:decorate>
								</h:panelGroup>
								<br class="clear" />
							</h:panelGroup>					
		
							<h:form id="tag_form">
								<div class="resource_field" style="padding-top: 10px; padding-bottom: 10px">
									#{msg.tags}
								</div>
	
						        <ul style="margin: 0px; padding: 0px">
							         <ui:repeat var="tag" value="#{resourceDetailBean.clickedResource.tags}">
							         	<li class="tag_list">
							         		<h:outputLink styleClass="tag_name ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" 
							         			value="search.jsf">
							         			<span class="ui-button-text">
							         				#{tag.name}
							         			</span>
									         		<f:param name="action" value="image"/>
									         		<f:param name="query" value="#{tag.name}"/>
							         		</h:outputLink>
							         		<p:commandButton styleClass="tag_x float-right" action="#{resourceDetailBean.onDeleteTag}" 
							         			value="x" update=":add_resource_panel" process="@form" rendered="#{!groupDetailBean.group.readOnly}">
							         			<f:setPropertyActionListener target="#{resourceDetailBean.selectedTag}" value="#{tag}"/>
							         		</p:commandButton>
							         	</li>
							         </ui:repeat>
							    </ul>
							</h:form> 
							<h:form id="tag_input_form" rendered="#{!groupDetailBean.group.readOnly}">  
							    <p:inputText styleClass="tag_field" value="#{resourceDetailBean.tagName}"/>
						    	<p:commandButton actionListener="#{resourceDetailBean.addTag}" styleClass="greenbutton clearfix" 
						    		value="#{msg.addTag}" update=":datagrid :tag_form" process="@form" 
						    		style="margin-right:0;margin-top:4px;float:right">
						    	  	<f:setPropertyActionListener target="#{bean.reloadLogs}" value="true"/>	
						        </p:commandButton>
						    </h:form>
						   
						   <script type="text/javascript">
							   $('#commentfield').focus(function() {
									var button = $('#comment_button');
									button.slideDown();
									scrollToElement(button);
								});
								$('#comment_form').focusout(function() {
									$('#comment_button').slideUp(1000);
								});
						   </script>
						   
						    <h:form id="comment_form" styleClass="clear" prependId="false">
						   
								<h:panelGroup layout="block" class="resource_field" style="padding-top: 10px" rendered="#{!groupDetailBean.group.readOnly}">
									#{msg.comments}
								</h:panelGroup>								
							
								<br/>
								<h:panelGroup layout="block" rendered="#{!groupDetailBean.group.readOnly}">
									<div style="width:100%;padding-left:60px;box-sizing:border-box;">
										<h:graphicImage id="userpic" url="${learnwebBean.getProfileImage(userBean.user)}" width="50" height="50" 
											style="position:absolute;left:28px" alt="Profile picture"/> 
										
										<p:inputTextarea id="commentfield" style="width:100%;min-height:50px;box-sizing:border-box;" rows="2" 
											value="#{resourceDetailBean.newComment}" placeholder="#{msg.addComment}"/>
										<br/>
									</div>
									<p:commandButton id="comment_button" styleClass="greenbutton float-right" value="#{msg.addComment}" 
										actionListener="#{resourceDetailBean.addComment()}" update=":datagrid :comment_form" 
										style="display:none; margin-right:0;margin-top: 4px;">
										<f:setPropertyActionListener target="#{bean.reloadLogs}" value="true"/>	
									</p:commandButton>
								</h:panelGroup>
								<br class="clear" />
								<h:panelGroup layout="block" rendered="#{not empty resourceDetailBean.clickedResource.comments}" 
									styleClass="comments">
									<h:panelGroup layout="block" class="resource_field" style="padding-top: 10px" rendered="#{groupDetailBean.group.readOnly}">
										#{msg.comments}
									</h:panelGroup>
									<ui:repeat var="comment" value="#{resourceDetailBean.clickedResource.comments}">
										<div class="comment">
											<h:graphicImage class="userpic" url="#{comment.getUser().image}" width="30" height="30"/>
											<div class="username_div">
												<span class="username">
													<a href="user/detail.jsf?user_id=#{comment.user.id}" class="username_link">
														#{comment.user.username}
													</a>
												</span>
												<span title="#{comment.date}" class="comment_date">
													#{userBean.getPrettyDate(comment.date)}
												</span>												
												<div style="margin-top:5px;">
													#{comment.text}
												</div>

											</div>
											<div class="clear"></div>
											<div style="padding-left: 40px;">
												<p:commandLink rendered="#{resourceDetailBean.canEditComment(comment)}" 
													style="margin-right: 5px; font-size: 10px !important; color: green" value="#{msg.edit}" 
													onstart="PF('comment_dialog').show();" ajax="true" update=":comment_dialog_form">
													<f:setPropertyActionListener target="#{resourceDetailBean.clickedComment}" value="#{comment}"/>
												</p:commandLink>
												<p:commandLink rendered="#{resourceDetailBean.canEditComment(comment)}" 
													action="#{resourceDetailBean.onDeleteComment}" 
													style="margin-right: 5px; font-size: 10px !important; color: red" value="#{msg.delete}" 
													onstart="return confirm('#{msg.delete_message_comments}');" ajax="true" 
													update=":add_resource_panel">
													<f:setPropertyActionListener target="#{resourceDetailBean.clickedComment}" value="#{comment}"/>
												</p:commandLink>
											</div>
										</div>
									</ui:repeat>
								</h:panelGroup>								
							</h:form>
											
						</h:panelGroup>
						<h:form rendered="#{bean.editResourceClicked and !bean.newResourceClicked}" id="edit_form">
							<div class="align-center">
								<ui:fragment rendered="#{bean.clickedResource.type == 'Video'}">
									<div class="preview_box" style="max-height:500px; height:400px;">
										<h:outputText value='#{bean.clickedResource.embedded}' escape="false" />
									</div>
								</ui:fragment>								
								<ui:fragment rendered="#{bean.clickedResource.type != 'text' and bean.clickedResource.type != 'pdf' and bean.clickedResource.type != 'Video'}">
									<div class="preview_box">
										<h:outputText value='#{bean.clickedResource.embeddedSize3.replaceAll("/>","").replaceAll(">","").concat(" style=\"max-width:100%\" />")}' escape="false"/>
									</div>
								</ui:fragment>
								<ui:fragment rendered="#{(bean.clickedResource.type eq 'text' or bean.clickedResource.type eq 'pdf' ) and bean.clickedResource.type != 'Video'}">
									<div class="preview_box" style="display: inline-block">
										<a target="_blank" class="newsfeed_query_link" style="padding: 0px" href="#{bean.clickedResource.url}">
											<h:outputText value='#{bean.clickedResource.embeddedSize3.replaceAll("/>","").replaceAll(">","").concat(" style=\"max-width:100%\" />")}' escape="false"/>
										</a>
									</div>
								</ui:fragment>
							</div>
							<table id="edit_table">
								<tr>
									<td>
										#{msg.title}:
									</td>
									<td>
										<p:inputText style="width: 96%" value="#{bean.clickedResource.title}"/>
									</td>
								</tr>
								<tr>
									<td>
										#{msg.author}:
									</td>
									<td>
										<p:inputText style="width: 96%" value="#{bean.clickedResource.author}"/>
									</td>
								</tr>
								<tr>
									<td>
										#{msg.description}:
									</td>
								</tr>
								<tr>
									<td colspan="2">
										<p:inputTextarea rows="4" style="width: 97%; overflow-y: scroll" id="resource_description" 
											value="#{bean.clickedResource.description}"/>
									</td>
								</tr>
								<tr>
									<td colspan="2">
										<p:commandButton styleClass="greenbutton float-right" value="#{msg.save}" 
											actionListener="#{bean.editClickedResource}" update=":add_resource_panel :datagrid" 
											oncomplete="update_header()" style="margin-right:0.5em;">
											<f:setPropertyActionListener target="#{bean.editResourceClicked}" value="false"/>
										</p:commandButton>
										<p:commandButton styleClass="greenbutton float-right" value="#{msg.cancel}" 
											update=":add_resource_panel" style="margin-right:0.5em;">
											<f:setPropertyActionListener target="#{bean.editResourceClicked}" value="false"/>
										</p:commandButton>
									</td>
								</tr>
							</table>
						</h:form>
				<script type="text/javascript">
					$("#right_pane_wrapper img").bind('load', function() {
						scroller();
					});
				</script>
			</p:panel>
		</div>
	</p:layoutUnit>
	</ui:composition>
</html>