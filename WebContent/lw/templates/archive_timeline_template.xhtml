<ui:composition 
	xmlns:ui="http://java.sun.com/jsf/facelets" 
	xmlns:h="http://java.sun.com/jsf/html" 
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough">
	
	
		<h:outputScript library="archive-timeline" name="responsive-calendar.min.js" target="head"/>
		<h:outputStylesheet library="archive-timeline" name="responsive-calendar.css"/>
		
		<!-- <h:outputStylesheet library="archive-timeline" name="bootstrap.min.css" /> -->
				
		<h:outputScript library="js" name="tipped.js" target="head" />
		<h:outputStylesheet library="css" name="tipped.css"/>		
	
		<h:outputScript library="archive-timeline" name="archive_timeline_template.js" target="head"/>
		<h:outputStylesheet library="archive-timeline" name="archive_timeline.css"/>
	 
		<h:form style="display:none">
			<p:remoteCommand action="#{archiveTimeLineBean.getHighChartsJsonData()}" name="fetchHighChartsJsonData" process="@this" partialSubmit="true" autoRun="false" oncomplete="handleJsonData(xhr, status, args);"/>
			<p:remoteCommand action="#{archiveTimeLineBean.getCalendarJsonData()}" name="fetchCalendarJsonData" process="@this" partialSubmit="true" autoRun="false" oncomplete="handleCalendarData(xhr, status, args);"/>
		</h:form>		
		<script>
			var resId = ${res_id};
			fetchHighChartsJsonData([{name:'resource_id', value:resId}]);
			fetchCalendarJsonData([{name:'resource_id', value:resId}]);
			
			function loadCalendar(calendar_data){
				$('.responsive-calendar').responsiveCalendar({
					time: '2010-11',
					allRows: false,
					translateMonths: #{archiveTimeLineBean.monthNames},
					events: calendar_data,
				    onActiveDayHover: function(events) {
					    var thisDayEvent, key;
					    key = $(this).data('year')+'-'+addLeadingZero( $(this).data('month') )+'-'+addLeadingZero( $(this).data('day') );
					    thisDayEvent = events[key];
				    	Tipped.create($(this),archiveVersionsList(thisDayEvent));
					} 
				});

			}
		</script>	
		<br/>
		<div class='box'>
		<h:panelGroup layout="block" id="container"></h:panelGroup>
		<div id="calendar">
			<!-- Responsive calendar - START -->
			<div class="responsive-calendar">
				<div class="controls">
					<a class="pull-left" data-go="prev"><h:panelGroup layout="block" class="btn btn-primary" style="background-color:#489a83;border-color: #3b8b74;">
							<i class="icon-chevron-left"></i> Prev
						</h:panelGroup></a>
					<h4 id="head-year-month">
						<span id="year" data-head-year="data-head-year"></span> <span id="month" data-head-month="data-head-month"></span>
					</h4>
					<a class="pull-right" data-go="next"><h:panelGroup layout="block" class="btn btn-primary" style="background-color:#489a83;border-color: #3b8b74;">
							Next <i class="icon-chevron-right"></i>
						</h:panelGroup>
					</a>
				</div>
				<hr />
				<h:panelGroup layout="block" class="day-headers">
					<ui:repeat var="day" value="#{archiveTimeLineBean.shortWeekDays}">
						<h:panelGroup layout="block" class="day header">#{day}</h:panelGroup>
					</ui:repeat>
				</h:panelGroup>
				<div class="days" data-group="days">
					<!-- the place where days will be generated -->
				</div>
			</div>
			<!-- Responsive calendar - END -->
			<h:outputLink style="float:right;color:#489a83" onclick="return open_timeline();"><i class="icon-circle-arrow-left"></i> Back to TimeLine View</h:outputLink>
		</div>
		</div>
	
</ui:composition>	