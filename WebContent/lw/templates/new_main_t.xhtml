<!DOCTYPE html>
<html xmlns:ui="http://java.sun.com/jsf/facelets" 
	xmlns:h="http://java.sun.com/jsf/html" 
	xmlns:f="http://java.sun.com/jsf/core" 
	xmlns:p="http://primefaces.org/ui" 
	lang="#{userBean.localeCode}">

<f:view locale="#{userBean.localeCode}" contentType="text/html">
	<ui:insert name="metadata" />

	<h:head>	
		<title><h:outputText value="#{pageTitle}" escape="false" /> - Learnweb</title>
		<link rel="shortcut icon" href="#{learnwebBean.baseUrl}../resources/icon/favicon.ico" />

		<link type="text/css" rel="stylesheet" href="#{learnwebBean.baseUrl}../resources/css/default.css" />
        <link rel="stylesheet" type="text/css" href="#{learnwebBean.baseUrl}../resources/css/nanoscroller.css" />
		<h:outputScript library="primefaces" name="jquery/jquery.js" target="head" />
		<h:outputScript library="main-template" name="default2.js"/>
		<h:outputScript library="js" name="jquery.mousewheel.min.js"/>
		<h:outputScript library="js" name="jquery.nanoscroller.min.js"/>
		
		<link rel="stylesheet" type="text/css" href="#{request.contextPath}/resources/main-template/main2.css" />
		<link rel="stylesheet" type="text/css" href="#{request.contextPath}/resources/main-template/responsive_design.css" />

		<script>
			(function(){
			        var t,i,e,n=window,o=document,a=arguments,s="script",r=["config","track","identify","visit","push","call","trackForm","trackClick"],c=function(){var t,i=this;for(i._e=[],t=0;r.length>t;t++)(function(t){i[t]=function(){return i._e.push([t].concat(Array.prototype.slice.call(arguments,0))),i}})(r[t])};for(n._w=n._w||{},t=0;a.length>t;t++)n._w[a[t]]=n[a[t]]=n[a[t]]||new c;i=o.createElement(s),i.async=1,i.src="//static.woopra.com/js/w.js",e=o.getElementsByTagName(s)[0],e.parentNode.insertBefore(i,e)
			})("woopra");
			
			woopra.config({
			    domain: 'learnweb.l3s.uni-hannover.de'
			});
		<ui:fragment rendered="#{userBean.loggedIn}">	
			woopra.identify({
		        email: "#{userBean.user.id}@learnweb.de",
		        name: "#{userBean.user.username}",
		        company: "#{userBean.activeCourse.title}"
			});		
		</ui:fragment>	
			woopra.track();
		</script>		
		<base href="#{request.contextPath}/lw/" />
		<ui:insert name="head-meta" />
	</h:head>

	<h:body>
		<p:growl id="growl" rendered="#{userBean.loggedIn and not disableGrowl}" />
		
		<ui:decorate template="/templates/main/tooltips.xhtml" />
		<ui:decorate template="/templates/main/header.xhtml" />
		
		<style type="text/css">
			.ui-layout-north { height:46px !important; }
		</style>
		<p:layout fullPage="true" widgetVar="mainLayout">
			<p:layoutUnit position="north" resizable="false" closable="false" collapsible="false" styleClass="northunit" style="display:block; height:46px;">
				<script type="text/javascript">	
				
					function scroller()
					{
						$(".nano").nanoScroller();
					}
					
					$(document).ready(function()
					{
						if($(".ui-layout-unit-content","#right_pane"))
						{
							$(".ui-layout-unit-content","#right_pane").addClass("nano");
							$(".ui-layout-unit-content","#right_pane").wrapInner('&lt;div class="content" /&gt;');
							$(".ui-layout-unit-content","#center_pane").addClass("nano");
							$(".ui-layout-unit-content","#left_pane").addClass("nano");
						}				
						scroller();
						setInterval("scroller()",500); 
					});	
				</script>				
			
				<ui:insert name="sub_menu_bar"></ui:insert>
				
			</p:layoutUnit>

			<p:layoutUnit id="left_pane" rendered="#{userBean.loggedIn and !utilBean.viewResultSetPage}" position="west" size="223" resizable="false" closable="false" collapsible="false">
				<div class="content">
					<ui:decorate template="/templates/main/group_menu.xhtml" />
				</div>
			</p:layoutUnit>

			<ui:insert name="right_layout" />
			
			<p:layoutUnit id="center_pane" position="center" >
				<div class="content" style="padding-right: 7px;">
					<p:messages id="message" styleClass="#{userBean.loggedIn? '':'small_page'}" escape="false" />
					
					<h:panelGroup layout="block" styleClass="small_page" rendered="#{loginRequired and !userBean.loggedIn}">
						<ui:include src="/templates/user/login.xhtml" />
					</h:panelGroup>
					
					<h:panelGroup rendered="#{!loginRequired || userBean.loggedIn}">
						<ui:insert name="center_layout"></ui:insert>
					</h:panelGroup>
				</div>

			</p:layoutUnit>

		</p:layout>
		<!-- 
		<p:dialog header="Shared Resultsets" widgetVar="shared_resultsets_dialog" modal="false" minWidth="600" resizable="false" rendered="#{userBean.searchHistoryEnabled}">			
			<h:form id="shared_resultsets_form">
				<ui:decorate template="/lw/user/shared_resultsets.xhtml"></ui:decorate>
			</h:form> 			
		</p:dialog>	
		 -->
		 
		<ui:insert name="bottom_panel"></ui:insert>
	
		<h:panelGroup layout="block" id="footer" rendered="#{not empty helpText and (!loginRequired || userBean.loggedIn)}" styleClass="#{userBean.getPreference('helptext_hide')? 'display-none':''}">
			<h:outputText value="?" id="footer_question_mark" class="align-center"/>
			<h:outputText value="#{helpText}" escape="false" style="padding: 0.7rem 10rem; display:block; font-size:1.5rem;" />
			<a href="#" onclick="return footerClose();" id="footer_close" title="#{msg.close}"></a>
		</h:panelGroup>
		
		<h:form styleClass="display-none">	
			<p:remoteCommand actionListener="#{userBean.setPreferenceRemote()}" name="setPreferenceRemote" async="true" immediate="true" process="@this" />
		</h:form>
		
	</h:body>
</f:view>

</html>

