<ui:composition xmlns="http://www.w3.org/1999/xhtml"
				xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
				xmlns:h="http://xmlns.jcp.org/jsf/html"
				xmlns:f="http://xmlns.jcp.org/jsf/core"
				xmlns:p="http://primefaces.org/ui">

	<h:outputScript name="vendor/montage-v1.0.0/jquery.montage.min.js" target="head"/>

	<div id="fact_sheet_wrapper">
		<div id="fact_sheet_image_wrapper" style="height: 184px">
			<h:outputLink value="search.jsf">
				<f:param name="action" value="image"/>
				<f:param name="query" value="#{searchBean.query}"/>

				<div id="more_images_box">
					More Images
				</div>
			</h:outputLink>

			<table>
				<tr>
					<td id="fact_sheet_first_image_td">
						<ui:fragment rendered="#{searchBean.graph.entities[0].thumbnail != ''}">
							<div id="fact_sheet_first_image">
								<img onerror="this.style.display='none';" src="#{searchBean.graph.entities[0].thumbnail}"></img>
							</div>
						</ui:fragment>
					</td>
					<td>
						<div id="am-container" class="am-container fact_sheet_images">
							<p:repeat var="image" value="#{searchBean.images.resources}">
								<a href=""><img src="#{image.thumbnail2.url}"></img></a>
							</p:repeat>
						</div>
					</td>
				</tr>
			</table>
		</div>
		<div id="fact_sheet_contents">
			<div id="fact_sheet_label">#{searchBean.graph.entities[0].label}</div>
			<div id="fact_sheet_description">#{searchBean.graph.entities[0].description}</div>
			<ui:fragment rendered="#{not empty searchBean.graph.entities[0].birthDate  and not empty searchBean.graph.entities[0].birthPlace }">
				<div class="fact_sheet_detail">
					<h:outputText value="#{msg.Born}: " styleClass="fact_sheet_field"/>
					<h:outputText value="#{searchBean.graph.entities[0].birthDate}" styleClass="fact_sheet_value">
							<f:convertDateTime  dateStyle="long"/>
						</h:outputText>
						#{msg.in_location} #{searchBean.graph.entities[0].birthPlace}
				</div>
			</ui:fragment>
			<ui:fragment rendered="#{empty searchBean.graph.entities[0].birthDate and not empty searchBean.graph.entities[0].birthPlace }">
				<div class="fact_sheet_detail">
					<h:outputText value="#{msg.Place_of_birth}: " styleClass="fact_sheet_field"/><span class="fact_sheet_value">#{searchBean.graph.entities[0].birthPlace}</span>
				</div>
			</ui:fragment>
			<ui:fragment rendered="#{empty searchBean.graph.entities[0].birthPlace and not empty searchBean.graph.entities[0].birthDate}">
				<div class="fact_sheet_detail">
					<h:outputText value="#{msg.Date_of_birth}: " styleClass="fact_sheet_field"/>
					<h:outputText value="#{searchBean.graph.entities[0].birthDate}" styleClass="fact_sheet_value">
							<f:convertDateTime  dateStyle="long"/>
						</h:outputText>
				</div>
			</ui:fragment>
			<ui:fragment rendered="#{not empty searchBean.graph.entities[0].deathDate and not empty searchBean.graph.entities[0].deathPlace }">
				<div class="fact_sheet_detail">
					<h:outputText value="#{msg.Died}: " styleClass="fact_sheet_field"/>
					<span class="fact_sheet_value">
						<h:outputText value="#{searchBean.graph.entities[0].deathDate}" styleClass="fact_sheet_value">
							<f:convertDateTime  dateStyle="long"/>
						</h:outputText>
						#{msg.in_location} #{searchBean.graph.entities[0].deathPlace}
					</span>
				</div>
			</ui:fragment>
			<ui:fragment rendered="#{empty searchBean.graph.entities[0].deathDate and not empty searchBean.graph.entities[0].deathPlace}">
				<div class="fact_sheet_detail">
					<h:outputText value="#{msg.Place_of_death}: " styleClass="fact_sheet_field"/><span class="fact_sheet_value">#{searchBean.graph.entities[0].deathPlace}</span>
				</div>
			</ui:fragment>
			<ui:fragment rendered="#{empty searchBean.graph.entities[0].deathPlace and not empty searchBean.graph.entities[0].deathDate}">
				<div class="fact_sheet_detail">
					<h:outputText value="#{msg.Date_of_death}: " styleClass="fact_sheet_field"/>

					<h:outputText value="#{searchBean.graph.entities[0].deathDate}" styleClass="fact_sheet_value">
							<f:convertDateTime  dateStyle="long"/>
						</h:outputText>
				</div>
			</ui:fragment>
			<ui:fragment rendered="#{not empty searchBean.graph.entities[0].fullName }">
				<div class="fact_sheet_detail">
					<h:outputText value="#{msg.full_name}: " styleClass="fact_sheet_field"/><span class="fact_sheet_value">#{searchBean.graph.entities[0].fullName}</span>
				</div>
			</ui:fragment>
			<ui:fragment rendered="#{not empty searchBean.graph.entities[0].birthName}">
				<div class="fact_sheet_detail">
					<h:outputText value="#{msg.birth_name}: " styleClass="fact_sheet_field"/><span class="fact_sheet_value">#{searchBean.graph.entities[0].birthName}</span>
				</div>
			</ui:fragment>
			<ui:fragment rendered="#{not empty searchBean.graph.entities[0].alternativeNames}">
				<div class="fact_sheet_detail">
					<h:outputText value="#{msg.alternative_names}: " styleClass="fact_sheet_field"/><span class="fact_sheet_value">#{searchBean.graph.entities[0].alternativeNames}</span>
				</div>
			</ui:fragment>
			<ui:fragment rendered="#{not empty searchBean.graph.entities[0].children}">
				<div class="fact_sheet_detail">
					<h:outputText value="#{msg.children}: " styleClass="fact_sheet_field"/><span class="fact_sheet_value">#{searchBean.graph.entities[0].children}</span>
				</div>
			</ui:fragment>
			<ui:fragment rendered="#{not empty searchBean.graph.entities[0].spouse}">
				<div class="fact_sheet_detail">
					<h:outputText value="#{msg.spouse}: " styleClass="fact_sheet_field"/><span class="fact_sheet_value">#{searchBean.graph.entities[0].spouse}</span>
				</div>
			</ui:fragment>
			<ui:fragment rendered="#{searchBean.graph.entities.size() gt 1}">
				<div id="related_search">Related Links</div>
				<ul id="related_search_list">
					<p:repeat var="entity" value="#{searchBean.graph.entities.subList(1,searchBean.graph.entities.size())}">
						<li><a target="_new" href="#{entity.url}">#{entity.label}</a></li>
					</p:repeat>
				</ul>
			</ui:fragment>
		</div>
	</div>
	<script type="text/javascript">
		$(function() {
			// initialize the plugin
			var $container 	= $('#am-container'),
				$imgs		= $container.find('img').hide(),
				totalImgs	= $imgs.length,
				cnt			= 0;
			$imgs.each(function(i) {
				var $img	= $(this);
				$('<img/>').on('load', function() {
					++cnt;
					if( cnt === totalImgs ) {
						$imgs.show();
						$container.montage({
							fluid: false,
							minsize	: false,
							fixedHeight: 90,
							margin 	: 1
						});
					}
				}).attr('src',$img.attr('src'));
			});
		});
	</script>

</ui:composition>
