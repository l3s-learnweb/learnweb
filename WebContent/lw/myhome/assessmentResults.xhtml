<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core" xmlns:p="http://primefaces.org/ui">

<ui:composition template="/templates/main/main.xhtml">
	<ui:param name="loginRequired" value="true" />
	<ui:param name="pageTitle" value="Assessment results" />

	<ui:define name="center_layout">

		<p:panel header="Assessment results" style="max-width:100rem; margin:8px auto; font-size:1.6rem;">

			<h:outputText rendered="#{assessmentResultBean.mandatorySurveySubmitted}" />

			<h:outputText rendered="#{empty assessmentResultBean.peerAssessmentPairs}" value="You did not participate in any assessment." />
				
			<ui:repeat var="pair" value="#{assessmentResultBean.peerAssessmentPairs}">

				<ui:fragment rendered="#{not assessmentResultBean.mandatorySurveySubmitted}">
					Please answer the
					<h:outputLink value="survey/survey.jsf">
						<f:param name="resource_id" value="#{assessmentResultBean.mandatorySurvey.id}" />
						<f:param name="go_back" value="assessmentResults" />
						<h:outputText value="#{assessmentResultBean.mandatorySurvey.title}" />
					</h:outputLink>
					to view the assessment results.			
				</ui:fragment>

				<h:panelGrid columns="2" columnClasses="nowrap bold," rendered="#{assessmentResultBean.mandatorySurveySubmitted}" cellspacing="8">

					<h:outputText value="Peer assessment:" style="font-weight:bold;" />
					<h:outputLink value="survey/answer.jsf" rendered="#{pair.peerAssessmentUserAnswers.saved}">
						<f:param name="resource_id" value="#{pair.peerAssessmentSurveyResourceId}" />
						<f:param name="user_id" value="#{pair.assessorUserId}" />
						<h:outputText value="#{pair.peerAssessment.title}" />
					</h:outputLink>
					<h:outputText rendered="#{not pair.peerAssessmentUserAnswers.saved}" value="Your partner didn't submit the peer assessment :(" />

					<h:outputText value="Assessment:" class="bold" />
					<h:panelGroup rendered="#{not empty pair.assessment.submittedAnswersOfAllUsers}">
						<ui:repeat var="answer" value="#{pair.assessment.submittedAnswersOfAllUsers}">
							<h:outputLink value="survey/answer.jsf">
								<f:param name="resource_id" value="#{pair.assessmentSurveyResourceId}" />
								<f:param name="user_id" value="#{answer.userId}" />
								<h:outputText value="#{pair.peerAssessment.title} (#{answer.user.realUsername})" />
							</h:outputLink>
						</ui:repeat>
					</h:panelGroup>
					<h:outputText rendered="#{empty pair.assessment.submittedAnswersOfAllUsers}"
						value="The teacher's assessment wasn't submitted (yet). Maybe you will retrieve it directly from your teacher." />

				</h:panelGrid>

			</ui:repeat>
		</p:panel>

	</ui:define>
</ui:composition>
</html>