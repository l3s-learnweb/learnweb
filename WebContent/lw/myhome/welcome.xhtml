<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">	
	
	<ui:composition template="/lw/templates/new_main.xhtml"> 

		<ui:param name="loginRequired" value="true"/>
		<ui:param name="pageTitle" value="#{msg.welcome}"/>	
		
		
		
		<ui:define name="center_layout">
						
			<p:panel rendered="#{welcomeBean.welcomeMessage.length() > 5}">
				<f:facet name="header">
					#{msg.welcome}
					<h:panelGroup rendered="#{userBean.admin || userBean.moderator}">
						<a href="admin/organisation.jsf"><h:graphicImage value="/resources/icon/silk/pencil.png" width="16" height="16" alt="#{msg.edit}" /></a>
					</h:panelGroup>
				</f:facet>
				
				<h:panelGroup rendered="#{userBean.activeCourse.id == 505}">
					<div>
						<p>
							<img style="float:left;" src="http://g.etfv.co/http://www.facebook.com" alt="facebook" width="16" height="16" /> 
							<span style="margin:2px; display:inline-block;">
								Do you want to share the YELL/TELL with your friends? 
							</span>
						</p>
						<iframe src='//www.facebook.com/plugins/like.php?href=http%3A%2F%2Flearnweb.l3s.uni-hannover.de%2FLearnweb-Tomcat%2Flw%2Fpublic%2Fyell.jsf&amp;width&amp;layout=standard&amp;action=like&amp;show_faces=true&amp;share=true&amp;height=80&amp;appId=181712555296062' scrolling='no' frameborder='0' style='border:none; overflow:hidden; height:35px;' allowTransparency='true'></iframe>
						<div>
							Click <h:outputLink value="public/yell.jsf">here</h:outputLink> to view the user guide.
						</div>
						<br />
					</div>
				</h:panelGroup>
				
				<h:outputText value="#{welcomeBean.welcomeMessage}" escape="false" id="welcometext" />	
			</p:panel>
			
			<ui:repeat var="course" value="#{userBean.user.courses}">
				<p:panel rendered="#{course.welcomeMessage.length() > 5}">
					<f:facet name="header">
						<h:outputText value="#{course.title}" />
						<h:panelGroup rendered="#{userBean.admin || userBean.moderator}">
							<a href="admin/course.jsf?course_id=#{course.id}"><h:graphicImage value="/resources/icon/silk/pencil.png" width="16" height="16" alt="#{msg.edit}" /></a>
						</h:panelGroup>
					</f:facet>
					
					<h:outputText value="#{course.welcomeMessage}" escape="false" id="welcometext" />
					</p:panel>
			</ui:repeat>
			
			
			
			<p:panel header="#{msg.myGroups}" toggleable="true" collapsed="true">
				<h:outputText value="#{msg.should_join_group}" escape="false" rendered="${userBean.user.groups.size() == 0}" />
			
				<ui:repeat var="group" value="#{userBean.user.groups}">
					<h:panelGroup>					
						<h3>
							<h:outputLink value="group/overview.jsf">
								<f:param name="group_id" value="#{group.id}" />
								<h:outputText value="#{group.title}:" />
							</h:outputLink>
						</h3>
						<ul>
							<ui:repeat var="entry" value="#{group.logs}">
							<li class="#{group.getLastVisit(userBean.user)*1000 lt entry.date.time? 'bold':''}">
								<h:outputText value="#{entry.date}" >
									<f:convertDateTime dateStyle="default" type="date" timeZone="#{userBean.timeZone}" />								
								</h:outputText> - 
								<h:outputText value="#{entry.description}" escape="false" /> 
							</li>
							
							</ui:repeat>
						</ul>
					</h:panelGroup>
				</ui:repeat>
		
			
			</p:panel>
		</ui:define>
	</ui:composition>
</html>