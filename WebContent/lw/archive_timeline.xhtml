<ui:composition template="/templates/main/main.xhtml" 
	xmlns:ui="http://java.sun.com/jsf/facelets" 
	xmlns:h="http://java.sun.com/jsf/html" 
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough">
	
	<ui:param name="pageTitle" value="ArchiveTimeline" />
	
	<ui:define name="center_layout">
		<p:chart type="line" model="#{archiveTimeLineBean.dateModel}" style="height:400px;" responsive="true" widgetVar="chart">
			<p:ajax event="itemSelect" listener="#{archiveTimeLineBean.itemSelect}" update=":growl" />
		</p:chart>
		
		<p:commandButton type="button" value="Reset" icon="ui-icon-cancel" style="margin-left:5px;" onclick="PF('chart').resetZoom()"/>
		<script src="http://code.highcharts.com/highcharts.js"></script>
		<script src="http://code.highcharts.com/modules/exporting.js"></script>
		<link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" />
		
		<h:outputScript library="archive-timeline" name="responsive-calendar.min.js" />
		<h:outputStylesheet library="archive-timeline" name="responsive-calendar.css"/>
		<h:outputStylesheet library="archive-timeline" name="bootstrap.min.css"/>
		<h:outputScript library="archive-timeline" name="archive_timeline.js" />
		<h:outputStylesheet library="css" name="tipped.css"/>
		
		<h:outputScript library="js" name="tipped.js" />
		
		<script>
		$(document).ready(function(){
			
			json(#{archiveTimeLineBean.getJsonData()});
			$('.responsive-calendar').responsiveCalendar({
				time: '2010-11',
				translateMonths: #{archiveTimeLineBean.monthNames},
		          events: {
				        "2010-11-30": {
				            "dayEvents": [
							                {
							                    "time": "2010-11-30 02:23:10.0",
							                    "url": "https://wayback.archive-it.org/2212/20101130022310/https://www.moma.org/"
							                }
							            ],
				            "badgeClass": "badge-warning",
				            "number": 1
				        },
				        "2010-11-23": {
				            "dayEvents": [
				                {
				                    "time": "2010-11-23 22:02:10.0",
				                    "url": "https://wayback.archive-it.org/2212/20101123220210/http://www.moma.org//"
				                }
				            ],
				            "badgeClass": "badge-warning",
				            "number": 1
				        },
				        "2010-11-22": {
				            "dayEvents": [
				                {
				                    "time": "2010-11-22 19:43:05.0",
				                    "url": "https://wayback.archive-it.org/2212/20101122194305/http://www.moma.org/"
				                }
				            ],
				            "badgeClass": "badge-warning",
				            "number": 1
				        },
				        "2010-11-17": {
				            "dayEvents": [
				                {
				                    "time": "2010-11-17 13:08:33.0",
				                    "url": "https://wayback.archive-it.org/2212/20101117130833/http://www.moma.org//"
				                }
				            ],
				            "badgeClass": "badge-warning",
				            "number": 1
				        },
				        "2010-11-15": {
				            "dayEvents": [
				                {
				                    "time": "2010-11-15 17:24:50.0",
				                    "url": "https://wayback.archive-it.org/2212/20101115172450/http://www.moma.org/"
				                },
				                {
				                    "time": "2010-11-15 19:43:31.0",
				                    "url": "https://wayback.archive-it.org/2212/20101115194331/http://www.moma.org/"
				                }
				            ],
				            "badgeClass": "badge-warning",
				            "number": 2
				        },
				        "2010-11-29": {
				            "dayEvents": [
				                {
				                    "time": "2010-11-29 20:25:07.0",
				                    "url": "https://wayback.archive-it.org/2212/20101129202507/http://www.moma.org/"
				                },
				                {
				                    "time": "2011-04-29 01:20:31.0",
				                    "url": "https://wayback.archive-it.org/2212/20110429012031/http://www.moma.org/"
				                },
				                {
				                    "time": "2011-04-29 06:10:33.0",
				                    "url": "https://wayback.archive-it.org/2212/20110429061033/https://www.moma.org/"
				                }
				            ],
				            "badgeClass": "badge-warning",
				            "number": 1
				        }
				    },
			    onActiveDayHover: function(events) {
				    var thisDayEvent, key;

				    key = $(this).data('year')+'-'+addLeadingZero( $(this).data('month') )+'-'+addLeadingZero( $(this).data('day') );
				    thisDayEvent = events[key];
				   
			    	Tipped.create($(this),archiveVersionsList(thisDayEvent));
			    	//alert(thisDayEvent.dayEvents[i]);	
			    
				} 
			});

		});
		</script>	
		<br/>
		<h:panelGroup layout="block" id="container" style="min-width: 200px; height: 400px;width:500px;float:left; "></h:panelGroup>
		<div id="calendar" style="width: 500px; height: 400px; overflow:hidden;">
			<!-- Responsive calendar - START -->
			<div class="responsive-calendar">
				<div class="controls">
					<a class="pull-left" data-go="prev"><h:panelGroup layout="block" class="btn btn-primary" style="background-color:#489a83;border-color: #3b8b74;">
							<i class="icon-chevron-left"></i> Prev
						</h:panelGroup></a>
					<h4>
						<span id="year" data-head-year="data-head-year"></span> <span id="month" data-head-month="data-head-month"></span>
					</h4>
					<a class="pull-right" data-go="next"><h:panelGroup layout="block" class="btn btn-primary" style="background-color:#489a83;border-color: #3b8b74;">
							Next <i class="icon-chevron-right"></i>
						</h:panelGroup>
					</a>
				</div>
				<hr />
				<h:panelGroup layout="block" class="day-headers">
					<ui:repeat var="day" value="#{archiveTimeLineBean.shortWeekDays}">
						<h:panelGroup layout="block" class="day header">#{day}</h:panelGroup>
					</ui:repeat>
				</h:panelGroup>
				<div class="days" data-group="days">
					<!-- the place where days will be generated -->
				</div>
			</div>
			<!-- Responsive calendar - END -->
		</div>
	</ui:define>
	
</ui:composition>	