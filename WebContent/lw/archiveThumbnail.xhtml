<ui:composition template="/templates/main/main.xhtml" 
xmlns:ui="http://java.sun.com/jsf/facelets" 
	xmlns:h="http://java.sun.com/jsf/html" 
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions"
	lang="#{userBean.localeCode}">

	<ui:define name="metadata">
		<f:metadata>
			<f:viewParam name="resource_id" value ="#{archiveThumbnailBean.resourceId}" />
			<f:event type="preRenderView" listener="#{archiveThumbnailBean.init}"/>
		</f:metadata>
	</ui:define>

	<ui:param name="pageTitle" value="#{msg['Archive.thumbnail_visualization']}" />

	<ui:define name="center_layout">

		<h:outputScript name="archive-thumbnail/contentflow.js" target="head" />
		<h:outputScript name="archive-thumbnail/archive_thumbnail.js" target="head" />
		<link rel="stylesheet" type="text/css" href="#{request.contextPath}/resources/archive-thumbnail/mycontentflow.css" />
		<link rel="stylesheet" type="text/css" href="#{request.contextPath}/resources/archive-thumbnail/styles.css" />
    	
    	<h:panelGroup id="maincontent"  layout="block">
    		
    		<h:panelGroup id="contentFlow" styleClass="ContentFlow" layout="block">
            	<div class="loadIndicator"><div class="indicator"></div></div>
            	<div class="flow">
                	<ui:repeat var="image" value="#{archiveThumbnailBean.listOfUrls}">
                      <div class="item">
                      <img src="#{image.fileUrl}" class="content" alt=""/>
                      <div class="caption">#{msg.date}: <a href="#{image.archiveUrl}" target="_blank">${userBean.formatDate(image.timestamp)}</a></div>
                      </div>
                	</ui:repeat>
            	</div>
            	<div class="globalCaption"></div>
        	</h:panelGroup>
        	<h:form id="timeline_form" prependId="false">
	        	<p:timeline id="timeline" styleClass="timeline"
	                     value="#{archiveThumbnailBean.model}"  
	                     min="#{archiveThumbnailBean.min}"  
	                     max="#{archiveThumbnailBean.max}"  
	                     zoomMin="#{archiveThumbnailBean.zoomMin}"  
	                     zoomMax="#{archiveThumbnailBean.zoomMax}"
	                     zoomable="true"
	                     movable="true"
	                     axisOnTop="true" 
	                     height="125px" showNavigation="true" widgetVar="tmlnbar" stackEvents="false">
	        		<p:ajax event="select" oncomplete="timelineEventSelect()"/> 
	        	</p:timeline>
        	</h:form>
        </h:panelGroup>      
        
        <div class="rightpanel">
        	
			<h:form prependId="false" styleClass="rightpanelContent">
				<div class="messageDiv">Kindly refresh the page if you don't see the thumbnails.</div>
				<div class="htmlDiv">
					
					<h:outputText value="#{msg['Archive.html_summary_title']}:" styleClass="title" escape="false"/>
					
					<div class="helptext">E.g. If DOM similarity and text similarity is 0.85, then while comparing the versions in sequence it will remove those versions that have a similarity greater than 85% for both HTML DOM structure and text.</div>
					<div id="slideA" class="slideA" style="margin-top: 10px;"></div>
					<script>
						$(function() {
							$("#slideA").slider({
								range : "min",
								step : 0.05,
								value : 1,
								min : 0,
								max : 1,
								slide : function(event, ui) {
									$("#input_frame").val(ui.value);
								}
							});
							$("#input_frame").val($("#slideA").slider("value"));
						});
					</script>
					<h:outputLabel styleClass="textInputLabel" for="input_frame" value="DOM Sim. (increments of 0.05):" />
					<p:inputText id="input_frame" value="#{archiveThumbnailBean.frameSim}" styleClass="textInput">
					</p:inputText>
	
					<div id="slideB" class="slideA"></div>
					<script>
			            $(function() {
			                $("#slideB").slider({
			                    range: "min",
			                    step: 0.05,
			                    value: 1,
			                    min: 0,
			                    max: 1,
			                    slide: function(event, ui) {
			                        $("#input_text").val(ui.value);
			                    } 
			                });
			                $("#input_text").val($("#slideB").slider("value"));
			            });
	          		</script>
	
					<h:outputLabel styleClass="textInputLabel" for="input_text" value="Text Sim. (increments of 0.05):" />
					<p:inputText id="input_text" value="#{archiveThumbnailBean.textSim}" styleClass="textInput">
						
					</p:inputText>
					<div class="clear"></div>
					<p:commandButton id="process" styleClass="greenbutton" value="Submit" title="Press to refresh the Coverflow" update=":maincontent :timeline :no_of_resources1" oncomplete="loadCF(); loadTimeMaps();" actionListener="#{archiveThumbnailBean.computeSelectedArchivesHtmlBased}"/>
					<h:outputText id="no_of_resources1" value="(displaying #{archiveThumbnailBean.selectedArchiveUrls.size()} out of #{archiveThumbnailBean.archiveUrls.size()})" style="color:black"/>
				</div>
				<div class="simhashDiv">
					<h:outputText value="#{msg['Archive.simhash_summary_title']}:" styleClass="title" escape="false"/>
					<br/>
					<p:commandButton id="alsum" style="margin-top:5px;" styleClass="greenbutton" value="AlSummarization" title="Press to refresh the Coverflow" update=":maincontent :timeline no_of_resources2" oncomplete="loadCF()" actionListener="#{archiveThumbnailBean.computeSelectedArchivesSimhashBased}"/>
					<h:outputText id="no_of_resources2" value="(displaying #{archiveThumbnailBean.selectedArchiveUrls.size()} out of #{archiveThumbnailBean.archiveUrls.size()})" style="color:black"/>
				</div>
			</h:form>
		</div>
	</ui:define>
</ui:composition>