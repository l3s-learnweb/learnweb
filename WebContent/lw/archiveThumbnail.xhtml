<ui:composition template="/WEB-INF/templates/layout/template-page.xhtml"
				xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
				xmlns:h="http://xmlns.jcp.org/jsf/html"
				xmlns:f="http://xmlns.jcp.org/jsf/core"
				xmlns:p="http://primefaces.org/ui">

	<ui:define name="metadata">
		<f:metadata>
			<f:viewParam name="resource_id" value ="#{archiveThumbnailBean.resourceId}"/>
			<f:viewAction action="#{archiveThumbnailBean.init}"/>
		</f:metadata>
	</ui:define>

	<ui:param name="pageTitle" value="#{msg['Archive.thumbnail_visualization']}"/>

	<ui:define name="center_layout">
		<h:outputScript library="learnweb-layout" name="js/archive-thumbnail.js" target="head"/>

    	<div class="section-archive-thumbnail">
			<h:panelGroup id="maincontent" layout="block">

				<h:panelGroup id="contentFlow" styleClass="ContentFlow" layout="block">
					<div class="loadIndicator"><div class="indicator"></div></div>
					<div class="flow">
						<p:contentFlow value="#{archiveThumbnailBean.listOfUrls}" var="image" widgetVar="contentFlow">
							<p:graphicImage value="#{image.fileUrl}" styleClass="content"/>
							<div class="caption">#{msg.date}: <a href="#{image.archiveUrl}" target="_blank">${userBean.formatDate(image.timestamp)}</a></div>
						</p:contentFlow>
					</div>
					<div class="globalCaption"></div>
				</h:panelGroup>
				<h:form id="timeline_form" prependId="false">
					<p:timeline id="timeline" styleClass="timeline"
							 value="#{archiveThumbnailBean.model}"
							 min="#{archiveThumbnailBean.min}"
							 max="#{archiveThumbnailBean.max}"
							 zoomMin="#{archiveThumbnailBean.zoomMin}"
							 zoomMax="#{archiveThumbnailBean.zoomMax}"
							 zoomable="true"
							 movable="true"
							 axisOnTop="true"
							 height="125px" showNavigation="true" widgetVar="tmlnbar" stackEvents="false">
						<p:ajax event="select" oncomplete="timelineEventSelect()"/>
					</p:timeline>
				</h:form>
			</h:panelGroup>

			<div class="rightpanel">

				<h:form prependId="false" styleClass="rightpanelContent">
					<div class="messageDiv">Kindly refresh the page if you don't see the thumbnails.</div>
					<div class="htmlDiv">

						<h:outputText value="#{msg['Archive.html_summary_title']}:" styleClass="title" escape="false"/>

						<div class="helptext">E.g. If DOM similarity and text similarity is 0.85, then while comparing the versions in sequence it will remove those versions that have a similarity greater than 85% for both HTML DOM structure and text.</div>
						<div id="slideA" class="slideA" style="margin-top: 10px;"></div>
						<script>
							$(function() {
								$("#slideA").slider({
									range : "min",
									step : 0.05,
									value : 1,
									min : 0,
									max : 1,
									slide : function(event, ui) {
										$("#input_frame").val(ui.value);
									}
								});
								$("#input_frame").val($("#slideA").slider("value"));
							});
						</script>
						<h:outputLabel styleClass="textInputLabel" for="input_frame" value="DOM Sim. (increments of 0.05):"/>
						<p:inputText id="input_frame" value="#{archiveThumbnailBean.frameSim}" styleClass="textInput">
						</p:inputText>

						<div id="slideB" class="slideA"></div>
						<script>
							$(function() {
								$("#slideB").slider({
									range: "min",
									step: 0.05,
									value: 1,
									min: 0,
									max: 1,
									slide: function(event, ui) {
										$("#input_text").val(ui.value);
									}
								});
								$("#input_text").val($("#slideB").slider("value"));
							});
						</script>

						<h:outputLabel styleClass="textInputLabel" for="input_text" value="Text Sim. (increments of 0.05):"/>
						<p:inputText id="input_text" value="#{archiveThumbnailBean.textSim}" styleClass="textInput">

						</p:inputText>
						<div class="clear"></div>
						<p:commandButton id="process" value="Submit" title="Press to refresh the Coverflow" update=":maincontent :timeline :no_of_resources1" oncomplete="loadCF(); loadTimeMaps();" actionListener="#{archiveThumbnailBean.computeSelectedArchivesHtmlBased}"/>
						<h:outputText id="no_of_resources1" value="(displaying #{archiveThumbnailBean.selectedArchiveUrls.size()} out of #{archiveThumbnailBean.archiveUrls.size()})" style="color:black"/>
					</div>
					<div class="simhashDiv">
						<h:outputText value="#{msg['Archive.simhash_summary_title']}:" styleClass="title" escape="false"/>
						<br/>
						<p:commandButton id="alsum" style="margin-top:5px;" value="AlSummarization" title="Press to refresh the Coverflow" update=":maincontent :timeline no_of_resources2" oncomplete="loadCF()" actionListener="#{archiveThumbnailBean.computeSelectedArchivesSimhashBased}"/>
						<h:outputText id="no_of_resources2" value="(displaying #{archiveThumbnailBean.selectedArchiveUrls.size()} out of #{archiveThumbnailBean.archiveUrls.size()})" style="color:black"/>
					</div>
				</h:form>
			</div>
		</div>
	</ui:define>
</ui:composition>
