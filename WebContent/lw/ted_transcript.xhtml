<ui:composition template="/templates/main/main.xhtml" 
	xmlns:ui="http://java.sun.com/jsf/facelets" 
	xmlns:h="http://java.sun.com/jsf/html" 
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	lang="#{userBean.localeCode}">

	<ui:define name="metadata">
		<f:metadata>
			<f:viewParam name="resource_id" value ="#{tedTranscriptBean.resourceId}" />
			<f:event type="preRenderView" listener="#{tedTranscriptBean.preRenderView}" />
		</f:metadata>
	</ui:define>

	<ui:param name="pageTitle" value="#{msg.tedTranscriptTitle}" />	
	<ui:param name="helpText" value="#{msg.tedTranscriptHelp}"/>
	<ui:param name="helpTextStyle" value="tedtranscript_help" />
	
	<ui:define name="center_layout">
		<h:outputStylesheet library="css" name="ted_transcript.css"  />
		<h:outputStylesheet library="css" name="tipped.css"  />
		<h:outputScript library="js" name="ted_transcript.js" target="head"/>
		<h:outputScript library="js" name="tipped.js" target="head"/>
		<h:outputScript library="js" name="imagesloaded.pkgd.min.js" target="head"/>
		<h:outputScript library="js" name="log4javascript_stub.js" target="head"/>
	    <h:outputScript library="js" name="rangy-core.js" target="head"/>
	    <h:outputScript library="js" name="rangy-dom.js" target="head"/>
	    <h:outputScript library="js" name="rangy-domrange.js" target="head"/>
	    <h:outputScript library="js" name="rangy-wrappedrange.js" target="head"/>
	    <h:outputScript library="js" name="rangy-wrappedselection.js" target="head"/>
	    <h:outputScript library="js" name="rangy-cssclassapplier.js" target="head"/>
	    <h:outputScript library="js" name="rangy-highlighter.js" target="head"/>
	    
  		<script type="text/javascript">
  			var noteid = #{tedTranscriptBean.noteId};
  		</script>		
		<div id="ted_content">
		<div class="embedded" id="ted_embedded">		
			<!-- ${tedTranscriptBean.tedResource.embedded} -->	
		</div>		
		
		<h:panelGroup layout="block" id="search_right_bar" class="right_bar">
			<p:outputPanel autoUpdate="true">
				<h:form>
					<p:outputLabel for="select_lang" value="#{msg.select_transcript_lang}" />
			        <h:selectOneMenu id="select_lang" value="#{tedTranscriptBean.transcriptLanguage}" >
			           <f:selectItem itemValue="----------------------------"/>
			           <f:selectItems value="#{tedTranscriptBean.getLanguageList()}"/>
			        </h:selectOneMenu>
					<p:commandButton value="Okay" ajax="true" update=":transcript_form:hidden_transcript" action="#{tedTranscriptBean.setTranscript}" oncomplete="displayTranscript();"/>

					<p:commandButton styleClass="savebutton" value="#{msg.save}" onclick="saveEditing();" style="float:right;"></p:commandButton>
				</h:form>
				<b>Note:</b>#{msg.transcript_note}
				<p:separator/>
			</p:outputPanel>
			<h:form id="transcript_form">
				<h:inputHidden id="hidden_transcript" value="#{tedTranscriptBean.tedResource.transcript}" />
			</h:form>
			<div onmouseup="noteSelectedText()" id="ted_transcript" class="tedTranscript">
					
			</div>

		</h:panelGroup>
		</div>

		<h:form style="display:none;">
			<p:remoteCommand actionListener="${tedTranscriptBean.processActionSetSynonyms()}" name="setSynonymsForWord" oncomplete="setSynonyms(xhr,status,args);" async="false"/>
			<p:remoteCommand actionListener="${tedTranscriptBean.processActionSaveResource()}" name="saveTedResource" update=":growl" />
			<p:remoteCommand actionListener="${tedTranscriptBean.processActionSaveLog()}" name="saveTranscriptLog" />
		</h:form>	

		<p:dialog widgetVar="userinput_dialog" modal="true" header="#{msg.userAnnotation}" minWidth="600" resizable="false" closable="false" appendTo="@(body)">
			<h:outputLabel value="#{msg.justify_selection}" for="text"/>
			<p:inputText id="text" style="width:97%;"/>
			<p:commandButton value="Ok" onclick="getUserText('ok');"></p:commandButton>
			<p:commandButton value="#{msg.cancel}" onclick="getUserText('cancel');"></p:commandButton>
		</p:dialog>

	</ui:define>
	
</ui:composition>
