<ui:composition template="/templates/main/main.xhtml" 
	xmlns:ui="http://java.sun.com/jsf/facelets" 
	xmlns:h="http://java.sun.com/jsf/html" 
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	lang="#{userBean.localeCode}">

	<ui:define name="metadata">
		<f:metadata>
			<f:viewParam name="resource_id" value ="#{tedTranscriptBean.resourceId}" />
			<f:event type="preRenderView" listener="#{tedTranscriptBean.preRenderView}" />
		</f:metadata>
	</ui:define>

	<ui:param name="pageTitle" value="#{msg.tedTranscriptTitle}" />	
	<ui:param name="helpText" value="#{msg.tedTranscriptHelp}"/>
	<ui:param name="helpTextStyle" value="tedtranscript_help" />
	
	<ui:define name="center_layout">

		<h:form class="display-none" id="command_form">
			<p:remoteCommand partialSubmit="true" immediate="true" actionListener="${tedTranscriptBean.processActionSetSynonyms()}" name="setSynonymsForWord" process="@this" oncomplete="setSynonyms(xhr,status,args);" async="false"/>
			<p:remoteCommand partialSubmit="true" immediate="true" actionListener="${tedTranscriptBean.processActionSaveResource()}" name="saveTedResource" process="@this" update=":growl" />
			<p:remoteCommand partialSubmit="true" immediate="true" actionListener="${tedTranscriptBean.processActionSaveLog()}" name="saveTranscriptLog" process="@this" update="@none" />
		</h:form>	
		
		<h:outputStylesheet library="css" name="tipped.css"  />
		<h:outputStylesheet library="ted_transcript" name="ted_transcript.css"  />
		<h:outputScript library="js" name="tipped.js" target="head"/>
		<h:outputScript library="ted_transcript" name="ted_transcript.js" target="head"/>		
		<!-- <h:outputScript library="ted_transcript" name="imagesloaded.pkgd.min.js" target="head"/>
		<h:outputScript library="ted_transcript" name="log4javascript_stub.js" target="head"/>
	    <h:outputScript library="ted_transcript" name="rangy-core.js" target="head"/>
	    <h:outputScript library="ted_transcript" name="rangy-dom.js" target="head"/>
	    <h:outputScript library="ted_transcript" name="rangy-domrange.js" target="head"/>
	    <h:outputScript library="ted_transcript" name="rangy-wrappedrange.js" target="head"/>
	    <h:outputScript library="ted_transcript" name="rangy-wrappedselection.js" target="head"/>
	    <h:outputScript library="ted_transcript" name="rangy-cssclassapplier.js" target="head"/>
	    <h:outputScript library="ted_transcript" name="rangy-highlighter.js" target="head"/> -->
	    
  		<script type="text/javascript">
  			var noteid = #{tedTranscriptBean.noteId};
  		</script>		

		<div id="ted_content">
		<div class="embedded" id="ted_embedded" >		
			<!-- ${tedTranscriptBean.tedResource.embedded} -->	
		</div>		
		
		<h:panelGroup layout="block" id="transcript_column" class="right_bar">
			<p:outputPanel>
				<div class="center-header">
					<h:form>
						<p:outputLabel for="select_lang" value="#{msg.select_transcript_lang}:" />
				        <h:selectOneMenu id="select_lang" value="#{tedTranscriptBean.transcriptLanguage}" >
				           <f:selectItem itemValue="----------------------------"/>
				           <f:selectItems value="#{tedTranscriptBean.getLanguageList()}"/>
				           <p:ajax listener="#{tedTranscriptBean.setTranscript}" update=":transcript"/>
				        </h:selectOneMenu>
						<p:commandButton styleClass="button_position greenbutton" value="#{msg.save}" onclick="saveEditing();" rendered="#{!tedTranscriptBean.tedResource.group.readOnly}"/>
					</h:form>
				</div>
				<div class="transcript_note">
					<b>#{msg.note}:</b><h:outputText value = " #{msg.transcript_warning}" rendered="#{tedTranscriptBean.tedResource.group.readOnly}"/>
					<h:outputText value = " #{msg.transcript_note}" rendered="#{!tedTranscriptBean.tedResource.group.readOnly}"/>
				</div>
			</p:outputPanel>
			<h:panelGroup layout="block" id="transcript">
				<h:panelGroup layout="block" onmouseup="noteSelectedText()" id="ted_transcript" class="tedTranscript" rendered="#{!tedTranscriptBean.tedResource.group.readOnly}">
						<h:outputText value="#{tedTranscriptBean.tedResource.transcript}" escape="false"/>
				</h:panelGroup>
				<h:panelGroup layout="block" class="tedTranscript" rendered="#{tedTranscriptBean.tedResource.group.readOnly}">
						<h:outputText value="#{tedTranscriptBean.tedResource.transcript}" escape="false"/>
				</h:panelGroup>
			</h:panelGroup>
		</h:panelGroup>
		</div>

		<p:dialog widgetVar="userinput_dialog" modal="true" header="#{msg.userAnnotation}" minWidth="600" resizable="false" closable="false" appendTo="@(body)">
			<h:form id="userinput_form" prependId="false">
				<h:outputLabel value="#{msg.justify_selection}:" for="text"/>
				<p:inputText id="text" style="width:97%;"/>
				<p:commandButton id="userinput_ok" value="Ok" onclick="getUserText('ok');return false;"></p:commandButton>
				<p:commandButton id="userinput_cancel" value="#{msg.cancel}" onclick="getUserText('cancel');return false;"></p:commandButton>
			</h:form>
		</p:dialog>

	</ui:define>
	
</ui:composition>
