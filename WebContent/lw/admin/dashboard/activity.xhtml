<ui:composition template="/WEB-INF/templates/layout/template.xhtml"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:p="http://primefaces.org/ui">

<ui:param name="loginRequired" value="true"/>
<ui:define name="metadata">
    <f:metadata>
        <f:viewAction action="#{activityDashboardBean.onLoad}"/>
    </f:metadata>
</ui:define>
<ui:param name="loginRequired" value="true"/>
<ui:param name="pageTitle" value="Activity Dashboard"/>

<ui:define name="content">
    <h:outputStylesheet library="admin-dashboard" name="activity.css"/>
    <h:outputScript library="admin-dashboard" name="activity.js" target="body"/>

    <div class="page-header">
        <h1>
            Activity Dashboard
        </h1>
    </div>

    <div class="form">
        <div class="p-grid">
            <div class="p-col-12">
                <div class="p-grid">

                    <div class="p-col no-padding">
                        <div class="p-col-12">
                            <div class="card card-w-title">

                                <div class="center-header user-activities" id="group_header">
                                    <h2>Users' Activities</h2>
                                    <p class="header_detail no-margin-top">All user interactions</p>
                                </div>
                                <ui:decorate template="templates/setSelectedUsers.xhtml">
                                    <ui:param name="selectedUsersIds" value="#{activityDashboardUsersBean.selectedUsersIds}"/>
                                    <ui:param name="defaultUsersList" value="#{activityDashboardUsersBean.defaultUsersList}"/>
                                    <ui:param name="groups" value="#{activityDashboardUsersBean.allGroups}"/>
                                    <ui:param name="startDate" value="#{activityDashboardBean.startDate}"/>
                                    <ui:param name="endDate" value="#{activityDashboardBean.endDate}"/>
                                    <ui:param name="actionForSubmit" value="#{activityDashboardBean.cleanAndUpdateStoredData()}"/>
                                    <ui:param name="panelsForUpdate" value="activityPanel"/>
                                    <ui:param name="selectedUsersIdsSize" value="#{activityDashboardUsersBean.getSelectedUsersIds().size()}"/>
                                </ui:decorate>
                                <div class="p-col-9 no-padding">
                                    <div id="grouped_activities" class="p-col-12">

                                        <p:selectManyCheckbox id="grid1" widgetVar="grid1"
                                                              value="#{activityDashboardBean.selectedActionItems}"
                                                              layout="responsive" columns="3" multiple="true"
                                                              onchange="unselectAllCheckBoxes(PF('grid2'))">

                                            <f:selectItems
                                                    value="#{activityDashboardBean.actions.keySet()}"
                                                    var="action" itemLabel="#{action}" itemValue="#{action}"/>

                                        </p:selectManyCheckbox>
                                    </div>

                                    <div class="p-col-4 no-padding-bottom">
                                        <div id="advanced_options">
                                            <span><h:outputText value="Advanced options"/></span> <i
                                                class="fa fa-angle-double-up"/>
                                        </div>
                                    </div>
                                    <div id="all_activities" class="p-col-12">
                                        <p:selectManyCheckbox id="grid2" widgetVar="grid2"
                                                              value="#{activityDashboardBean.selectedGroupedActions}"
                                                              layout="responsive" columns="3"
                                                              onchange="unselectAllCheckBoxes(PF('grid1'))">

                                            <f:selectItems value="#{activityDashboardBean.groupedActions}"
                                                           var="groupedAction" itemLabel="#{groupedAction}"
                                                           itemValue="#{groupedAction}"/>
                                        </p:selectManyCheckbox>

                                    </div>
                                </div>

                            </div>

                        </div>

                            <p:outputPanel id="activityPanel" styleClass="dashboard">
                                <p:panel
                                        rendered="#{(activityDashboardBean.getInteractionsChart()!=null)? true:false}"
                                        header="Activities">
                                    <f:facet name="actions">
                                        <p:button id="interactions"
                                                  styleClass="ui-panel-titlebar-icon ui-corner-all ui-state-default ui-icon"
                                                  icon="ui-icon-help" onclick="return false;"/>
                                        <p:tooltip for="interactions"
                                                   value="Number of selected activities (of all selected users) per day"/>
                                    </f:facet>
                                    <p:chart type="line"
                                             model="#{activityDashboardBean.interactionsChart}"
                                             style="height:300px;" responsive="true"/>
                                </p:panel>
                            </p:outputPanel>


                    </div>

                </div>
            </div>
        </div>
    </div>


</ui:define>

</ui:composition>