<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
    xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://java.sun.com/jsf/core">

<f:metadata>
	<f:viewParam name="studentviewId" value="#{studentview.sid}" />
</f:metadata>

<ui:composition template="./BasicTemplate.xhtml">
	<ui:define name="content">

	
		<div class="container body">
      <div class="main_container">
      	      <div id="loading">
				<h:graphicImage id="loading-image" name="images/ajaxloadingbar.gif" />
			</div>
      
        <div class="col-md-3 left_col">
          <div class="left_col scroll-view">
            <div class="navbar nav_title" style="border: 0;">
              <a href="index.html" class="site_title"> <span>LearnWeb Dashboard</span></a>
            </div>

            <div class="clearfix"></div>

            <!-- menu profile quick info -->
            <div class="profile clearfix">
              <div class="profile_pic">
                
                <!--  h:graphicImage name="images/foto_davide.jpg" styleClass="img-circle profile_img" / -->
              </div>
              <div class="profile_info">
                <span>Welcome,</span>
                <h2></h2>
              </div>
            </div>
            <!-- /menu profile quick info -->

            <br />

            

            <!-- /menu footer buttons -->
            <div class="sidebar-footer hidden-small">
              
            </div>
            <!-- /menu footer buttons -->
          </div>
        </div>

        <!-- top navigation -->
        <div class="top_nav">
          <div class="nav_menu">
            <nav>
              <div class="nav toggle">
                <a id="menu_toggle"><i class="fa fa-bars"></i></a>
              </div>

              <ul class="nav navbar-nav navbar-right">
                <li class="">
                 
                  
                </li>

                <li role="presentation" class="dropdown">
                  <a href="#" class="dropdown-toggle info-number">
                    <i class="fa"></i>
                  </a>
                  <ul id="menu1" class="dropdown-menu list-unstyled msg_list" role="menu">
                    <li>
                      <a>
                        <span class="image"><h:graphicImage name="images/img.jpg" /></span>
                        <span>
                          <span></span>
                          <span class="time"></span>
                        </span>
                        <span class="message">
                          
                        </span>
                      </a>
                    </li>
                    <li>
                      
                    </li>
                    <li>
                      
                    </li>
                    <li>
                      
                    </li>
                    <li>
                      
                    </li>
                  </ul>
                </li>
              </ul>
            </nav>
          </div>
        </div>
        <!-- /top navigation -->

        <!-- page content -->
        <div class="right_col" role="main">
          

          <div class="row">
            <div class="col-md-12 col-sm-12 col-xs-12">
              <div class="dashboard_graph">

                <div class="row x_title">
                  <div class="col-md-6">
                    <h3>Students' Activities <small>All student interactions</small></h3>
                  </div>
                  <div class="col-md-6">
                    
                  <div id="reportrange" class="pull-right" style="background: #fff; cursor: pointer; padding: 5px 10px; border: 1px solid #ccc">
                      <i class="glyphicon glyphicon-calendar fa fa-calendar"></i>
                      <span>March 2, 2017 - April 4, 2017</span> <b class="caret"></b>
                    
<script type="text/javascript" src="//cdn.jsdelivr.net/jquery/1/jquery.min.js"></script>
<script type="text/javascript" src="//cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script> 
<script type="text/javascript" src="//cdn.jsdelivr.net/bootstrap.daterangepicker/2/daterangepicker.js"></script>
<script type="text/javascript">
$(function() {
    $('#reportrange').daterangepicker(
    		 {"startDate": "03/02/2017",
    			 ranges: {
    		           'Today': [moment(), moment()],
    		           'Yesterday': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
    		           'Last 7 Days': [moment().subtract(6, 'days'), moment()],
    		           'Last 30 Days': [moment().subtract(29, 'days'), moment()],
    		           'This Month': [moment().startOf('month'), moment().endOf('month')],
    		           'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]
    		        
    		        }
    		    }
    	    );
});
$('#reportrange').on('apply.daterangepicker', function(ev, picker) {
	  $('#reportrange span').html(picker.startDate.format('MMMM D, YYYY') + ' - ' + picker.endDate.format('MMMM D, YYYY'));
	  updateCharts(picker.startDate.format('YYYY-MM-DD'),picker.endDate.format('YYYY-MM-DD'));
	});
</script>
	<h:form id="form1">

<script type="text/javascript">
		function updateCharts(data1,data2) {
		   document.getElementById("#{p:component('inputHiddenID1')}").value = data1;
		   document.getElementById("#{p:component('inputHiddenID2')}").value = data2;
		   remoteCommandName();
	    }
		function panelshow(){
			 document.getElementById("loading").style.visibility = "visible";
			 }
		 function panelhide(){
			 document.getElementById("loading").style.visibility = "hidden";
			 }
	</script>
	<h:inputHidden id="inputHiddenID1" value="#{studentview.startdate}"/>
	<h:inputHidden id="inputHiddenID2" value="#{studentview.enddate}"/>	 	
        <p:remoteCommand  name="remoteCommandName" onstart="panelshow()" oncomplete="panelhide()" actionListener="#{studentview.updateCharts}"  update="canvaspanel">      
        </p:remoteCommand>
    </h:form>    
                    </div>
                  
                  
                  </div>
                </div>

                
                <div class="col-md-9 col-sm-9 col-xs-12">
                  <div id="chart_plot_01_no" class="demo-placeholder-no_no" style="height: 0px"></div>
                  <canvas id="chart_plot_01_canvas" class="demo-placeholder-no_no" style="height: 700px"></canvas>
                  <h:panelGroup id="canvaspanel">

	<script>

	var ctx1 = document.getElementById("chart_plot_01_canvas");
                  	

                  	var chartInstance = new Chart(ctx1, {
                  		
                  	    type: 'line',
                  	  	data: {
                  	  	  
                    	  labels: <h:outputText value="#{studentview.graph01.label}" /> ,
                  	      datasets: [{
                  	    	label: 'interactions',
                  	        data: <h:outputText value="#{studentview.graph01.data}" />,
                  	        borderColor: "rgba(3, 88, 106, 0.38)",
                  	        backgroundColor: "rgba(38, 185, 154, 0.38)"
                  	      }]
                  	    },
                  	    options: {
                  	        scales: {
                  	            xAxes: [{
                  	                time: {
                  	                    unit: 'day'
                  	                }
                  	            }]
                  	        }
                  	    }
                  	})
                  	
                  
                  	</script>
                  </h:panelGroup>
                  	<script>

                  	var chart_plot_01_settings = {
                            series: {
                              lines: {
                                show: false,
                                fill: true
                              },
                              splines: {
                                show: true,
                                tension: 0.4,
                                lineWidth: 1,
                                fill: 0.4
                              },
                              points: {
                                radius: 0,
                                show: true
                              },
                              shadowSize: 2
                            },
                            grid: {
                              verticalLines: true,
                              hoverable: true,
                              clickable: true,
                              tickColor: "#d5d5d5",
                              borderWidth: 1,
                              color: '#fff'
                            },
                            colors: ["rgba(38, 185, 154, 0.38)", "rgba(3, 88, 106, 0.38)"],
                            xaxis: {
                              tickColor: "rgba(51, 51, 51, 0.06)",
                              mode: "time",
                              tickSize: [1, "day"],
                              //tickLength: 10,
                              axisLabel: "Date",
                              axisLabelUseCanvas: true,
                              axisLabelFontSizePixels: 12,
                              axisLabelFontFamily: 'Verdana, Arial',
                              axisLabelPadding: 10
                            },
                            yaxis: {
                              ticks: 8,
                              tickColor: "rgba(51, 51, 51, 0.06)",
                            },
                            tooltip: false
                          };
                  	
                  	// $.plot( $("#chart_plot_01_no"), [ arr_data1_test ],  chart_plot_01_settings );

                  
                  	</script>
                </div>
                
                
                <div class="col-md-3 col-sm-3 col-xs-12 bg-white">
                  <div class="x_title">
                    <h2>Students' Activity types</h2>
                    <div class="clearfix"></div>
                  </div>

                  <div class="col-md-12 col-sm-12 col-xs-6">
                  	<canvas id="myChart" width="400" height="400"></canvas>
                  	<script>
var ctx = document.getElementById("myChart");
<h:outputText value="#{studentview.topbar01data}" />
var myChart = new Chart(ctx, {
    type: 'bar',
    data: {
        labels: ["Glossary", "Search", "System (login/logout)", "Resource"],
        datasets: [{
            label: 'interactions',
            data: mydata,
            backgroundColor: [
                'rgba(75, 192, 192, 0.2)',
                'rgba(75, 192, 192, 0.2)',
                'rgba(75, 192, 192, 0.2)',
                'rgba(75, 192, 192, 0.2)'
            ],
            borderColor: [
                'rgba(75, 192, 192, 1)',
                'rgba(75, 192, 192, 1)',
                'rgba(75, 192, 192, 1)',
                'rgba(75, 192, 192, 1)'
            ],
            borderWidth: 1
        }]
    },
    options: {
        scales: {
            yAxes: [{
                ticks: {
                    beginAtZero:true
                }
            }]
        }
    }
});

$("#myChart").click( 
        function(evt){
            updateGloss();
        }
    );      

</script>

                  	
                                      </div>

                </div>

                <div class="clearfix"></div>
              </div>
            </div>

          </div>
          <br />
	<h:form id="form">
       <script type="text/javascript">
		function updateGloss() {
		   remoteCommandName2();
	    }
	</script>
	    <p:remoteCommand  name="remoteCommandName2" actionListener="#{studentview.updateGloss}"  update="glossarydata">      
        </p:remoteCommand>  
    </h:form>
<!-- top tiles -->
<h:panelGroup id="glossarydata" >
          <div class="row tile_count" >
            <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
            
              <span class="count_top"> Total Concepts</span>
              <div class="count"><h:outputText value="#{studentview.totalconcepts}" /></div>
              <!-- span class="count_bottom"><i class="green">4% </i> From last Week</span -->
              
            </div>
            <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
              <span class="count_top"> Total Terms</span>
              <div class="count"><h:outputText value="#{studentview.totalterms}" /></div>
              <!-- span class="count_bottom"><i class="green"><i class="fa fa-sort-asc"></i>3% </i> From last Week</span -->
            </div>
    
          </div>
          <!-- /top tiles -->
</h:panelGroup>
          <div class="row">


            <div class="col-md-4 col-sm-4 col-xs-12">
              <div class="x_panel tile" style="height: 420px">
                <div class="x_title">
                  <h2>Sources</h2>
                  <ul class="nav navbar-right panel_toolbox">
                    <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                    </li>
                    <li class="dropdown">
                      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-wrench"></i></a>
                      <ul class="dropdown-menu" role="menu">
                        <li><a href="#">Settings 1</a>
                        </li>
                        <li><a href="#">Settings 2</a>
                        </li>
                      </ul>
                    </li>
                    <li><a class="close-link"><i class="fa fa-close"></i></a>
                    </li>
                  </ul>
                  <div class="clearfix"></div>
                </div>
                <div class="x_content">
                <h:panelGroup id="canvas02panel">
                <div id="pieChart" style="margin-top: -60px; margin-left: -20px;"></div>
                <script>
                var pie = new d3pie("pieChart", {
            		
            		"footer": {
            			"color": "#999999",
            			"fontSize": 10,
            			"font": "open sans",
            			"location": "bottom-left"
            		},
            		"size": {
            			"canvasWidth": 400,
            			"pieOuterRadius": "70%"
            		},
            		"data": {
            			"sortOrder": "value-desc",
            			"content": [
                			<h:outputText value="#{studentview.graph02new.data}" />
                			]
            		},
            		"labels": {
            			"outer": {
            				"pieDistance": 32
            			},
            			"inner": {
            				"hideWhenLessThanPercentage": 3
            			},
            			"mainLabel": {
            				"fontSize": 11
            			},
            			"percentage": {
            				"color": "#ffffff",
            				"decimalPlaces": 0
            			},
            			"value": {
            				"color": "#adadad",
            				"fontSize": 11
            			},
            			"lines": {
            				"enabled": true
            			},
            			"truncation": {
            				"enabled": true
            			}
            		},
            		"effects": {
            			"pullOutSegmentOnClick": {
            				"effect": "linear",
            				"speed": 400,
            				"size": 8
            			}
            		},
            	});
				</script>
                </h:panelGroup>
                <div id="chart_plot_02"  style="height: 100"><canvas id="chart_plot_02_canvas" style="height: 60%; visibility: hidden" /></div>
                <div id="js-legend" class="chart-legend"></div>
                
                
                <script>
               		document.getElementById("chart_plot_02").innerHTML = '&nbsp;';
            		document.getElementById("chart_plot_02").innerHTML = '<canvas id="chart_plot_02_canvas" />';
                
                
                  	var ctx2 = document.getElementById("chart_plot_02_canvas");
                  	ctx2.height = 150;
                  	var chartInstance = new Chart(ctx2, {	
                  	    type: 'pie',
                  	  	data: {
                    	  labels: <h:outputText value="#{studentview.graph02.label}" /> ,
                  	      datasets: [{
                  	    	label: 'interactions',
                  	        data: <h:outputText value="#{studentview.graph02.data}" />,
                  	        borderColor: "#eff4fd",
                  	        backgroundColor: <h:outputText value="#{studentview.graph02color}" />
                  	      }]
                  	    },
                  	    options: {
                      	   legend: {
                  	       	display: false,
                  	       	position: 'bottom',
                  	       	labels: {
                  	          	 fontColor: 'rgb(3, 88, 106)'
                  	       	}
                      	   },
                      	 tooltips: {
                             callbacks: {
                                 label: function(tooltipItem, data) {
                                     var allData = data.datasets[tooltipItem.datasetIndex].data;
                                     var tooltipLabel = data.labels[tooltipItem.index];
                                     var tooltipData = allData[tooltipItem.index];
                                     var total = 0;
                                     for (var i in allData) {
                                         total += allData[i];
                                     }
                                     var tooltipPercentage = Math.round((tooltipData / total) * 100);
                                     return tooltipLabel + ': ' + tooltipData + ' (' + tooltipPercentage + '%)';
                                 }
                             }
                      	 },
                  	  }
                  	})
                  	document.getElementById('js-legend').innerHTML = chartInstance.generateLegend();
                  	</script>
                  	
                </div>
              </div>
            </div>
            <div class="col-md-8 col-sm-8 col-xs-12">
              <div class="x_panel tile " style="height: 420px">
                <div class="x_title">
                  <h2>Student Proxy sources</h2>
                  <ul class="nav navbar-right panel_toolbox">
                    <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                    </li>
                    <li class="dropdown">
                      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-wrench"></i></a>
                      <ul class="dropdown-menu" role="menu">
                        <li><a href="#">Order By #Concepts</a>
                        </li>
                        <li><a href="#">Order By #Terms</a>
                        </li>
                      </ul>
                    </li>
                    <li><a class="close-link"><i class="fa fa-close"></i></a>
                    </li>
                  </ul>
                  <div class="clearfix"></div>
                </div>
                <div class="x_content">
                <div id="chart_plot_03"><canvas id="chart_plot_03_canvas" /></div>
                <h:panelGroup id="canvas03panel">
                  <script>
                  document.getElementById("chart_plot_03").innerHTML = '&nbsp;';
      			  document.getElementById("chart_plot_03").innerHTML = '<canvas id="chart_plot_03_canvas" />';
                  
                  var ctx3 = document.getElementById("chart_plot_03_canvas");
                  // ctx3.height = 140;
                  var myChart3 = new Chart(ctx3, {
                    type: 'bar',
                    data: {
                      labels: <h:outputText value="#{studentview.proxylog.label}" />,
                      datasets: [{
                        label: '',
                        data: <h:outputText value="#{studentview.proxylog.data}" />,
                        backgroundColor: "rgb(102,205,170)"
                      }]
                    }
                  });
                  </script>
				</h:panelGroup>
                </div>
              </div>
            </div>


            

          </div>


          <div class="row">
			<div class="col-md-8 col-sm-8 col-xs-12">
            	<div class="x_panel tile fixed_height_390" style="overflow: scroll;">
                	<div class="x_title">
                  		<h2>Student Proxy sources list</h2>
                  		<ul class="nav navbar-right panel_toolbox">
                    		<li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a></li>
                    	</ul>
                  		<div class="clearfix"></div>
                	</div>
                	<div class="x_content">
                	<h:panelGroup id="proxypanel">
                		<h:dataTable value = "#{studentview.proxyloglist}" var = "entry" styleClass = "countries_list">
					   		<h:column>    				
					      		<f:facet name = "header">Web Site</f:facet>    				
					      		<a href="#{entry.key}" target="_blank">#{entry.key}</a>
					   		</h:column>
					   		<h:column>
					      		<f:facet name = "header">Occurrences</f:facet>
					      		#{entry.value}
					   		</h:column>
						</h:dataTable>
						</h:panelGroup>
                	</div>
             	</div>
			</div>
		</div>
        </div>
        <!-- /page content -->

        <!-- footer content -->
        <footer>
          <div class="pull-right">
            	Davide Taibi <a href="http://www.itd.cnr.it">CNR-ITD</a>
          </div>
          <div class="clearfix"></div>
        </footer>
        <!-- /footer content -->
      </div>
    </div>
		
		
	</ui:define>
</ui:composition>
</html>