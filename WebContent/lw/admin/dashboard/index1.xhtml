<ui:composition template="/templates/main/main.xhtml" xmlns:ui="http://java.sun.com/jsf/facelets"
				xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
				xmlns:p="http://primefaces.org/ui">

	<ui:param name="pageTitle" value="Dashboard"/>
	<ui:param name="loginRequired" value="true"/>

	<style>
		ul {
			list-style: none;
		}
	</style>

	<ui:define name="center_layout">
		<div class="ui-g" style="margin: 5px;">
			<div class="ui-g-12 ui-md-2">
				<div id="sidebar-menu" class="main_menu_side hidden-print main_menu">
					<div class="center-header" id="group_header" style="margin-right: 0">
						<h2>Student List</h2>
					</div>

					<div class="menu_section" style="height: calc(100vh - 102px); overflow-y: auto; width: 100%;">
						<p:dataList value="#{dashboard.selectedCourse.members}" var="user" type="ordered">
							<a target="_blank" href="admin/dashboard/studentlog.jsf?studentlogId=#{user.id}">
								<h:outputText value="#{user.username}"/>
							</a>
						</p:dataList>
					</div>
				</div>
			</div>
			<div class="ui-g-12 ui-md-10 ui-g-nopad">
				<div class="ui-g-12 ui-g-nopad">
					<div class="center-header" id="group_header">
						<h2>Students' Activities</h2>
						<span class="header_detail">All student interactions</span>
					</div>

					<h:panelGroup id="dashboardMain" styleClass="dashboard" layout="block">
						<div class="ui-g">
							<div class="ui-g-3">
								<p:panel header="Total Concepts">
									<div class="count">
										<h:outputText value="#{dashboard.totalconcepts}"/>
									</div>
								</p:panel>
							</div>
							<div class="ui-g-3">
								<p:panel header="Total Terms">
									<div class="count">
										<h:outputText value="#{dashboard.totalterms}"/>
									</div>
								</p:panel>
							</div>
							<div class="ui-g-6">
								<h:form id="dateForm">
									<div class="ui-g ui-fluid">
										<div class="ui-g-12 ui-md-4">
											<div class="ui-inputgroup">
												<p:outputLabel for="dateStart"/>
												<p:calendar id="dateStart" value="#{dashboard.startDate}"
															showOn="button"/>
											</div>
										</div>

										<div class="ui-g-12 ui-md-4">
											<div class="ui-inputgroup">
												<p:outputLabel for="dateEnd"/>
												<p:calendar id="dateEnd" value="#{dashboard.endDate}" showOn="button"/>
											</div>
										</div>

										<div class="ui-g-12 ui-md-4">
											<div class="ui-inputgroup">
												<p:commandButton value="Update" update=":dashboardMain :growl"
																 actionListener="#{dashboard.onDateChanged}"
																 icon="ui-icon-check"/>
											</div>
										</div>
									</div>
								</h:form>
							</div>
						</div>

						<div class="ui-g">
							<div class="ui-g-9">
								<p:panel id="chart_plot_01" header="Interactions" style="margin-bottom:20px">
									<p:chart type="line" model="#{dashboard.interactionsChart}" style="height:300px;"/>
								</p:panel>
							</div>
							<div class="ui-g-3">
								<p:panel id="chart_barModel" header="Students' Activity types"
										 style="margin-bottom:20px">
									<p:chart type="bar" model="#{dashboard.studentsActivityTypes}" xaxisAngle="60"
											 style="height:300px"/>
								</p:panel>
							</div>
						</div>
						<div class="ui-g">
							<div class="ui-g-4">
								<h:form>
									<p:panel id="toggleable" header="Students' Source" toggleable="true" closable="true"
											 toggleSpeed="500" closeSpeed="500" widgetVar="panel"
											 style="margin-bottom:20px">

										<p:chart type="pie" model="#{dashboard.studentsSources}"/>

										<f:facet name="options">
											<p:menu>
												<p:submenu label="Settings">
													<p:menuitem value="Toggle" url="#" icon="ui-icon-newwin"
																onclick="PF('panel').toggle()"/>
													<p:menuitem value="Remove" url="#" icon="ui-icon-close"
																onclick="PF('panel').close()"/>
												</p:submenu>
											</p:menu>
										</f:facet>
									</p:panel>
								</h:form>
							</div>
							<div class="ui-g-8">
								<h:form>
									<p:panel id="glossary" header="Students' Glossary" toggleable="true" closable="true"
											 toggleSpeed="500" closeSpeed="500" widgetVar="panel"
											 style="margin-bottom:20px">

										<p:chart type="bar" model="#{dashboard.studentsGlossary}" style="height:300px"/>

										<f:facet name="options">
											<p:menu>
												<p:submenu label="Settings">
													<p:menuitem value="Toggle" url="#" icon="ui-icon-newwin"
																onclick="PF('panel').toggle()"/>
													<p:menuitem value="Remove" url="#" icon="ui-icon-close"
																onclick="PF('panel').close()"/>
												</p:submenu>
											</p:menu>
										</f:facet>
									</p:panel>
								</h:form>
							</div>
						</div>
						<div class="ui-g">
							<div class="ui-g-12">
								<h:form>
									<p:panel id="fields" header="Fields" style="margin-bottom:20px">
										<h:panelGrid columns="1">
											<p:dataTable var="entry" value="#{dashboard.fields}"
														 styleClass="countries_list">
												<p:column headerText="Id">
													<h:outputText value="#{entry.userid}"/>
												</p:column>

												<p:column headerText="terms">
													<h:outputText value="#{entry.total}"/>
												</p:column>

												<p:column headerText="pronunciation">
													<h:outputText value="#{entry.pronounciation/entry.total*100}">
														<f:convertNumber pattern="#0.00"/>
													</h:outputText>%
												</p:column>

												<p:column headerText="acronym">
													<h:outputText value="#{entry.acronym/entry.total*100}">
														<f:convertNumber pattern="#0.00"/>
													</h:outputText>%
												</p:column>

												<p:column headerText="phraseology">
													<h:outputText value="#{entry.phraseology/entry.total*100}">
														<f:convertNumber pattern="#0.00"/>
													</h:outputText>%
												</p:column>

												<p:column headerText="uses">
													<h:outputText value="#{entry.uses/entry.total*100}">
														<f:convertNumber pattern="#0.00"/>
													</h:outputText>%
												</p:column>

												<p:column headerText="source">
													<h:outputText value="#{entry.source/entry.total*100}">
														<f:convertNumber pattern="#0.00"/>
													</h:outputText>%
												</p:column>

												<p:column headerText="AVG %">
													<h:outputText value="#{entry.avg*100}">
														<f:convertNumber pattern="#0.00"/>
													</h:outputText>%
												</p:column>
											</p:dataTable>
										</h:panelGrid>
									</p:panel>
								</h:form>
							</div>
						</div>
						<div class="ui-g">
							<div class="ui-g-6">
								<h:form>
									<p:panel id="summary" header="Summary" style="margin-bottom:20px">
										<h:panelGrid columns="1">
											<p:dataTable var="entry" value="#{dashboard.summary}"
														 styleClass="countries_list">
												<p:column headerText="Id">
													<h:outputText value="#{entry.userid}"/>
												</p:column>

												<p:column headerText="sources">
													<h:outputText value="#{entry.sources}"/>
												</p:column>

												<p:column headerText="terms">
													<h:outputText value="#{entry.terms}"/>
												</p:column>

												<p:column headerText="entries">
													<h:outputText value="#{entry.concepts}">
													</h:outputText>%
												</p:column>
											</p:dataTable>
										</h:panelGrid>
									</p:panel>
								</h:form>
							</div>
							<div class="ui-g-6">
								<h:form>
									<p:panel id="description" header="Description field" style="margin-bottom:20px">
										<h:panelGrid columns="1">
											<p:dataTable var="entry" value="#{dashboard.desclist}"
														 styleClass="countries_list">
												<p:column headerText="Id">
													<h:outputText value="#{entry.userid}"/>
												</p:column>

												<p:column headerText="entry id">
													<h:outputText value="#{entry.enrtyid}"/>
												</p:column>

												<p:column headerText="lang">
													<h:outputText value="#{entry.lang}"/>
												</p:column>

												<p:column headerText="description">
													<h:outputText value="#{entry.description}"/>
												</p:column>

												<p:column headerText="lenght">
													<h:outputText value="#{entry.lenght}"/>
												</p:column>
											</p:dataTable>
										</h:panelGrid>
									</p:panel>
								</h:form>
							</div>
						</div>
					</h:panelGroup>
				</div>
			</div>


			<footer>
				<div class="pull-right">
					Davide Taibi
					<a href="http://www.itd.cnr.it">CNR-ITD</a>
				</div>
				<div class="clearfix"></div>
			</footer>
		</div>
	</ui:define>
</ui:composition>
