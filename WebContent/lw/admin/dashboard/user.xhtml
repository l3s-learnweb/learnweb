<ui:composition template="/WEB-INF/templates/layout/template.xhtml"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:p="http://primefaces.org/ui">

<ui:define name="metadata">
    <f:metadata>
        <f:viewParam name="userId" value="#{glossaryDashboardUsersBean.paramUserId}"/>
        <f:viewAction action="#{glossaryDashboardUsersBean.onLoad}"/>
    </f:metadata>
</ui:define>

<ui:param name="loginRequired" value="true"/>
<ui:param name="pageTitle" value="Dashboard"/>

<ui:define name="sub_breadcrumb">
    <p:menuitem value="Dashboard" url="admin/dashboard/user.jsf#"/>
</ui:define>
<ui:define name="center_layout">

    <!--<div class="col-md-2">
        <div id="sidebar-menu" class="main_menu_side hidden-print main_menu">

            <div class="menu_section" style="height: 350px; width: 100%;">
                <h:form id="form">
                    <p:panel header="Navigation">
                        <a href="admin/dashboard/index.jsf"><i class="fa fa-chevron-left"></i> To all users</a>
                    </p:panel>
                </h:form>
            </div>
        </div>
    </div>-->
    <h:form id="dateForm">
        <div class="row">
            <div class="col-12 col-sm-6 col-md-5 col-xl-3">
                <p:panel>
                    <div class="ui-inputgroup pb-3">
                        <p:outputLabel for="dateStart"/>
                        <p:calendar id="dateStart" value="#{glossaryDashboardUsersBean.startDate}"
                                    showOn="button"/>
                    </div>
                    <div class="ui-inputgroup pb-3">
                        <p:outputLabel for="dateEnd"/>
                        <p:calendar id="dateEnd" value="#{glossaryDashboardUsersBean.endDate}" showOn="button"/>
                    </div>
                    <div class="ui-inputgroup">
                        <p:commandButton value="Update" update=":dashboardMain :growl"
                                         actionListener="#{glossaryDashboardUsersBean.cleanAndUpdateStoredData}"
                                         icon="ui-icon-check" styleClass="command-button" />
                    </div>
                </p:panel>

            </div>
        </div>
    </h:form>
    <h:panelGroup id="dashboardMain" styleClass="col-12 mt-3" layout="block">
        <div class="row">
            <p:panel styleClass="col-12 col-sm-6 col-xl-3 mt-3 mt-sm-0" header="Total Concepts">
                <f:facet name="actions">
                    <p:button id="totalConcepts" styleClass="ui-panel-titlebar-icon ui-corner-all ui-state-default ui-icon"
                              icon="ui-icon-help" onclick="return false;"/>
                    <p:tooltip for="totalConcepts" value="Concept - a general notion"/>
                </f:facet>
                <div class="count">
                    <h:outputText value="#{glossaryDashboardUsersBean.totalConcepts}"/>
                </div>
            </p:panel>
            <p:panel styleClass="col-12 col-sm-6 col-xl-3 mt-3 mt-sm-0" header="Total Terms">
                <f:facet name="actions">
                    <p:button id="totalTerms" styleClass="ui-panel-titlebar-icon ui-corner-all ui-state-default ui-icon" icon="ui-icon-help"
                              onclick="return false;"/>
                    <p:tooltip for="totalTerms" value="Term - a word/phrase, that is used to describe a concept"/>
                </f:facet>
                <div class="count">
                    <h:outputText value="#{glossaryDashboardUsersBean.totalTerms}"/>
                </div>
            </p:panel>
            <p:panel styleClass="col-12 col-sm-6 col-xl-3 mt-3 mt-xl-0" header="Total Sources">
                <f:facet name="actions">
                    <p:button id="totalSources" styleClass="ui-panel-titlebar-icon ui-corner-all ui-state-default ui-icon" icon="ui-icon-help"
                              onclick="return false;"/>
                    <p:tooltip for="totalSources" value="??"/>
                </f:facet>
                <div class="count">
                    <h:outputText value="#{glossaryDashboardUsersBean.totalSources}"/>
                </div>
            </p:panel>

            <p:panel styleClass="col-12 col-sm-6 col-xl-3 mt-3 mt-xl-0" header="Ratio terms/concept">
                <div class="count">
                    <h:outputText value="#{glossaryDashboardUsersBean.ratioTermConcept}"/>
                </div>
            </p:panel>
        </div>




    </h:panelGroup>

    <div class="row mt-3">
        <div class="col-12 col-xl-8">
            <p:panel id="chart_plot_Interactions" header="Interactions">
                <f:facet name="actions">
                    <p:button id="interactions" styleClass="ui-panel-titlebar-icon ui-corner-all ui-state-default ui-icon"
                              icon="ui-icon-help" onclick="return false;"/>
                    <p:tooltip for="interactions" value="Total number of interactions (of all selected users) per day"/>
                </f:facet>
                <p:chart type="line" model="#{glossaryDashboardUsersBean.interactionsChart}" style="height:300px;" responsive="true"/>
            </p:panel>
        </div>
        <div class="col-12 col-xl-4 mt-3 mt-xl-0">
            <p:panel id="chart_bar_userActivity" header="Users' Activity types">
                <f:facet name="actions">
                    <p:button id="userActivityTypes" styleClass="ui-panel-titlebar-icon ui-corner-all ui-state-default ui-icon"
                              icon="ui-icon-help" onclick="return false;"/>
                    <p:tooltip for="userActivityTypes" value="Total number of interactions grouped by categories"/>
                </f:facet>
                <p:chart type="bar" model="#{glossaryDashboardUsersBean.usersActivityTypesChart}" xaxisAngle="60"
                         style="height:300px" responsive="true"/>
            </p:panel>
        </div>
    </div>

    <!--
        <div class="row">
            <div class="col-md-4">
                <h:form>
                    <p:panel id="chart_plot_userFields" header="Fields" style="margin-bottom:20px">
                        <f:facet name="actions">
                            <p:button id="fieldsChart" styleClass="ui-panel-titlebar-icon ui-corner-all ui-state-default ui-icon" icon="ui-icon-help" onclick="return false;" />
                            <p:tooltip for="fieldsChart" value="??" />
                        </f:facet>
                        <p:chart type="bar" model="#{glossaryDashboardUsersBean.userFieldsChart}" xaxisAngle="60"
                                 style="height:300px" responsive="true"/>
                    </p:panel>
                </h:form>
            </div>
            <div class="col-md-8">
                <p:panel id="table_descriptions"
                         header="Descriptions of entries from class-mates" stickyHeader="true"
                         style="height:361px; overflow-y: scroll;">
                    <p:dataTable value="#{glossaryDashboardUsersBean.usersGlossaryDescriptions}" var="descr"
                                 styleClass="countries_list">
                        <p:column headerText="Description">
                            <h:outputText value="#{descr}"/>
                        </p:column>
                        <p:column headerText="Length">
                            <h:outputText value="#{descr.length()}"/>
                        </p:column>
                    </p:dataTable>
                </p:panel>
            </div>
        </div>

-->
    <h:form styleClass="mt-3">
        <p:panel header="Users' Activity types">
            <f:facet name="Glossaries">
                <p:button id="glossariesTable" styleClass="ui-panel-titlebar-icon ui-corner-all ui-state-default ui-icon"
                          icon="ui-icon-help"
                          onclick="return false;"/>
                <p:tooltip for="glossariesTable" value="All glossary resources that this user has created"/>
            </f:facet>
            <p:dataTable var="glossary" styleClass="table-responsive" value="#{glossaryDashboardUsersBean.glossaryResources}">
                <p:column styleClass="ui-column-title" headerText="#{msg.title}" sortBy="#{glossary.title}">
                    <h:outputLink value="#{glossary.url}">
                        <h:outputText value="#{glossary.title}"/>
                    </h:outputLink>
                </p:column>

                <p:column styleClass="ui-column-title" headerText="#{msg.location}">
                    <h:outputText value="#{msg.myPrivateResources}" rendered="#{glossary.group eq null}"/>

                    <h:outputLink value="group/resources.jsf" rendered="#{glossary.group ne null}">
                        <f:param name="group_id" value="#{glossary.group.id}"/>
                        <f:param name="folder_id" value="#{glossary.folder.id}"/>
                        <f:param name="resource_id" value="#{glossary.id}"/>
                        <h:outputText value="#{glossary.group.title}"/>
                    </h:outputLink>
                </p:column>
            </p:dataTable>
        </p:panel>
    </h:form>

    <div class="row mt-3">
        <div class="col-12 col-xl-6">
            <p:panel id="pie_chart_sources" header="Sources">
                <f:facet name="actions">
                    <p:button id="sourcesChart" styleClass="ui-panel-titlebar-icon ui-corner-all ui-state-default ui-icon"
                              icon="ui-icon-help" onclick="return false;"/>
                    <p:tooltip for="sourcesChart" value="Percentage ratio of visited pages (grouped by categories) by users"/>
                </f:facet>
                <p:chart type="pie" model="#{glossaryDashboardUsersBean.usersSourcesChart}" responsive="true"/>
            </p:panel>
        </div>
        <div class="col-12 col-sm-8 col-xl-4 mt-3 mt-xl-0">
            <p:panel id="table_sources_list" header="User Proxy sources list" widgetVar="panel"
                     stickyHeader="true">
                <f:facet name="actions">
                    <p:button id="sourcesListTable" styleClass="ui-panel-titlebar-icon ui-corner-all ui-state-default ui-icon"
                              icon="ui-icon-help" onclick="return false;"/>
                    <p:tooltip for="sourcesListTable" value="The ratio between how many times user visited the web page"/>
                </f:facet>
                <h:form>
                    <p:dataTable var="pll" value="#{glossaryDashboardUsersBean.usersProxySourcesList}" styleClass="countries_list">
                        <p:column headerText="Web Site">
                            <h:outputText value="#{pll.key}"/>
                        </p:column>

                        <p:column headerText="Occurrences">
                            <h:outputText value="#{pll.value}"/>
                        </p:column>
                    </p:dataTable>
                </h:form>
            </p:panel>
        </div>
        <div class="col-12 col-sm-4 col-xl-2 mt-3 mt-xl-0" >
            <div class="">
                <p:panel header="Total events">
                    <f:facet name="actions">
                        <p:button id="eventsNumber" styleClass="ui-panel-titlebar-icon ui-corner-all ui-state-default ui-icon"
                                  icon="ui-icon-help" onclick="return false;"/>
                        <p:tooltip for="eventsNumber" value="Events like mouse movements, clicks, etc."/>
                    </f:facet>
                    <div class="count">
                        <h:outputText value="#{glossaryDashboardUsersBean.singleTrackerStatistics.totalEvents}"/>
                    </div>
                </p:panel>
            </div>
            <div class="mt-3">
                <p:panel header="Time stay">
                    <f:facet name="actions">
                        <p:button id="timeStay" styleClass="ui-panel-titlebar-icon ui-corner-all ui-state-default ui-icon"
                                  icon="ui-icon-help" onclick="return false;"/>
                        <p:tooltip for="timeStay" value="Total time when web pages were opened by the user"/>
                    </f:facet>
                    <div class="count">
                        <h:outputText value="#{glossaryDashboardUsersBean.singleTrackerStatistics.timeStayFormatted}"/>
                    </div>
                </p:panel>
            </div>
            <div class="mt-3">
                <p:panel header="Time active">
                    <f:facet name="actions">
                        <p:button id="timeActive" styleClass="ui-panel-titlebar-icon ui-corner-all ui-state-default ui-icon"
                                  icon="ui-icon-help" onclick="return false;"/>
                        <p:tooltip for="timeActive" value="Active time on web pages"/>
                    </f:facet>
                    <div class="count">
                        <h:outputText value="#{glossaryDashboardUsersBean.singleTrackerStatistics.timeActiveFormatted}"/>
                    </div>
                </p:panel>
            </div>
            <div class="mt-3">
                <p:panel header="Clicks">
                    <f:facet name="actions">
                        <p:button id="clicks" styleClass="ui-panel-titlebar-icon ui-corner-all ui-state-default ui-icon"
                                  icon="ui-icon-help" onclick="return false;"/>
                        <p:tooltip for="clicks" value="Mouse clicks"/>
                    </f:facet>
                    <div class="count">
                        <h:outputText value="#{glossaryDashboardUsersBean.singleTrackerStatistics.clicks}"/>
                    </div>
                </p:panel>
            </div>
            <div class="mt-3">
                <p:panel header="Key presses">
                    <f:facet name="actions">
                        <p:button id="keyPresses" styleClass="ui-panel-titlebar-icon ui-corner-all ui-state-default ui-icon"
                                  icon="ui-icon-help" onclick="return false;"/>
                        <p:tooltip for="keyPresses" value="Total number of key presses on the keyboard"/>
                    </f:facet>
                    <div class="count">
                        <h:outputText value="#{glossaryDashboardUsersBean.singleTrackerStatistics.keyPresses}"/>
                    </div>
                </p:panel>
            </div>
        </div>
    </div>
</ui:define>
</ui:composition>
