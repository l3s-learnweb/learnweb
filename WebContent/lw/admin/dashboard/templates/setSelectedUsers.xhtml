<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:p="http://primefaces.org/ui">

<!--@elvariable id="cbean" type="de.l3s.learnweb.dashboard.CommonDashboardUserBean"-->

<h:form>
    <p:outputPanel styleClass="row align-items-end my-2" rendered="#{!cbean.singleUser}">
        <div class="col">
            <p:selectOneRadio layout="grid" columns="1" required="true" styleClass="no-borders" value="#{cbean.selectedType}">
                <p:ajax event="valueChange" update="usersSelectorPanel usersCountPanel"/>

                <f:selectItem itemLabel="#{msg.users}" itemValue="1"/>
                <f:selectItem itemLabel="#{msg.groupsTitle}" itemValue="2"/>
            </p:selectOneRadio>
        </div>
        <p:outputPanel id="usersSelectorPanel" styleClass="col">
            <p:selectCheckboxMenu id="selectedUsersIds" value="#{cbean.selectedUsersIds}" var="user" label="#{msg.users}"
                                  filter="true" filterMatchMode="startsWith" rendered="#{cbean.selectedType == 1}" styleClass="no-borders">
                <p:ajax event="change" update="dateAndSubmitPanel usersCountPanel"/>
                <p:ajax event="toggleSelect" update="dateAndSubmitPanel usersCountPanel"/>

                <f:selectItems value="#{cbean.allUsers}" var="user" itemValue="#{user.id}" itemLabel="#{user.username}"/>
            </p:selectCheckboxMenu>

            <p:selectCheckboxMenu id="selectedGroupsIds" value="#{cbean.selectedGroupsIds}" var="group" label="#{msg.groupsTitle}"
                                  filter="true" filterMatchMode="startsWith" rendered="#{cbean.selectedType == 2}" styleClass="no-borders">
                <p:ajax event="change" update="dateAndSubmitPanel usersCountPanel"/>
                <p:ajax event="toggleSelect" update="dateAndSubmitPanel usersCountPanel"/>

                <f:selectItems value="#{cbean.allGroups}" var="group" itemValue="#{group.id}" itemLabel="#{group.title}"/>
            </p:selectCheckboxMenu>
        </p:outputPanel>
        <p:outputPanel id="usersCountPanel" styleClass="col">
            <p><h:outputText value="Users selected: #{cbean.selectedUsersIds.size()}" rendered="#{not empty cbean.selectedUsersIds}"/></p>
        </p:outputPanel>
    </p:outputPanel>

    <p:outputPanel id="dateAndSubmitPanel" styleClass="row align-items-end my-2">
        <div class="col">
            <p:outputLabel for="dateStart" value="#{msg.start_date}" styleClass="mr-2"/>
            <p:calendar id="dateStart" var="date" value="#{cbean.startDate}" showOn="button"/>
        </div>
        <div class="col">
            <p:outputLabel for="dateEnd" value="#{msg.end_date}" styleClass="mr-2"/>
            <p:calendar id="dateEnd" var="date" value="#{cbean.endDate}" showOn="button"/>
        </div>
        <div class="col">
            <p:commandButton value="Update" icon="ui-icon-check" update=":content" action="#{cbean.cleanAndUpdateStoredData}"
                             disabled="#{empty cbean.selectedUsersIds}">
            </p:commandButton>
        </div>
    </p:outputPanel>
</h:form>
</ui:composition>