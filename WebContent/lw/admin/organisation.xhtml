<ui:composition
        template="/WEB-INF/templates/layout/template.xhtml"
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
        xmlns:h="http://xmlns.jcp.org/jsf/html"
        xmlns:f="http://xmlns.jcp.org/jsf/core"
        xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
        xmlns:p="http://primefaces.org/ui">

    <ui:param name="loginRequired" value="true" />
    <ui:param name="pageTitle" value="#{adminOrganisationBean.selectedOrganisation.title} - #{msg.organization}" />
    <ui:param name="disableGrowl" value="true" />

	<ui:define name="metadata">
	    <f:metadata>
	        <f:viewParam name="organisation_id" value="#{adminOrganisationBean.organisationId}" required="false" requiredMessage="Missing organisation parameter" />
	        <f:viewAction action="#{adminOrganisationBean.onLoad}" />
	    </f:metadata>
	</ui:define>

	<ui:define name="sub_breadcrumb">
		<p:menuitem value="#{msg.organizations}" url="admin/organisations.jsf" />
		<p:menuitem value="#{adminOrganisationBean.selectedOrganisation.title}" url="#" />
	</ui:define>

    <ui:define name="center_layout">
        <ui:fragment rendered="#{null ne adminOrganisationBean.selectedOrganisation}">
            <h:form id="editwelcomeform" >

                    <p:panel header="#{msg.welcome_message}" styleClass="no-padding-panel-content">
                            <p:textEditor height="184" value="#{adminOrganisationBean.selectedOrganisation.welcomeMessage}" />
                    </p:panel>

                                <p:panel header="Common settings">


                                            <h:outputText styleClass="font-weight-bold" value="#{msg.title}:" />


                                        <p:inputText styleClass="w-100 mb-2" value="#{adminOrganisationBean.selectedOrganisation.title}" />


                                            <h:outputText styleClass="font-weight-bold" value="Banner image:" />

                                        <p:fileUpload fileUploadListener="#{adminOrganisationBean.handleFileUpload}" id="imageupload" mode="advanced" update="bannerimage" auto="true" sizeLimit="1000000"
                                                      allowTypes="/(\.|\/)(gif|jpe?g|png)$/"  />
                                        <h:panelGroup id="bannerimage">
                                            <img src="#{adminOrganisationBean.selectedOrganisation.bannerImage}" />
                                        </h:panelGroup>


                                            <h:outputText styleClass="font-weight-bold" value="Welcome Page: " />

                                        <p:selectOneMenu styleClass="w-100 mb-2" id="welcomePage" value="#{adminOrganisationBean.selectedOrganisation.welcomePage}" editable="true">
                                            <f:selectItem itemValue="/lw/myhome/activity.jsf" itemLabel="/lw/myhome/activity.jsf" />
                                            <f:selectItem itemValue="/lw/myhome/welcome.jsf" itemLabel="/lw/myhome/welcome.jsf" />
                                        </p:selectOneMenu>


                                            <h:outputText styleClass="font-weight-bold" value="Logout Page: " />

                                        <p:selectOneMenu styleClass="w-100 mb-2" value="#{adminOrganisationBean.selectedOrganisation.logoutPage}" editable="true">
                                            <f:selectItem itemValue="/lw/index.jsf" itemLabel="Learnweb index page" />
                                            <f:selectItem itemValue="/ama/index.jsf" itemLabel="AMA index page" />
                                            <f:selectItem itemValue="/aw/index.jsf" itemLabel="Archive index page" />
                                        </p:selectOneMenu>


                                            <h:outputText styleClass="font-weight-bold" value="Default language: " />

                                        <p:selectOneMenu styleClass="w-100 mb-2" value="#{adminOrganisationBean.selectedOrganisation.defaultLanguage}">
                                            <f:selectItem itemLabel="No default" itemValue="#{null}" />
                                            <f:selectItems value="#{adminOrganisationBean.supportedLanguages}" var="lang"
                                            	itemLabel="${msg['language_' += lang]}" itemValue="#{lang}"></f:selectItems>
                                        </p:selectOneMenu>


                                            <h:outputText styleClass="font-weight-bold" value="Language variant: " />

                                        <p:selectOneMenu styleClass="w-100 mb-2" value="#{adminOrganisationBean.selectedOrganisation.languageVariant}">
                                            <f:selectItem itemValue="" itemLabel="No variant" />
                                            <f:selectItems value="#{adminOrganisationBean.supportedLanguageVariants}" var="variant"
                                            	itemLabel="#{variant}" itemValue="#{variant}"></f:selectItems>
                                        </p:selectOneMenu>


                                            <h:outputText value="Glossary languages: " styleClass="font-weight-bold" />

                                        <p:selectCheckboxMenu styleClass="w-100 mb-2" value="#{adminOrganisationBean.selectedOrganisation.glossaryLanguages}" required="true" requiredMessage="#{msg.mandatory_field}"
                                                              label="#{msg.language}" multiple="true" converter="#{localeConverter}">
                                            <f:selectItems value="#{adminOrganisationBean.availableGlossaryLanguages}"></f:selectItems>
                                        </p:selectCheckboxMenu>

                                </p:panel>


                            <p:panel header="Additional settings">

                                    <p:accordionPanel autoHeight="false" id="courseoptions">
                                        <c:forEach items="#{adminOrganisationBean.optionGroups}" var="group" varStatus="status">

                                            <p:tab title="${adminOrganisationBean.optionGroups[status.index].title}">
                                                <h:dataTable value="${adminOrganisationBean.optionGroups[status.index].options}" var="option">
                                                    <h:column>
                                                        <h:selectBooleanCheckbox value="#{option.value}" id="checkbox" />
                                                    </h:column>
                                                    <h:column>
                                                        <h:outputLabel value="#{option.name}" for="checkbox" />
                                                    </h:column>
                                                </h:dataTable>
                                            </p:tab>

                                        </c:forEach>
                                    </p:accordionPanel>

                            </p:panel>





                                <p:commandButton styleClass="mt-3" action="#{adminOrganisationBean.onSave}" value="#{msg.save}" ajax="false" />
                                <p:button rendered="#{userBean.admin}" outcome="organisations" value="Back to Organisations" />





            </h:form>
        </ui:fragment>
    </ui:define>
</ui:composition>