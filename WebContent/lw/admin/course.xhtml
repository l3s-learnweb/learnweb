<ui:composition
		template="/WEB-INF/templates/layout/template.xhtml"
	xmlns="http://www.w3.org/1999/xhtml" 
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui">

	<ui:define name="metadata">
		<f:metadata>
			<f:viewParam name="course_id" value="#{adminCourseBean.courseId}" />
		</f:metadata>
	</ui:define>
	
	<ui:param name="loginRequired" value="true"/>
	<ui:param name="pageTitle" value="#{adminCourseBean.course.title}" />

	<ui:define name="sub_breadcrumb">
		<p:menuitem value="#{msg.courses}" url="admin/courses.jsf" />
		<p:menuitem value="#{adminCourseBean.course.title}" url="admin/course.jsf?course_id=#{adminCourseBean.course.id}" />
	</ui:define>
		
	<ui:define name="center_layout">

		<h:form id="editwelcomeform"  prependId="false" styleClass="form">
			<div class="row">

				<div class="col-12">
					<p:panel header="#{msg.welcome_message}">
						<!-- a dirty fix. we should check old message and remove tables -->
						<p:textEditor height="284" value="#{adminCourseBean.course.welcomeMessage}" rendered="${!adminCourseBean.course.welcomeMessage.contains('table')}" />

						<p:editor height="284" value="#{adminCourseBean.course.welcomeMessage}" rendered="${adminCourseBean.course.welcomeMessage.contains('table')}" />
					</p:panel>
				</div>

				<div class="col-12 mt-3">
					<div class="row">
						<div class="col">
							<p:panel header="Common settings">
                                <h:outputText value="#{msg.title}:" styleClass="font-weight-bold" />

                                <p:inputText id="c_title" value="#{adminCourseBean.course.title}" styleClass="w-100 mb-3">
                                    <p:ajax update="message_c_title" />
                                </p:inputText>
                                <p:message for="c_title" showSummary="true" showDetail="false" id="message_c_title"/>


                                <h:outputText value="Wizard Parameter:" styleClass="font-weight-bold" />

                                <p:inputText id="c_param" value="#{adminCourseBean.course.wizardParam}" styleClass="w-100 mb-3">
                                    <p:ajax update="message_c_param" />
                                </p:inputText>
                                <p:message for="c_param" showSummary="true" showDetail="false" id="message_c_param"/>

                                <h:outputText value="#{msg.organization}:" rendered="#{userBean.admin}" styleClass="font-weight-bold" />

                                <p:selectOneMenu id="c_organisation" value="#{adminCourseBean.course.organisationId}" rendered="#{userBean.admin}" styleClass="w-100 mb-3">
                                    <f:selectItem itemLabel="No organisation" itemValue="0" />
                                    <f:selectItem itemLabel="------------" itemValue="-1" itemDisabled="true" />
                                    <f:selectItems var="org" value="#{adminCourseBean.organisations}" itemLabel="#{org.title}" itemValue="#{org.id}"/>
                                </p:selectOneMenu>
                                <p:message for="c_organisation" showSummary="true" showDetail="false" id="message_c_organisation" rendered="#{userBean.admin}"/>

                                <h:outputText value="Default group:" styleClass="font-weight-bold" />

                                <p:selectOneMenu id="c_group" value="#{adminCourseBean.course.defaultGroupId}" styleClass="w-100 mb-3">
                                    <f:selectItem itemLabel="No default group" itemValue="0" />
                                    <f:selectItem itemLabel="------------" itemValue="-1" itemDisabled="true" />
                                    <f:selectItems var="group" value="#{adminCourseBean.course.groups}" itemLabel="#{group.title}" itemValue="#{group.id}"/>
                                </p:selectOneMenu>
                                <p:message for="c_group" showSummary="true" showDetail="false" />


							</p:panel>





						</div>
						<div class="col">

							<p:panel header="Additional settings">
                                <p:accordionPanel autoHeight="false" id="courseoptions">
                                    <c:forEach items="#{adminCourseBean.optionGroups}" var="group" varStatus="status">

                                        <p:tab title="#{adminCourseBean.optionGroups[status.index].title}">
                                            <h:dataTable value="#{adminCourseBean.optionGroups[status.index].options}" var="option">
                                                <h:column>
                                                    <h:selectBooleanCheckbox value="#{option.value}" id="checkbox"/>
                                                </h:column>
                                                <h:column>
                                                    <h:outputLabel value="#{option.name}" for="checkbox" />
                                                </h:column>
                                            </h:dataTable>
                                        </p:tab>

                                    </c:forEach>
                                </p:accordionPanel>

                                <p>
                                    #{msg.changes_login_again}
                                </p>
                            </p:panel>
						</div>
					</div>
				</div>

				<div class="col-12 mt-3">
					<p:panel>
							<p:commandButton styleClass="command-button" actionListener="#{adminCourseBean.save}" value="#{msg.save}" update=":growl :courseoptions">
								<f:param name="course_id" value="#{adminCourseBean.courseId}" />
							</p:commandButton>
					</p:panel>


				</div>

			</div>


		</h:form>




	</ui:define>
</ui:composition>