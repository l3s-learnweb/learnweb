<ui:composition 
	template="/templates/main/main.xhtml" 
	xmlns="http://www.w3.org/1999/xhtml" 
	xmlns:ui="http://java.sun.com/jsf/facelets" 
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core" 
	xmlns:c="http://java.sun.com/jsp/jstl/core" 
	xmlns:p="http://primefaces.org/ui">

	<ui:define name="metadata">
		<f:metadata>
			<f:viewParam name="course_id" value="#{adminCourseBean.courseId}" />
		</f:metadata>
	</ui:define>
	
	<ui:param name="loginRequired" value="true"/>
	<ui:param name="pageTitle" value="#{adminCourseBean.course.title} #{msg.course}" />
	
	<ui:define name="center_layout">

		<p:panel header="#{adminCourseBean.course.title} - #{msg.course}">
			<h:form id="course_form" prependId="false">
				<h:panelGrid columns="3" columnClasses="medium-width">
					
					<h:outputText value="#{msg.title}:" />
					<p:inputText id="c_title" value="#{adminCourseBean.course.title}">
						<p:ajax update="message_c_title" />
					</p:inputText>
					<p:message for="c_title" showSummary="true" showDetail="false" id="message_c_title"/>
					
					<h:outputText value="Wizard Parameter:" />
					<p:inputText id="c_param" value="#{adminCourseBean.course.wizardParam}">
						<p:ajax update="message_c_param" />
					</p:inputText>
					<p:message for="c_param" showSummary="true" showDetail="false" id="message_c_param"/>
					
					<h:outputText value="#{msg.organization}:" rendered="#{userBean.admin}" />
					<p:selectOneMenu id="c_organisation" value="#{adminCourseBean.course.organisationId}" rendered="#{userBean.admin}">
						<f:selectItem itemLabel="No organisation" itemValue="0" />
						<f:selectItem itemLabel="------------" itemValue="-1" itemDisabled="true" />	
						<f:selectItems var="org" value="#{adminCourseBean.organisations}" itemLabel="#{org.title}" itemValue="#{org.id}"/>
					</p:selectOneMenu>
					<p:message for="c_organisation" showSummary="true" showDetail="false" id="message_c_organisation" rendered="#{userBean.admin}"/>
						
					<h:outputText value="Default group:" />
					<p:selectOneMenu id="c_group" value="#{adminCourseBean.course.defaultGroupId}">
						<f:selectItem itemLabel="No default group" itemValue="0" />
						<f:selectItem itemLabel="------------" itemValue="-1" itemDisabled="true" />	
						<f:selectItems var="group" value="#{adminCourseBean.course.groups}" itemLabel="#{group.title}" itemValue="#{group.id}"/>
					</p:selectOneMenu>
					<p:message for="c_group" showSummary="true" showDetail="false" />
					
					<h:outputText value="Banner image:" />
					  <p:fileUpload fileUploadListener="#{adminCourseBean.handleFileUpload}" id="imageupload" mode="advanced"  
			            update="bannerimage" auto="true" sizeLimit="1000000" allowTypes="/(\.|\/)(gif|jpe?g|png)$/"/> 
					<h:panelGroup id="bannerimage">
						<img src="#{adminCourseBean.course.bannerImage}" />
					</h:panelGroup>

				</h:panelGrid>
				<br/>
				<p:editor value="#{adminCourseBean.course.welcomeMessage}" width="600" />
			 
			 	<br/>
				<p:accordionPanel autoHeight="false" id="courseoptions">
					<c:forEach items="#{adminCourseBean.optionGroups}" var="group" varStatus="status">					

						<p:tab title="#{adminCourseBean.optionGroups[status.index].title}">
							<h:dataTable value="#{adminCourseBean.optionGroups[status.index].options}" var="option">
								<h:column>
									<h:selectBooleanCheckbox value="#{option.value}" id="checkbox"/>
								</h:column>
								<h:column>
									<h:outputLabel value="#{option.name}" for="checkbox" />
								</h:column>
							</h:dataTable>
						</p:tab>

					</c:forEach>
				</p:accordionPanel>
				
				<p>
					#{msg.changes_login_again}
				</p>		
				
				<p:commandButton actionListener="#{adminCourseBean.save}" value="#{msg.save}" update=":growl :courseoptions">
					<f:param name="course_id" value="#{adminCourseBean.courseId}" />
				</p:commandButton>
			</h:form>
		</p:panel>
	</ui:define>
</ui:composition>