<ui:composition
    template="/WEB-INF/templates/layout/template.xhtml"
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:p="http://primefaces.org/ui">

	<ui:param name="loginRequired" value="true"/>
	<ui:param name="pageTitle" value="#{msg.user_submissions}"/>

    <ui:define name="sub_breadcrumb">
        <p:menuitem value="#{msg.user_submissions}" url="admin/user_submissions.jsf"/>
    </ui:define>

	<ui:define name="center_layout">
        <p:panel header="#{msg.submissions}" styleClass="ui-widget-content-p-0 ui-widget-no-border">
            <p:dataTable value="#{submissionBean.getUsers()}" var="user" tableStyleClass="table-sm table-responsive"
                         rows="50" paginatorPosition="bottom" paginator="true" rowsPerPageTemplate="50,100,500"
                         paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}">
                <p:column sortBy="#{user.username}" filterBy="#{user.username}" headerText="#{msg.username}">
                    <h:outputLink value="myhome/profile.jsf">
                        <f:param name="user_id" value="#{user.id}"/>
                        <h:outputText value="#{user.username}"/>
                    </h:outputLink>
                </p:column>

                <p:column sortBy="#{user.studentId}" filterBy="#{user.studentId}" headerText="#{msg.student_id}">
                    <h:outputText value="#{user.studentId}"/>
                </p:column>

                <p:column sortBy="#{user.email}" filterBy="#{user.email}" headerText="#{msg.email_address}">
                    <h:outputText value="#{user.email}"/>
                </p:column>

                <p:column sortBy="#{user.organisation.title}" filterBy="#{user.organisation.title}" headerText="#{msg.organization}">
                    <h:outputText value="#{user.organisation.title}"/>
                </p:column>

                <p:column sortBy="${submissionBean.getNumberOfSubmissions(user.id)}" headerText="#{msg['Submission.no_of_submissions']}">
                    <h:outputText value="${submissionBean.getNumberOfSubmissions(user.id)}"/>
                </p:column>

                <p:column headerText="#{msg.links}">
                    <h:outputLink value="myhome/submission_overview.jsf">
                        <f:param name="user_id" value="#{user.id}"/>
                        <h:outputText value="#{msg['Submission.view_submissions']}"/>
                    </h:outputLink>
                </p:column>
            </p:dataTable>
        </p:panel>
	</ui:define>
</ui:composition>