<ui:composition template="/templates/main/main_metadata.xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough">

	<ui:param name="loginRequired" value="true" />
	<ui:param name="helpText" value="#{msg.groupResourceHelp}" />
	<ui:param name="pageTitle" value="#{msg.group} - #{msg.resources}" />

	<ui:param name="loginRequired" value="true" />
	<ui:param name="helpText" value="#{msg.groupResourceHelp}"/>
	<ui:param name="pageTitle" value="#{msg.group} - #{msg.resources}" />
	<ui:param name="disableGrowl" value="false" />

	<ui:define name="metadata">
		<f:metadata>
			<f:viewParam name="group_id" value="#{groupDetailBean.groupId}" />
			<f:viewParam name="folder_id" value="#{groupDetailBean.selectedFolderId}" />
			<f:viewParam name="resource_id" value="#{resourceDetailBean.resourceId}" />
			<f:event type="javax.faces.event.PreRenderViewEvent" listener="#{groupDetailBean.preRenderView}" />
			<f:event type="javax.faces.event.PreRenderViewEvent" listener="#{resourceDetailBean.preRenderView}" />
		</f:metadata>
	</ui:define>

	<ui:define name="center_layout">

		<h:form>
			<p:remoteCommand name="selectGroupItemCommand" actionListener="#{groupDetailBean.actionSelectGroupItem}" update=":add_resource_panel :growl" oncomplete="update_header();resourceDND();"/>
			<p:remoteCommand name="editGroupItemCommand" actionListener="#{groupDetailBean.actionEditGroupItem}" update=":add_resource_panel :growl" oncomplete="update_header()"/>
			<p:remoteCommand name="createGroupItemCommand" actionListener="#{groupDetailBean.actionCreateGroupItem}" update=":add_resource_panel :growl :datagrid" oncomplete="update_header()"/>
			<p:remoteCommand name="openFolderCommand" actionListener="#{groupDetailBean.actionOpenFolder}" update=":group_menu_tree :breadcrumbs :datagrid :paginator :add_resource_panel :growl" oncomplete="update_header();resourceDND();scroller();"/>
			<p:remoteCommand name="updateGroupItemsCommand" actionListener="#{groupDetailBean.actionUpdateGroupItems}" update=":group_menu_tree :datagrid :paginator :add_resource_panel :growl" oncomplete="resourceDND()"/>
			<p:remoteCommand name="updateAddResourcePaneCommand" actionListener="#{groupDetailBean.updateTargetForAddResourceBean}" update=":add_resource_panel :growl" oncomplete="update_header()"/>
			<p:remoteCommand name="updateThumbnailCommand" actionListener="#{resourceDetailBean.setResourceThumbnail}" update=":add_resource_panel :datagrid :growl" oncomplete="update_header();resourceDND();"/>
		</h:form>
	


		<div class="center-header" id="group_header">
			<h2>#{msg.resources}</h2>
			<span class="header_detail"> #{msg.of}
				#{groupDetailBean.group.title}
				(#{groupDetailBean.group.resourcesCount} #{msg.resources}) </span>
				
			<h:form styleClass="layout_button" id="group_layout_options" prependId="false">
				<p:commandButton value="#{msg.list_view}" icon="ui-icon-mylist" update=":tabs:keyResultSection :group_layout_options" rendered="#{groupDetailBean.gridView}">
					<f:setPropertyActionListener target="#{groupDetailBean.gridView}" value="false"/>
				</p:commandButton>
				<p:commandButton value="#{msg.grid_view}" icon="ui-icon-mygrid" update=":tabs:keyResultSection :group_layout_options" rendered="#{!groupDetailBean.gridView}">
					<f:setPropertyActionListener target="#{groupDetailBean.gridView}" value="true"/>
				</p:commandButton>
			</h:form>
			
			<h:form id="center_header_form">
				<p:menuButton value="#{msg.upload_resource}"
					rendered="#{groupDetailBean.group.canAddResources(userBean.user)}"
					menuStyleClass="test" iconPos="right"
					styleClass="resource_button greenbutton resourcetoolbutton">
					<p:menuitem value="#{msg.create_folder}"
						icon="ui-icon-folder-collapsed"
						onclick="doAction('create-folder'); return false;" />
					<p:separator />
					<p:menuitem value="#{msg.upload_file}" icon="ui-icon-disk"
						onclick="doAction('upload-file'); return false;" />
					<p:menuitem value="#{msg.upload_url}" icon="ui-icon-link"
						onclick="doAction('add-website'); return false;" />
					<p:menuitem value="#{msg['Glossary.add_glossary']}"
						icon="ui-icon-link"
						onclick="doAction('add-glossary'); return false;" />
				</p:menuButton>

				<p:commandLink
					rendered="#{groupDetailBean.group.canJoinGroup(userBean.user)}"
					value="#{msg.join_group}" action="#{groupsBean.joinGroup}"
					styleClass="resource_button greenbutton"
					update=":growl :group_menu @form" partialSubmit="true"
					process="@this">
					<f:setPropertyActionListener target="#{groupsBean.selectedGroup}"
						value="#{groupDetailBean.group}" />
				</p:commandLink>
			</h:form>

			<ul>
				<li><a
					href="./group/overview.jsf?group_id=#{groupDetailBean.group.id}">
						<h:outputText value="#{msg.overview}" />
				</a></li>
				<li><a class="active"
					href="./group/resources.jsf?group_id=#{groupDetailBean.group.id}">
						<h:outputText value="#{msg.resources}" />
				</a></li>
				<li><a
					href="./group/members.jsf?group_id=#{groupDetailBean.group.id}">
						<h:outputText value="#{msg.members}" />
				</a></li>
				<li><a
					href="./group/presentations.jsf?group_id=#{groupDetailBean.group.id}">
						<h:outputText value="#{msg.presentations}" />
				</a></li>
				<li><a
					href="./group/links.jsf?group_id=#{groupDetailBean.group.id}">
						<h:outputText value="#{msg.links}" />
				</a></li>
				<li><a
					href="./group/forum.jsf?group_id=#{groupDetailBean.group.id}">
						<h:outputText value="#{msg.forum}" />
				</a></li>
				<ui:fragment
					rendered="${groupDetailBean.group.course.isModerator(userBean.user) || groupDetailBean.group.isLeader(userBean.user)}">
					<li><a
						href="./group/options.jsf?group_id=#{groupDetailBean.group.id}">
							<h:outputText value="#{msg.options}" />
					</a></li>
				</ui:fragment>
			</ul>

			<h:panelGroup id="breadcrumbs" styleClass="breadcrumbs"
				layout="block">
				<ui:fragment rendered="#{not empty groupDetailBean.breadcrumbs}">
					<ul>
						<li data-folderId="0"><h:outputLink value="#"
								onclick="openFolder(0); return false;">#{groupDetailBean.group.title}</h:outputLink>
						</li>

						<ui:repeat var="folder" value="#{groupDetailBean.breadcrumbs}">
							<li data-folderId="#{folder.id}"><h:outputLink value="#"
									onclick="openFolder(#{folder.id}); return false;">#{folder.name}</h:outputLink>
							</li>
						</ui:repeat>
					</ul>
				</ui:fragment>
			</h:panelGroup>


			  	<h:form styleClass="resources-filters-none" id="filters">
				<ul>
					<ui:repeat value="#{groupDetailBean.availableFilters}" var="filter">
						<li class="filter #{filter.disabled ? 'disabled' : (filter.active ? 'active' : null)}">
								<span class="filter-name">
									<span class="trimmed-text">#{filter.name}</span>
									<span class="arrow" />
								</span>
							<ul class="filter-sub-bar vCarousel-wrapper filter-vCarousel">
								<h:panelGroup styleClass="vCarousel-container" layout="block">
									<li class="#{!filter.active ? 'active' : null}">
										<p:commandButton value="#{filter.anyText}" action="#{groupDetailBean.changeFilters(filter.anyUrl)}" update=":datagrid :paginator :filters" oncomplete="updateCarousel()"/>
									</li>

									<ui:repeat value="#{filter.items}" var="item">
										<li class="#{item.active ? 'active' : null}">
											<p:commandButton value="#{item.name} #{item.counter != null ? '('.concat(item.counter).concat(')') : null}" action="#{groupDetailBean.changeFilters(item.url)}" update=":datagrid :paginator :filters" oncomplete="updateCarousel()"/>
										</li>
									</ui:repeat>

								</h:panelGroup>
								<li class="vCarousel-expand">
									<p:commandButton value="#{msg.filter_carousel_all}"/>
								</li>
							</ul>
						</li>
					</ui:repeat>
					<h:panelGroup rendered="#{groupDetailBean.searchFilters != null}">
						<li class="filter clear-filters">
							<p:commandButton value="#{msg.clear_filters}" action="#{groupDetailBean.changeFilters(null)}" update=":datagrid :paginator :filters" oncomplete="updateCarousel()"/>
						</li>
					</h:panelGroup>
				</ul>
			</h:form> 
		</div>
		
		<!-- from here begins the new metadata visualization -->
		<p:tabView id="tabs">
			<p:tab id="keyword_tab" title="Keyword Search">
				<h:form id="header_query_form" prependId="false">
					<img alt=""
						src="#{request.contextPath}/resources/main-template/img/search.png"
						height="20" width="20" id="search_group_resource"
						style="padding: 0px 15px; cursor: pointer; vertical-align: bottom;" />
					<h:inputText style="width: 400px; padding: 3px 0;"
						value="#{groupDetailBean.query}" id="input_query_form"
						onkeyup="if (event.keyCode == 13) {document.getElementById('group_resource_searchbutton').click(); return false; }" />

					<p:commandButton style="visibility:hidden;"
						actionListener="${groupDetailBean.onQueryChange()}"
						partialSubmit="true"
						oncomplete="$('#center_pane .content').scrollTop(0);resourceDND();scroller();"
						process="@form" update=":datagrid :paginator" value=""
						id="group_resource_searchbutton" />
				</h:form>
				<br />
				
				<h:form id="accordion_form" style="width:530px;">
					<p:accordionPanel activeIndex="-2">
						<p:tab
							title="Filters - refine your search or narrow down your search results!">
							<h:form id="metadata_filter_form">
								<p:panelGrid columns="3" cellpadding="20" layout="grid">

									<h:panelGroup>
										<h:outputLabel for="alist" value="Author:  " />
										<p:selectCheckboxMenu id="alist"
											value="#{searchFilterBean.selectedAuthors}" label="Authors"
											multiple="true" filter="true" filterMatchMode="startsWith">
											<f:selectItems value="#{searchFilterBean.authors}" />
										</p:selectCheckboxMenu>
									</h:panelGroup>

									<h:panelGroup>
										<h:outputLabel for="mtlist" value="Media Type:  " />
										<p:selectCheckboxMenu id="mtlist"
											value="#{searchFilterBean.selectedMtypes}"
											label="Media Types" multiple="true" filter="true"
											filterMatchMode="startsWith" panelStyle="width:250px">
											<f:selectItems value="#{searchFilterBean.mtypes}" />
										</p:selectCheckboxMenu>
									</h:panelGroup>

									<h:panelGroup>
										<h:outputLabel for="slist" value="Source:  " />
										<p:selectCheckboxMenu id="slist"
											value="#{searchFilterBean.selectedSources}" label="Sources"
											multiple="true" filter="true" filterMatchMode="startsWith"
											panelStyle="width:250px">
											<f:selectItems value="#{searchFilterBean.sources}" />
										</p:selectCheckboxMenu>
									</h:panelGroup>

									<h:panelGroup>
										<h:outputLabel for="llist" value="Language:" />
										<p:selectCheckboxMenu id="llist"
											value="#{searchFilterBean.selectedLanguages}"
											label="Languages" multiple="true" filter="true"
											filterMatchMode="startsWith" panelStyle="width:250px">
											<f:selectItems value="#{searchFilterBean.langs}" />
										</p:selectCheckboxMenu>
									</h:panelGroup>

									<h:panelGroup>
										<h:outputLabel for="levlist" value="Language Level:" />
										<p:selectCheckboxMenu id="levlist"
											value="#{searchFilterBean.selectedLevels}" label="Levels"
											multiple="true" filter="true" filterMatchMode="startsWith"
											panelStyle="width:250px">
											<f:selectItems value="#{searchFilterBean.levels}" />
										</p:selectCheckboxMenu>
									</h:panelGroup>

									<h:panelGroup>
										<h:outputLabel for="aglist" value="Target Learner:" />
										<p:selectCheckboxMenu id="aglist"
											value="#{searchFilterBean.selectedTargets}"
											label="Target Learners" multiple="true" filter="true"
											filterMatchMode="startsWith" panelStyle="width:250px">
											<f:selectItems value="#{searchFilterBean.targets}" />
										</p:selectCheckboxMenu>
									</h:panelGroup>

									<h:panelGroup>
										<h:outputLabel for="aclist" value="Purpose of Use:" />
										<p:selectCheckboxMenu id="aclist"
											value="#{searchFilterBean.selectedPurposes}"
											label="Purposes of Use" multiple="true" filter="true"
											filterMatchMode="startsWith" panelStyle="width:250px">
											<f:selectItems value="#{searchFilterBean.purposes}" />
										</p:selectCheckboxMenu>
									</h:panelGroup>

								</p:panelGrid>
							</h:form>
						</p:tab>
					</p:accordionPanel>
				</h:form>
				<hr/>
				
				<b><h:outputText value="Click on the resource to view details or add more useful information to help community to discover!"/></b>
				
				<h:panelGroup id="keyResultSection">
					<h:panelGroup id="dataList" rendered="#{!groupDetailBean.gridView}">
						<ui:repeat value="#{groupDetailBean.paginator.currentPage}" 
							var="res">
							<h:panelGroup id="rdetail" styleClass="resource2-item group-resources2-item"
								pt:data-itemType="resource" pt:data-itemId="#{res.resource.id}" layout="block">
										<div id="rlist" style="width: 530px; height: auto;">
											<div id="rnav" style="width: 10%;">
											    <ui:fragment rendered="#{res.type == 'website'}"><img class="timg" src="#{request.contextPath}/resources/resources-chloe/images/web.png" width="80%" /></ui:fragment>
											    <ui:fragment rendered="#{res.type == 'pdf'}"><img class="timg" src="#{request.contextPath}/resources/resources-chloe/images/pdf.png" width="70%" /></ui:fragment>
											    <ui:fragment rendered="#{res.type == 'image'}"><img class="timg" src="#{request.contextPath}/resources/resources-chloe/images/image.png" width="80%" /></ui:fragment>
											    <ui:fragment rendered="#{res.type == 'audio'}"><img class="timg" src="#{request.contextPath}/resources/resources-chloe/images/audio.png" width="80%" /></ui:fragment>
											    <ui:fragment rendered="#{res.type == 'video'}"><img class="timg" src="#{request.contextPath}/resources/resources-chloe/images/video.png" width="70%" /></ui:fragment>
											    <ui:fragment rendered="#{res.type == 'file'}"><img class="timg" src="#{request.contextPath}/resources/resources-chloe/images/file.png" width="80%" /></ui:fragment>
											    
												<!--<img class="timg" src="#{request.contextPath}/resources/resources-chloe/images/web.png" width="80%" /> -->
												<!--<img class="simg" src="#{request.contextPath}/resources/resources-chloe/images/bbc.png" width="80%" /> -->
											</div>

											<div id="rmain" style="width: 90%;">
											    <div class="resource-block2">
											    <div class="resource-preview">
											     	<div class="resource-preview-wrapper">
														<div class="resource-preview-wrapper2">
														<div class="resource-preview-block"></div>
														<div class="resource-preview-block2"></div>
											    			<ui:fragment rendered="#{not empty res.thumbnail1}"><img class="resource-preview-image" src="#{res.thumbnail1.url}" alt="#{res.title}" /></ui:fragment>	
															<!--<img class="example1" src="#{request.contextPath}/resources/resources-chloe/images/barneybearbbc.png"
															width="30%" /> -->
														    <h:outputText styleClass="resource-preview-empty" escape="false" value='#{res.embeddedSize1.replaceAll("width=\".*\"","").replaceAll("height=\".*\"","").replaceAll("/>","").replaceAll(">","").concat(" width=\"150\" height=\"150\" />")}' rendered="#{empty res.thumbnail1}"/>
													    </div>
													</div>
													<h:panelGroup class="resource-controls2" layout="block">
														<h:outputLink value="#" title="#{msg.copy}"
															styleClass="action-copy">
														<h:graphicImage alt="Copy" value="/resources/icon/Add.png" />
														</h:outputLink>

														<ui:fragment
															rendered="${groupDetailBean.canDeleteResourcesInTheGroup()}">
															<h:outputLink value="#" title="#{msg.edit}"
																styleClass="action-edit">
															<h:graphicImage alt="Edit"
																value="../resources/icon/Edit.png" />
															</h:outputLink>

															<h:outputLink value="#" title="#{msg.delete}"
																styleClass="action-delete">
															<h:graphicImage alt="Delete"
																value="../resources/icon/Remove.png" />
															</h:outputLink>
														</ui:fragment>
													</h:panelGroup>
												</div>
												</div>
												
												<div class="metadata-block">
												<label class="rlabel"><b>Title:
												</b></label> <span class="text-ellipses">#{res.title}</span><br /> 
												<label class="rlabel"><b>Category:
												</b></label>
												<h:outputText value = "not available. please help to add it" rendered="#{empty res.eMetadata.categories[0]}"/>
												<h:outputText value = "#{res.eMetadata.categories[0]}" rendered="#{not empty res.eMetadata.categories[0]}"/> <br /> <label
													class="rlabel"><b>Contains: </b></label>#{res.mtype}
												<br /> 
												<label class="rlabel"><b>Language: </b></label>
												#{res.language} <label class="rlabels"><b>Level (stats):
												</b></label>#{res.eMetadata.lCount} <br /> 
												<label class="rlabel"><b>Target
														learner (stats): </b></label>
														<ui:repeat value="#{res.eMetadata.targetCount.entrySet().toArray()}" var="t">
										                
														<h:graphicImage class="circle" value="/resources/resources-chloe/images/green_circle.png" width="3%" rendered="#{t.key == 'very young learners (pre-school)'}" alt="o" />
														<h:graphicImage class="circle" value="/resources/resources-chloe/images/blue_circle.png" width="3%" rendered="#{t.key == 'young learners (elementary)'}" alt="o" />
														<h:graphicImage class ="bluecircle" value="/resources/resources-chloe/images/yellow_circle.png" width="3%" rendered="#{t.key == 'teenage learners'}" alt="o" />
														<h:graphicImage class ="circle" value="/resources/resources-chloe/images/red_circle.png" width="3%" rendered="#{t.key == 'teachers'}" alt="o" />
														<h:graphicImage class ="circle" value="/resources/resources-chloe/images/red_circle.png" width="3%" rendered="#{t.key == 'adult learners'}" alt="o"/>
														
														<h:outputText value="Pre-school" rendered="#{t.key == 'very young learners (pre-school)'}" />
														<h:outputText value="Young learners" rendered="#{t.key == 'young learners (elementary)'}" />
														<h:outputText value="Teens" rendered="#{t.key == 'teenage learners'}" />
														<h:outputText value="Adult learners" rendered="#{t.key == 'adult learners'}" />
														<h:outputText value="Teachers" rendered="#{t.key == 'teachers'}" />
														<h:outputText value="[#{t.value}] " /> 
														
														</ui:repeat>
												<br /> 
												
												<label class="rlabel"><b>Purpose of use (stats): </b></label>
														<ui:repeat value="#{res.eMetadata.purposeCount.entrySet().toArray()}" var="p">
														<h:graphicImage class="bluecircle" value="/resources/resources-chloe/images/speaking.png" width="3%" rendered="#{p.key == 'speaking skills'}" alt="speaking" />
														<h:graphicImage class="bluecircle" value="/resources/resources-chloe/images/listening.png" width="3%" rendered="#{p.key == 'listening skills'}" alt="listening" />
														<h:graphicImage class ="bluecircle" value="/resources/resources-chloe/images/writing.png" width="3%" rendered="#{p.key == 'writing skills'}" alt="writing" />
														<h:graphicImage class ="bluecircle" value="/resources/resources-chloe/images/reading.png" width="3%" rendered="#{p.key == 'reading skills'}" alt="reading" />
													
														<h:outputText value="Speaking" rendered="#{p.key == 'speaking skills'}" />
														<h:outputText value="Listening" rendered="#{p.key == 'listening skills'}" />
														<h:outputText value="Writing" rendered="#{p.key == 'writing skills'}" />
														<h:outputText value="Reading" rendered="#{p.key == 'reading skills'}" />
														<h:outputText value="[#{p.value}] " rendered="#{p.key == 'speaking skills' or p.key == 'listening skills' or p.key =='writing skills' or p.key =='reading skills'}" /> 
														</ui:repeat>
												<br /> 
												
												<ui:repeat value="#{res.eMetadata.purposeCount.entrySet().toArray()}" var="p">
													<ui:fragment rendered="#{p.key != 'speaking skills' and p.key != 'listening skills' and p.key !='writing skills' and p.key !='reading skills'}">
    													<span class="tag tag-grey">#{p.key}</span>
													</ui:fragment>
												</ui:repeat>
											</div>
										</div>
									</div>
									<hr style="margin-top:5px; margin-bottom:5px;" />
							</h:panelGroup>
						</ui:repeat>
					</h:panelGroup>
					
					<h:panelGroup id="dataGrid" rendered="#{groupDetailBean.gridView}" layout="block"
					pt:data-isEnabledMoving="#{groupDetailBean.canDeleteResourcesInTheGroup()}">
						<h:panelGroup id="folderGrid" styleClass="folder-grid"
						layout="block">
						<br/>
					
						<ui:repeat value="#{groupDetailBean.subfolders}" var="folder">
						<h:panelGroup styleClass="folder-item group-resources-item"
							pt:data-itemType="folder" pt:data-itemId="#{folder.folderId}"
							layout="block">
							<div class="folder-block">

								<div class="folder-icon">
									<div class="folder-icon-wrapper">
										<span class="icon icon-folder" />
									</div>
								</div>

								<div class="folder-title">
									<div class="folder-title-wrapper">
										<h:outputText value="#{folder.name}" escape="false"
											styleClass="folder-title-name" title="#{folder.name}" />
									</div>

									<h:panelGroup class="resource-controls" layout="block"
										rendered="${groupDetailBean.canDeleteResourcesInTheGroup()}">
										<h:outputLink value="#" title="#{msg.edit}"
											styleClass="action-edit">
											<h:graphicImage alt="Edit" value="../resources/icon/Edit.png" />
										</h:outputLink>

										<h:outputLink value="#" title="#{msg.delete}"
											styleClass="action-delete">
											<h:graphicImage alt="Remove"
												value="../resources/icon/Remove.png" />
										</h:outputLink>
									</h:panelGroup>
								</div>

							</div>
						</h:panelGroup>
					</ui:repeat>
				</h:panelGroup>

						<h:panelGroup id="resourceGrid" styleClass="resource-grid"
						layout="block">
						<ui:repeat value="#{groupDetailBean.paginator.currentPage}"
						var="res">
						<h:panelGroup styleClass="resource-item group-resources-item"
							pt:data-itemType="resource" pt:data-itemId="#{res.resource.id}"
							layout="block">
							<div class="resource-block">
								<div class="resource-preview">
									<div class="resource-preview-wrapper">
										<div class="resource-preview-wrapper2">
											<div class="resource-preview-block"></div>
											<div class="resource-preview-block2"></div>
											<h:graphicImage styleClass="resource-preview-image"
												value="#{res.thumbnail1.url}"
												rendered="#{not empty res.thumbnail1}" alt="#{res.title}" />
											<h:outputText styleClass="resource-preview-empty"
												escape="false"
												value='#{res.resource.embeddedSize1.replaceAll("width=\".*\"","").replaceAll("height=\".*\"","").replaceAll("/>","").replaceAll(">","").concat(" width=\"150\" height=\"150\" />")}'
												rendered="#{empty res.thumbnail1}" />
										</div>
									</div>

									<h:panelGroup class="resource-controls" layout="block">
										<h:outputLink value="#" title="#{msg.copy}"
											styleClass="action-copy">
											<h:graphicImage alt="Copy" value="/resources/icon/Add.png" />
										</h:outputLink>

										<ui:fragment
											rendered="${groupDetailBean.canDeleteResourcesInTheGroup()}">
											<h:outputLink value="#" title="#{msg.edit}"
												styleClass="action-edit">
												<h:graphicImage alt="Edit"
													value="../resources/icon/Edit.png" />
											</h:outputLink>

											<h:outputLink value="#" title="#{msg.delete}"
												styleClass="action-delete">
												<h:graphicImage alt="Delete"
													value="../resources/icon/Remove.png" />
											</h:outputLink>
										</ui:fragment>
									</h:panelGroup>
								</div>

								<div class="resource-title">
									<div class="resource-title-wrapper">
										<!--<div class="resource-title-icon">
											<div class="resource-title-icon-wrapper">
												<img src="img.png" alt="Title" />
											</div>
										</div>-->
										<div class="resource-title-text">
											<h:outputText value="#{res.title}" escape="false"
												styleClass="resource-title-name" title="#{res.title}" />
											<span class="resource-title-summary"><span>${learnwebBean.getLocaleMessage(res.type)}</span>
												#{msg.added_by} <span>#{res.ownerUser.username}</span></span>
										</div>
									</div>
								</div>

							</div>
						</h:panelGroup>
					</ui:repeat>
				</h:panelGroup>

					<h:outputText value="${msg.no_resources_found}"
					class="nothing_found"
					rendered="#{groupDetailBean.paginator.isEmpty() and groupDetailBean.paginator.getClass().getSimpleName() eq 'GroupPaginator'}" />

					<h:outputText value="#{msg.no_results_found}" class="nothing_found"
					rendered="#{groupDetailBean.paginator.isEmpty() and groupDetailBean.paginator.getClass().getSimpleName() eq 'SearchPaginator'}" />

					</h:panelGroup>
				</h:panelGroup>
			</p:tab>

			<p:tab id="category_tab" title="Category Navigation">
				<h:panelGroup>

					<h:panelGroup id="catTreeSection">
						<div id="cattree"></div>
					</h:panelGroup>
					<hr/>
					<h:panelGroup id="catResultSection">
						<ui:repeat value="#{groupDetailBean.paginator.currentPage}"
							var="res">
							<h:panelGroup id="rdetail" styleClass="resource2-item group-resources-item"
								pt:data-itemType="resource" pt:data-itemId="#{res.resource.id}" layout="block">
										<div id="rlist">
											<div id="rnav">
												<img class="timg" src="#{request.contextPath}/resources/resources-chloe/images/web.png" width="98%" /> 
												<img class="simg" src="#{request.contextPath}/resources/resources-chloe/images/bbc.png" width="98%" />
											</div>

											<div id="rmain">
												<img class="example1" src="#{request.contextPath}/resources/resources-chloe/images/barneybearbbc.png"
													width="23%" /> 
												<label class="rlabel"><b>Title:
												</b></label>#{res.title} <br /> 
												<label class="rlabel"><b>Category:
												</b></label>Education/Language Learning/Games <br /> <label
													class="rlabel"><b>Contains: </b></label>Text, Audio, Video
												<br /> 
												<label class="rlabel"><b>Language: </b></label>
												English <label class="rlabels"><b>Level (stats):
												</b></label>A1[10] A2[1] <br /> 
												<label class="rlabel"><b>Target
														learner (stats): </b></label>
												<img class="circle" src="#{request.contextPath}/resources/resources-chloe/images/green_circle.png" width="2%" />Pre-school[7] 
												<img class="bluecircle" src="#{request.contextPath}/resources/resources-chloe/images/blue_circle.png" width="2%" />Teens[4]
												<img class="circle" src="#{request.contextPath}/resources/resources-chloe/images/red_circle.png" width="2%" />Adults[1]
												<br /> 
												<label class="rlabel"><b>Purpose of use (stats): </b></label>
												<img class="bluecircle" src="#{request.contextPath}/resources/resources-chloe/images/speaking.png" width="2%" />Speaking[3] 
												<img class="bluecircle" src="#{request.contextPath}/resources/resources-chloe/images/listening.png" width="2%" />Listening[5] 
												<img class="bluecircle" src="#{request.contextPath}/resources/resources-chloe/images/writing.png" width="2%"/>Writing[1]
												<img class="bluecircle" src="#{request.contextPath}/resources/resources-chloe/images/reading.png" width="2%" />Reading[0]
												<br /> 
												<span class="tag tag-grey">Games</span>
												<span class="tag tag-grey">Interactive</span>
												<span class="tag tag-grey">Story telling</span>
											</div>
										</div>
							</h:panelGroup>
						</ui:repeat>
					</h:panelGroup>

				</h:panelGroup>
			</p:tab>
		
		</p:tabView>

		<p:dialog id="deleteConfirmDialog"
			header="#{msg.delete_resource_title}" widgetVar="deleteConfirm"
			appendTo="@(body)" closable="false" minWidth="540" modal="true">
			<p>
				<h:outputText value="#{msg.delete_confirm_dialog_content_folder}"
					styleClass="single-folder" />
				<h:outputText value="#{msg.delete_confirm_dialog_content}"
					styleClass="single-resource" />
				<h:outputText value="#{msg.delete_confirm_dialog_content_plural}"
					styleClass="plural" />
			</p>

			<h:panelGroup colspan="2" styleClass="float-right"
				style="margin: 10px 0;">
				<p:button value="#{msg.cancel}" styleClass="graybutton"
					onclick="PF('deleteConfirm').hide(); return false;" />
				<p:button value="#{msg.delete}" styleClass="confirm greenbutton"
					onclick="return false" />
			</h:panelGroup>
		</p:dialog>

		<p:dialog id="selectDestinationDialog"
			header="#{msg.selectDestination}" widgetVar="selectDestination"
			appendTo="@(body)" closable="false" minWidth="540" modal="true">
			<h:panelGrid columns="2">
				<h:outputText value="#{msg.add_to}:" />

				<h:form>
					<p:tree id="folders_tree" value="#{userBean.writeAbleGroupsTree}"
						var="node" animate="true" dynamic="true" selectionMode="single"
						selection="#{groupDetailBean.selectedTargetNode}"
						style="max-height:28rem; overflow:auto;">
						<p:ajax event="select"
							listener="#{groupDetailBean.onTargetNodeSelect}" />

						<p:treeNode type="group">
							<h:outputText id="group" value="#{node.title}" />
						</p:treeNode>

						<p:treeNode type="folder" expandedIcon="ui-icon-folder-open"
							collapsedIcon="ui-icon-folder-collapsed">
							<h:outputText value="#{node.name}" />
						</p:treeNode>
					</p:tree>
				</h:form>
			</h:panelGrid>

			<h:panelGroup colspan="2" styleClass="float-right"
				style="margin: 10px 0;">
				<p:button value="#{msg.cancel}" styleClass="graybutton"
					onclick="PF('selectDestination').hide(); return false;" />
				<p:button value="#{msg.save}" styleClass="confirm greenbutton"
					onclick="return false" />
			</h:panelGroup>
		</p:dialog>

		<p:dialog id="addTagDialog" header="#{msg.addTag}" widgetVar="addTag"
			appendTo="@(body)" closable="false" minWidth="540" modal="true">
			<h:panelGrid columns="1">
				<p:inputText id="modal_tag_name"
					value="#{resourceDetailBean.clickedComment.text}" />
			</h:panelGrid>

			<h:panelGroup colspan="2" styleClass="float-right"
				style="margin: 10px 0;">
				<p:button value="#{msg.cancel}" styleClass="graybutton"
					onclick="PF('addTag').hide(); return false;" />
				<p:button value="#{msg.save}" styleClass="confirm greenbutton"
					onclick="return false" />
			</h:panelGroup>
		</p:dialog>

		<p:dialog header="#{msg.edit}" id="comment_dialog1" modal="true"
			minWidth="440" appendTo="@(body)" widgetVar="comment_dialog">
			<h:form id="comment_dialog_form">
				<p:inputTextarea autoResize="1" maxHeight="20"
					value="#{resourceDetailBean.clickedComment.text}"
					id="edit_comment_textbox" />
				<p:commandButton
					actionListener="#{resourceDetailBean.onEditComment}"
					title="#{msg.save}" value="#{msg.save}"
					onsuccess="PF('comment_dialog').hide();" />
			</h:form>
		</p:dialog>
		
		
		
		
		<p:dialog id="popup_layout" header="#{resourceDetailBean.clickedResource.id eq -1? msg.click_to_view_details : resourceDetailBean.clickedResource.title}" widgetVar="rdetail_dialog"
			appendTo="@(body)" width="600" height="450" modal="true" closable="true">
			<ui:include src="/templates/resources/blank.xhtml">
				<ui:param name="bean" value="#{groupDetailBean}" />
			</ui:include>
		</p:dialog>
		
		
		
		<ui:fragment
			rendered="${not groupDetailBean.group.canViewResources(userBean.user)}">
			<h3 class="error">
				#{msg.group_resources_access_denied}
				<h:outputText
					rendered="${groupDetailBean.group.policyView != 'GROUP_LEADER' and groupDetailBean.group.canJoinGroup(userBean.user)}"
					value="#{msg.group_resources_access_denied_join_first}" />
			</h3>
		</ui:fragment>

		<ui:fragment
			rendered="#{groupDetailBean.group.canViewResources(userBean.user)}">
			<h:panelGroup id="datagrid" styleClass="display-none" layout="block"
				pt:data-isEnabledMoving="#{groupDetailBean.canDeleteResourcesInTheGroup()}">
				<h:panelGroup id="folderGrid" styleClass="folder-grid"
					layout="block">
					<ui:repeat value="#{groupDetailBean.subfolders}" var="folder">
						<h:panelGroup styleClass="folder-item group-resources-item"
							pt:data-itemType="folder" pt:data-itemId="#{folder.folderId}"
							layout="block">
							<div class="folder-block">

								<div class="folder-icon">
									<div class="folder-icon-wrapper">
										<span class="icon icon-folder" />
									</div>
								</div>

								<div class="folder-title">
									<div class="folder-title-wrapper">
										<h:outputText value="#{folder.name}" escape="false"
											styleClass="folder-title-name" title="#{folder.name}" />
									</div>

									<h:panelGroup class="resource-controls" layout="block"
										rendered="${groupDetailBean.canDeleteResourcesInTheGroup()}">
										<h:outputLink value="#" title="#{msg.edit}"
											styleClass="action-edit">
											<h:graphicImage alt="Edit" value="../resources/icon/Edit.png" />
										</h:outputLink>

										<h:outputLink value="#" title="#{msg.delete}"
											styleClass="action-delete">
											<h:graphicImage alt="Remove"
												value="../resources/icon/Remove.png" />
										</h:outputLink>
									</h:panelGroup>
								</div>

							</div>
						</h:panelGroup>
					</ui:repeat>
				</h:panelGroup>

				<h:panelGroup id="resourceGrid" styleClass="resource-grid"
					layout="block">
					<ui:repeat value="#{groupDetailBean.paginator.currentPage}"
						var="res">
						<h:panelGroup styleClass="resource-item group-resources-item"
							pt:data-itemType="resource" pt:data-itemId="#{res.resource.id}"
							layout="block">
							<div class="resource-block">

								<div class="resource-preview">
									<div class="resource-preview-wrapper">
										<div class="resource-preview-wrapper2">
											<div class="resource-preview-block"></div>
											<div class="resource-preview-block2"></div>
											<h:graphicImage styleClass="resource-preview-image"
												value="#{res.thumbnail1.url}"
												rendered="#{not empty res.thumbnail1}" alt="#{res.title}" />
											<h:outputText styleClass="resource-preview-empty"
												escape="false"
												value='#{res.resource.embeddedSize1.replaceAll("width=\".*\"","").replaceAll("height=\".*\"","").replaceAll("/>","").replaceAll(">","").concat(" width=\"150\" height=\"150\" />")}'
												rendered="#{empty res.thumbnail1}" />
										</div>
									</div>

									<h:panelGroup class="resource-controls" layout="block">
										<h:outputLink value="#" title="#{msg.copy}"
											styleClass="action-copy">
											<h:graphicImage alt="Copy" value="/resources/icon/Add.png" />
										</h:outputLink>

										<ui:fragment
											rendered="${groupDetailBean.canDeleteResourcesInTheGroup()}">
											<h:outputLink value="#" title="#{msg.edit}"
												styleClass="action-edit">
												<h:graphicImage alt="Edit"
													value="../resources/icon/Edit.png" />
											</h:outputLink>

											<h:outputLink value="#" title="#{msg.delete}"
												styleClass="action-delete">
												<h:graphicImage alt="Delete"
													value="../resources/icon/Remove.png" />
											</h:outputLink>
										</ui:fragment>
									</h:panelGroup>
								</div>

								<div class="resource-title">
									<div class="resource-title-wrapper">
										<!--<div class="resource-title-icon">
											<div class="resource-title-icon-wrapper">
												<img src="img.png" alt="Title" />
											</div>
										</div>-->
										<div class="resource-title-text">
											<h:outputText value="#{res.title}" escape="false"
												styleClass="resource-title-name" title="#{res.title}" />
											<span class="resource-title-summary"><span>${learnwebBean.getLocaleMessage(res.type)}</span>
												#{msg.added_by} <span>#{res.ownerUser.username}</span></span>
										</div>
									</div>
								</div>

							</div>
						</h:panelGroup>
					</ui:repeat>
				</h:panelGroup>

				<h:outputText value="${msg.no_resources_found}"
					class="nothing_found"
					rendered="#{groupDetailBean.paginator.isEmpty() and groupDetailBean.paginator.getClass().getSimpleName() eq 'GroupPaginator'}" />

				<h:outputText value="#{msg.no_results_found}" class="nothing_found"
					rendered="#{groupDetailBean.paginator.isEmpty() and groupDetailBean.paginator.getClass().getSimpleName() eq 'SearchPaginator'}" />

			</h:panelGroup>

			<h:panelGroup id="paginator" layout="block">
				<ui:decorate template="/templates/main/paging.xhtml">
					<ui:param name="paginator" value="${groupDetailBean.paginator}" />
				</ui:decorate>
			</h:panelGroup>

			<div class="context-menu resource-context-menu" role="menu">
				<div class="context-menu-item action-open-folder" role="menuitem">
					<div class="context-menu-item-wrapper">
						<span class="context-menu-item-icon" /> <span
							class="context-menu-item-content">#{msg.open}</span>
					</div>
				</div>
				<ui:fragment
					rendered="#{groupDetailBean.group.canAddResources(userBean.user)}">
					<div class="context-menu-item action-create-folder" role="menuitem">
						<div class="context-menu-item-wrapper">
							<span class="context-menu-item-icon" /> <span
								class="context-menu-item-content">#{msg.create_folder}</span>
						</div>
					</div>
					<div class="context-menu-item divider action-upload-file"
						role="menuitem">
						<div class="context-menu-item-wrapper">
							<span class="context-menu-item-icon" /> <span
								class="context-menu-item-content">#{msg.upload_file}</span>
						</div>
					</div>
					<div class="context-menu-item action-add-website" role="menuitem">
						<div class="context-menu-item-wrapper">
							<span class="context-menu-item-icon" /> <span
								class="context-menu-item-content">#{msg.upload_url}</span>
						</div>
					</div>
				</ui:fragment>
				<ui:fragment
					rendered="#{groupDetailBean.group.canAnnotateResources(userBean.user)}">
					<div class="context-menu-item action-add-tag" role="menuitem">
						<div class="context-menu-item-wrapper">
							<span class="context-menu-item-icon" /> <span
								class="context-menu-item-content">#{msg.addTag}</span>
						</div>
					</div>
				</ui:fragment>
				<ui:fragment
					rendered="#{groupDetailBean.group.canEditResources(userBean.user)}">
					<div class="context-menu-item action-edit" role="menuitem">
						<div class="context-menu-item-wrapper">
							<span class="context-menu-item-icon" /> <span
								class="context-menu-item-content">#{msg.edit}</span>
						</div>
					</div>
				</ui:fragment>
				<div class="context-menu-item action-copy" role="menuitem">
					<div class="context-menu-item-wrapper">
						<span class="context-menu-item-icon" /> <span
							class="context-menu-item-content">#{msg.copy}</span>
					</div>
				</div>
				<ui:fragment
					rendered="#{groupDetailBean.canDeleteResourcesInTheGroup()}">
					<div class="context-menu-item action-move" role="menuitem">
						<div class="context-menu-item-wrapper">
							<span class="context-menu-item-icon" /> <span
								class="context-menu-item-content">#{msg.move}</span>
						</div>
					</div>
					<div class="context-menu-item action-delete" role="menuitem">
						<div class="context-menu-item-wrapper">
							<span class="context-menu-item-icon" /> <span
								class="context-menu-item-content">#{msg.removeFromGroup}</span>
						</div>
					</div>
				</ui:fragment>
			</div>
		</ui:fragment>

		<script type="text/javascript">
			$(document).on('ready', prepareCategoryInterface);
			
			$("#header_query_form").css("display","none");

			$("#search_group_resource").click(function () {
				$("#header_query_form").animate({ width: "toggle" }, 500, 'swing');
				$("#input_query_form").focus();
				$("#search_group_resource").hide();
			});

			updateCarousel();

			$("#center_pane").prepend($("#group_header")).append($("#paginator"));
			
			
			
			
		</script>
		
	</ui:define>
	
	<ui:define name="right_layout">
		<ui:decorate  template="/templates/resources/right_pane_yell.xhtml">
			<ui:param name="bean" value="#{groupDetailBean}" />
		</ui:decorate>
	</ui:define>
	
	
</ui:composition>