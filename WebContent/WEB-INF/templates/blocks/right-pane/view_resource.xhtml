<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
                xmlns:p="http://primefaces.org/ui">

<h:outputText value="This resource has been removed" rendered="${not rightPaneBean.clickedResource.canViewResource(userBean.user) and (rightPaneBean.clickedResource.deleted or rightPaneBean.clickedResource.groupId eq 0)}"/>

<h:outputText value="#{msg.group_resources_access_denied}" rendered="${not rightPaneBean.clickedResource.canViewResource(userBean.user) and not (rightPaneBean.clickedResource.deleted or rightPaneBean.clickedResource.groupId eq 0)}"/>

<ui:fragment rendered="#{rightPaneBean.clickedResource.canViewResource(userBean.user)}">
    <ui:fragment rendered="#{rightPaneBean.clickedResource.type eq 'spreadsheet' or
                             rightPaneBean.clickedResource.type eq 'presentation' or
                             rightPaneBean.clickedResource.type eq 'document' or
                             rightPaneBean.clickedResource.type eq 'text' or
                             rightPaneBean.clickedResource.type eq 'website' or
                             rightPaneBean.clickedResource.type eq 'pdf' or
                             rightPaneBean.clickedResource.type eq 'video' or
                             rightPaneBean.clickedResource.type eq 'audio' or
                             rightPaneBean.clickedResource.type eq 'image' or
                             rightPaneBean.clickedResource.type eq 'glossary2' or
                             rightPaneBean.clickedResource.type eq 'survey'}">
        <ui:decorate template="/WEB-INF/templates/blocks/right-pane/preview_box.xhtml">
            <ui:param name="res" value="#{rightPaneBean.clickedResource}"/>
        </ui:decorate>
    </ui:fragment>

    <h:form prependId="false" styleClass="resource-details">
        <p:tabView dynamic="true" cache="true" prependId="false">
            <p:tab title="#{msg.details_right_pane}">
                <c:if test="${userBean.user.organisation.id eq 480}">
                    <ui:decorate template="/WEB-INF/templates/blocks/right-pane/view_resource_meta.xhtml"/>
                </c:if>

                <ui:decorate template="/WEB-INF/templates/blocks/right-pane/view_resource_details.xhtml"/>
            </p:tab>

            <p:tab title="#{msg.activity_right_pane}">
                <p:repeat value="#{rightPaneBean.clickedResource.logs}" var="logEntry" varStatus="status">
                    <ui:decorate template="/WEB-INF/templates/blocks/user/log-entry.xhtml">
                        <ui:param name="status" value="#{status}"/>
                        <ui:param name="logEntry" value="#{logEntry}"/>
                    </ui:decorate>
                </p:repeat>
            </p:tab>

            <c:if test="${not empty rightPaneBean.clickedResource.archiveUrls}">
                <p:tab title="#{msg['Archive.versions']} (#{rightPaneBean.clickedResource.archiveUrls.size()})">
                    <ui:decorate template="/WEB-INF/templates/blocks/user/archived-view.xhtml"/>
                </p:tab>
            </c:if>
        </p:tabView>
    </h:form>
</ui:fragment>

</ui:composition>
