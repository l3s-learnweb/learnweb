<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:p="http://primefaces.org/ui">

    <h:outputScript name="vendor/highcharts-v4.2.1/highcharts.js" target="head"/>

    <h:outputStylesheet name="vendor/tooltipster-v3.3.0/tooltipster.min.css"/>
    <h:outputScript name="vendor/tooltipster-v3.3.0/jquery.tooltipster.min.js" target="head"/>

    <h:outputScript name="vendor/responsive-calendar-v0.9.0/responsive-calendar.min.js" target="head"/>
    <h:outputStylesheet name="vendor/responsive-calendar-v0.9.0/responsive-calendar.css"/>

    <h:outputScript library="learnweb-layout" name="js/archive-timeline.js" target="head"/>

    <script>
        Highcharts.setOptions({
            lang: {
                months: ${rightPaneBean.monthNames},
                shortMonths: ${rightPaneBean.shortMonthNames},
                resetZoom: '#{msg.resetZoom}',
                resetZoomTitle: '#{msg.resetZoomTitle}'
            }
        });

        var no_of_versions = '#{msg.no_of_versions}';
        var timeline_title = '#{msg["Archive.timeline_title"]}';
        var timeline_series_name = '#{msg["Archive.timeline_series_name"]}';
        var msgClickZoom = '#{msg["Archive.timeline_click_zoom"]}';
        var msgTouchZoom = '#{msg["Archive.timeline_touch_zoom"]}';

        function loadCharts()
        {
            loadTimeline(#{rightPaneBean.archiveTimelineJsonData});
            loadCalendar(#{rightPaneBean.archiveCalendarJsonData});
        }

        $.fn.tooltipster('setDefaults', {
            interactive: true,
            interactiveTolerance: 150,
            theme: 'tooltipster-custom-theme'
        });

        function loadCalendar(calendar_data)
        {
            $('.responsive-calendar').responsiveCalendar({
                allRows: false,
                translateMonths: ${rightPaneBean.monthNames},
                events: calendar_data,
                onActiveDayHover: function (events)
                {
                    var thisDayEvent, key;
                    key = $(this).data('year') + '-' + addLeadingZero($(this).data('month')) + '-' + addLeadingZero($(this).data('day'));
                    thisDayEvent = events[key];
                    if (!$(this).parent().hasClass('tooltipstered'))
                    {
                        $(this).parent().tooltipster({
                            content: $(archiveVersionsList(thisDayEvent))
                        });
                    }
                    $(this).parent().tooltipster("show");
                }
            });
        }

        $(document).ready(function ()
        {
            if (document.getElementById("archive_timeline_container") != null)
                loadCharts();
        });
    </script>

    <div class="box">
        <div id="archive_timeline_container" class="collapse"></div>
        <div id="archive_timeline_calendar" class="collapse">
            <!-- Responsive calendar - START -->
            <div class="responsive-calendar">
                <div class="controls">
                    <a class="float-left" data-go="prev">
                        <h:panelGroup layout="block"  style="background-color:#489a83;border-color: #3b8b74;border-radius:2px;">
                            #{msg.previous}
                        </h:panelGroup>
                    </a>
                    <h5 class="mb-0">
                        <span id="year" data-head-year="data-head-year"></span>
                        <span id="month" data-head-month="data-head-month"></span>
                    </h5>
                    <a class="float-right" data-go="next">
                        <h:panelGroup layout="block"  style="background-color:#489a83;border-color: #3b8b74;border-radius:2px;">
                            #{msg.next}
                        </h:panelGroup>
                    </a>
                </div>
                <hr class="border-bottom"/>
                <h:panelGroup layout="block" class="day-headers">
                    <p:repeat var="day" value="${rightPaneBean.shortWeekDays}">
                        <h:panelGroup layout="block" class="day header">
                            #{day}
                        </h:panelGroup>
                    </p:repeat>
                </h:panelGroup>
                <div class="days" data-group="days">
                    <!-- the place where days will be generated -->
                </div>
            </div>
            <!-- Responsive calendar - END -->
            <div class="text-right">
                <h:outputLink onclick="return returnToTimeline();">#{msg.back_to_timeline_view}</h:outputLink>
            </div>
        </div>
    </div>

</ui:composition>	