<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
                xmlns:fn="http://xmlns.jcp.org/jsp/jstl/functions"
                xmlns:p="http://primefaces.org/ui">

<!--@elvariable id="res" type="de.l3s.learnweb.resource.Resource"-->

<c:forEach var="field" items="#{userBean.user.organisation.metadataFields}">
    <div class="form-group">
        <c:if test="#{fn:startsWith(field.type, 'FULLWIDTH_')}">
            <div class="col-sm-12">
                <c:if test="#{field.type eq 'FULLWIDTH_HEADER'}">
                    <h4><h:outputText value="#{utilBean.getLocaleMessage(field.label, null)}"/></h4>
                </c:if>
                <c:if test="#{field.type eq 'FULLWIDTH_DESCRIPTION'}">
                    <h5><h:outputText value="#{utilBean.getLocaleMessage(field.label, null)}"/></h5>
                </c:if>
            </div>
        </c:if>

        <c:if test="#{not fn:startsWith(field.type, 'FULLWIDTH_')}">
            <p:outputLabel for="@next" value="#{utilBean.getLocaleMessage(field.name, null)}:"/>
            <c:if test="#{field.moderatorOnly and not userBean.moderator}">
                <h:outputText value="#{res.metadataWrapper[field.name]}"/>
            </c:if>

            <c:if test="#{not field.moderatorOnly or userBean.moderator}">
                <c:if test="#{field.type eq 'INPUT_TEXT'}">
                    <p:inputText id="input_#{field.name}" title="#{field.info}" required="#{field.required}"
                                 value="#{res.metadataWrapper[field.name]}"/>
                    <p:tooltip for="input_#{field.name}" showEvent="focus" hideEvent="blur" position="left" rendered="#{not empty field.info}"/>
                </c:if>

                <c:if test="#{field.type eq 'INPUT_TEXTAREA'}">
                    <p:inputTextarea id="input_area_#{field.name}" title="#{field.info}" required="#{field.required}"
                                     value="#{res.metadataWrapper[field.name]}" rows="4" autoResize="false" />
                    <p:tooltip for="input_area_#{field.name}" showEvent="focus" hideEvent="blur" position="left" rendered="#{not empty field.info}"/>
                </c:if>

                <c:if test="#{field.type eq 'ONE_MENU' or field.type eq 'ONE_MENU_EDITABLE'}">
                    <p:selectOneMenu id="input_selectone_#{field.name}" title="#{field.info}" required="#{field.required}"
                                     value="#{res.metadataWrapper[field.name]}" editable="#{field.type eq 'ONE_MENU_EDITABLE'}">
                        <f:selectItems value="#{field.optionsList}"/>
                    </p:selectOneMenu>
                    <p:tooltip for="input_selectone_#{field.name}" position="left" rendered="#{not empty field.info}"/>
                </c:if>

                <c:if test="#{field.type eq 'MULTIPLE_MENU'}">
                    <p:selectCheckboxMenu id="input_selectmultiple_#{field.name}" title="#{field.info}" required="#{field.required}"
                                          value="#{res.metadataMultiValue[field.name]}" multiple="true"
                                          filter="#{field.options.size() gt 8}" filterMatchMode="startsWith">
                        <f:selectItems value="#{field.optionsList}"/>
                    </p:selectCheckboxMenu>
                    <p:tooltip for="input_selectmultiple_#{field.name}" position="left" rendered="#{not empty field.info}"/>
                </c:if>

                <c:if test="#{field.type eq 'AUTOCOMPLETE'}">
                    <p:autoComplete id="input_complete_#{field.name}" title="#{field.info}" required="#{field.required}"
                                    value="#{res.metadataWrapper[field.name]}" completeMethod="#{field.completeText}"/>
                    <p:tooltip for="input_complete_#{field.name}" showEvent="focus" hideEvent="blur" position="left" rendered="#{not empty field.info}" />
                </c:if>

                <c:if test="#{field.type eq 'AUTOCOMPLETE_MULTIPLE'}">
                    <p:autoComplete id="input_complete_multi_#{field.name}" title="#{field.info}" required="#{field.required}"
                                    dropdown="true" multiple="true" dynamic="true" global="false" cache="true"
                                    value="#{res.metadataMultiValueList[field.name]}" completeMethod="#{field.completeText}"/>
                    <p:tooltip for="input_complete_multi_#{field.name}" showEvent="focus" hideEvent="blur" position="left" rendered="#{not empty field.info}" />
                </c:if>
            </c:if>
            <p:message for="@previous"/>
        </c:if>
    </div>
</c:forEach>

<ui:fragment rendered="#{userBean.optionContentAnnotationFieldEnabled and res.type eq 'website'}">
    <div class="form-group">
        <p:outputLabel for="@next" value="#{msg.content}:"/>
        <p:inputTextarea value="#{res.transcript}" rows="6" autoResize="false"/>
        <p:message for="@previous"/>
    </div>
</ui:fragment>

</ui:composition>
