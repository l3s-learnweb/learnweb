<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui">

    <div class="layout-topbar d-flex flex-row align-items-center bg-primary">
        <div class="d-flex mr-auto">
            <ui:fragment rendered="#{userBean.loggedIn}">
                <a id="menu-button" class="topbar-element" href="#">
                    <i class="fa fa-align-left"/>
                </a>
            </ui:fragment>
            <a href="#{request.contextPath}/lw/myhome/welcome.jsf" class="topbar-element logo">
                <i class="lw lw-logo"></i>
            </a>
        </div>

        <ui:fragment rendered="#{userBean.loggedIn}">
            <div class="d-flex order-1 order-md-0 search-wrapper">
                <form action="#{request.contextPath}/lw/search.jsf" class="topbar-element search-form w-100" onsubmit="removeViewstate(this);">
                    <input type="hidden" name="action" value="#{searchBean.queryMode}"/>
                    <input type="search" name="query" value="#{searchBean.query}" placeholder="#{msg.searchLabel}"/>

                    <button id="searchbutton" title="#{msg.searchLabel}">
                        <i class="fa fa-search" aria-hidden="true"></i>
                    </button>
                </form>
            </div>
        </ui:fragment>

        <h:form styleClass="d-flex">
            <a href="#{request.contextPath}/lw/myhome/notification.jsf" class="topbar-element">
                <i class="fa fa-bell"/>
            </a>

            <ui:fragment rendered="#{userBean.languageSwitchEnabled}">
                <p:commandLink id="languageSwitchButton" styleClass="topbar-element topbar-lang-button">
                    <img src="#{request.contextPath}/resources/images/flags/flag_#{userBean.localeCode}.png" alt="Language switch"/>
                </p:commandLink>

                <p:menu overlay="true" trigger="languageSwitchButton" my="right bottom" at="right top" styleClass="ui-menu-overlay">
                    <p:menuitem action="#{userBean.setLocaleCode('de')}">
                        <img src="#{request.contextPath}/resources/images/flags/flag_de.png" alt=""/><span>Deutsch</span>
                    </p:menuitem>
                    <p:menuitem action="#{userBean.setLocaleCode('en')}">
                        <img src="#{request.contextPath}/resources/images/flags/flag_en.png" alt=""/><span>English</span>
                    </p:menuitem>
                    <p:menuitem action="#{userBean.setLocaleCode('it')}">
                        <img src="#{request.contextPath}/resources/images/flags/flag_it.png" alt=""/><span>Italiano</span>
                    </p:menuitem>
                    <p:menuitem action="#{userBean.setLocaleCode('pt')}">
                        <img src="#{request.contextPath}/resources/images/flags/flag_pt.png" alt=""/><span>PortuguÃªs</span>
                    </p:menuitem>
                    <p:menuitem action="#{userBean.setLocaleCode('xx')}" rendered="#{userBean.admin}">
                        <img src="#{request.contextPath}/resources/images/flags/flag_xx.png" alt=""/><span>Developer</span>
                    </p:menuitem>
                </p:menu>
            </ui:fragment>

            <ui:fragment rendered="#{userBean.languageSwitchEnabled}">
                <p:commandLink id="userMenuButton" styleClass="topbar-element topbar-menu-button">
                    <img src="${learnwebBean.getProfileImage(profileBean.selectedUser)}" class="rounded-circle" alt="Profile"/>
                </p:commandLink>

                <p:menu overlay="true" trigger="userMenuButton" my="right bottom" at="right top" styleClass="ui-menu-overlay">
                    <p:menuitem url="#{request.contextPath}/lw/myhome/profile.jsf" icon="fa fa-fw fa-user" value="#{msg.profile}" />
                    <p:menuitem url="#{request.contextPath}/lw/admin/dashboard/user.jsf" icon="fa fa-fw fa-table" value="#{msg.myDashboardTitle}" />
                    <p:menuitem url="#{request.contextPath}/lw/searchHistory/entityRelationship.jsf?user_id=#{userBean.user.id}" icon="fa fa-fw fa-history" value="#{msg.search_history}" />
                    <p:menuitem action="#{loginBean.logout}" icon="fa fa-fw fa-sign-out" value="#{msg.logout}" />
                </p:menu>
            </ui:fragment>
        </h:form>
    </div>
</ui:composition>
