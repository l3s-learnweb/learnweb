<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:p="http://primefaces.org/ui">

    <header class="layout-header bg-primary">
        <div class="layout-container d-flex flex-row align-items-center">
            <div class="d-flex mr-auto">
                <ui:fragment rendered="#{userBean.loggedIn}">
                    <a href="#" id="menu-button" class="header-element menu-button">
                        <i class="fa fa-align-left"></i>
                    </a>
                </ui:fragment>
                <a href="#{request.contextPath}/lw/myhome/welcome.jsf" class="header-element logo d-none-mobile">
                    <i class="lw lw-logo"></i>
                </a>
            </div>

            <ui:fragment rendered="#{userBean.loggedIn}">
                <div class="d-flex order-1 order-md-0 search-wrapper">
                    <form action="#{request.contextPath}/lw/search.jsf" class="header-element no-hover-bg search-form w-100" onsubmit="removeViewstate(this);">
                        <input type="hidden" name="action" value="#{searchBean.queryMode}"/>
                        <input type="search" name="query" value="#{searchBean.query}" placeholder="#{msg.searchLabel}"/>

                        <button id="searchbutton" title="#{msg.searchLabel}">
                            <i class="fa fa-search" aria-hidden="true"></i>
                        </button>
                    </form>
                </div>
            </ui:fragment>

            <h:form styleClass="d-flex">
                <h:outputLink value="#{request.contextPath}/lw/myhome/notification.jsf" styleClass="header-element" rendered="#{userBean.loggedIn}">
                    <i class="fa fa-bell"></i>
                </h:outputLink>

                <ui:fragment rendered="#{userBean.languageSwitchEnabled}">
                    <h:outputLink id="languageSwitchButton" styleClass="header-element lang-button" onclick="return false;">
                        <img src="#{request.contextPath}/resources/images/flags/flag_#{userBean.localeCode}.png" alt="Language switch"/>
                    </h:outputLink>

                    <p:menu overlay="true" trigger="languageSwitchButton" my="right bottom" at="right top" styleClass="ui-menu-navbar-submenu ui-menu-primary">
                        <p:menuitem action="#{userBean.setLocaleCode('de')}">
                            <img src="#{request.contextPath}/resources/images/flags/flag_de.png" alt=""/><span>Deutsch</span>
                        </p:menuitem>
                        <p:menuitem action="#{userBean.setLocaleCode('en')}">
                            <img src="#{request.contextPath}/resources/images/flags/flag_en.png" alt=""/><span>English</span>
                        </p:menuitem>
                        <p:menuitem action="#{userBean.setLocaleCode('it')}">
                            <img src="#{request.contextPath}/resources/images/flags/flag_it.png" alt=""/><span>Italiano</span>
                        </p:menuitem>
                        <p:menuitem action="#{userBean.setLocaleCode('pt')}">
                            <img src="#{request.contextPath}/resources/images/flags/flag_pt.png" alt=""/><span>PortuguÃªs</span>
                        </p:menuitem>
                        <p:menuitem action="#{userBean.setLocaleCode('xx')}" rendered="#{userBean.admin}">
                            <img src="#{request.contextPath}/resources/images/flags/flag_xx.png" alt=""/><span>Developer</span>
                        </p:menuitem>
                    </p:menu>
                </ui:fragment>

                <ui:fragment rendered="#{userBean.loggedIn}">
                    <h:outputLink id="userMenuButton" styleClass="header-element usermenu-button" ariaLabel="Profile" onclick="return false;">
                        <img src="${learnwebBean.getProfileImage(userBean.user)}" class="profile-picture" alt="" title="#{userBean.user.fullName}"/>
                    </h:outputLink>

                    <p:menu overlay="true" trigger="userMenuButton" my="right bottom" at="right top" styleClass="ui-menu-navbar-submenu ui-menu-primary">
                        <p:menuitem url="#{request.contextPath}/lw/myhome/profile.jsf" icon="fa fa-fw fa-user" value="#{msg.profile}" />
                        <p:menuitem url="#{request.contextPath}/lw/admin/dashboard/user.jsf" icon="fa fa-fw fa-table" value="#{msg.myDashboardTitle}" />
                        <p:menuitem url="#{request.contextPath}/lw/searchHistory/entityRelationship.jsf?user_id=#{userBean.user.id}" icon="fa fa-fw fa-history" value="#{msg.search_history}" />
                        <p:menuitem action="#{loginBean.logout}" icon="fa fa-fw fa-sign-out" value="#{msg.logout}" />
                    </p:menu>
                </ui:fragment>
            </h:form>
        </div>
    </header>

</ui:composition>
