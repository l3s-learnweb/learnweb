<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:pt="http://xmlns.jcp.org/jsf/passthrough">

    <header class="layout-header bg-primary">
        <div class="layout-container d-flex">
            <div class="d-flex layout-combined-loader">
                <ui:fragment rendered="#{userBean.loggedIn}">
                    <a href="#{userBean.bannerLink}" id="menu-button" class="header-element menu-button">
                        <i class="fa fa-bars mx-auto content-element" aria-hidden="true"></i>
                        <div class="la-ball-clip-rotate-pulse mx-auto loader-element collapse">
                            <div></div>
                            <div></div>
                        </div>
                    </a>
                </ui:fragment>
                <a href="#{userBean.bannerLink}" class="header-element header-logo no-hover-bg">
                    <h:graphicImage library="images" name="#{userBean.bannerImage}" alt="#{msg['application.name']} logo" styleClass="w-100"/>
                </a>
            </div>

            <h:panelGroup layout="block" styleClass="d-flex order-1 order-md-0 search-wrapper flex-grow-1" rendered="#{userBean.loggedIn}">
                <form class="header-element no-hover-bg search-form w-100" action="#{request.contextPath}/lw/search.jsf" method="get">
                    <label for="searchfield" class="d-none">#{msg.searchLabel}</label>
                    <input type="search" id="searchfield" name="query" placeholder="#{msg.searchLabel}"/>

                    <p:button title="#{msg.searchLabel}" icon="fa fa-search" onclick="$(this).parent('form').submit();return false;"/>
                </form>

                <h:form rendered="#{learnwebBean.developmentMode}">
                    <p:lifecycle/>
                </h:form>
            </h:panelGroup>


            <h:form id="header_right" styleClass="d-flex ml-auto">
                <h:outputLink value="#{request.contextPath}/lw/myhome/notification.jsf" styleClass="header-element" rendered="#{userBean.loggedIn}">
                    <i class="fa fa-envelope-o #{messageBean.howManyNewMessages gt 0 ? ' has-badge' : null}" data-count="#{messageBean.howManyNewMessages}" aria-hidden="true"></i>
                </h:outputLink>

				<ui:include src="language_switch.xhtml"/>

                <ui:fragment rendered="#{userBean.loggedIn}">
                    <h:outputLink value="#{userBean.bannerLink}" id="userMenuButton" styleClass="header-element usermenu-button" ariaLabel="Profile" onclick="return false;">
                        <img src="${learnwebBean.getProfileImage(userBean.user)}" class="profile-picture" alt="" title="#{userBean.user.fullName}"/>
                    </h:outputLink>

                    <p:menu overlay="true" trigger="userMenuButton" my="right bottom" at="right top" styleClass="ui-menu-navbar-submenu ui-menu-primary">
                        <p:menuitem url="#{request.contextPath}/lw/user/detail.jsf?user_id=#{userBean.user.id}" icon="fa fa-fw fa-user" value="#{msg.myProfileTitle}"/>
                        <p:menuitem url="#{request.contextPath}/lw/myhome/profile.jsf" icon="fa fa-fw fa-cog" styleClass="guide-profile-page" value="#{msg.settings}"/>
                        <p:menuitem url="#{request.contextPath}/lw/dashboard/index.jsf" icon="fa fa-fw fa-table" value="#{msg.myDashboardTitle}"/>
                        <p:menuitem url="#{request.contextPath}/lw/myhome/search_history.jsf" icon="fa fa-fw fa-history" value="#{msg['search_history.title']}"/>
                        <p:menuitem action="#{loginBean.logout}" icon="fa fa-fw fa-sign-out" value="#{msg.logout}"/>
                    </p:menu>
                </ui:fragment>
            </h:form>
        </div>
    </header>


</ui:composition>
