<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:p="http://primefaces.org/ui">

    <nav class="navbar sticky-top navbar-main navbar-dark bg-primary shadow">
        <h:form id="navbar_form" styleClass="container-fluid align-items-stretch">
            <div class="d-flex layout-combined-loader">
                <ui:fragment rendered="#{userBean.loggedIn}">
                    <a class="navbar-menu fs-1 lh-1" href="#" id="menu-button">
                        <i class="fas fa-bars mx-auto content-element" data-count="#{messageBean.howManyNewMessages}" aria-hidden="true"></i>
                        <span class="la-ball-clip-rotate-pulse mx-auto loader-element collapse">
                            <span></span>
                            <span></span>
                        </span>
                    </a>
                </ui:fragment>

                <a href="#{userBean.bannerLink}" class="navbar-brand d-flex align-items-center">
                    <h:graphicImage value="#{userBean.bannerImage}" alt="#{msg['application.name']} logo"/>
                </a>
            </div>

            <div class="d-flex align-items-center navbar-search flex-grow-1 mx-md-2">
                <p:outputLabel for="@next" styleClass="d-none" value="#{msg.searchLabel}"/>
                <p:inputText id="searchfield" placeholder="#{msg.searchLabel}" type="search"/>
                <p:commandButton title="#{msg.searchLabel}" icon="fas fa-search"
                                 onclick="window.location.href = 'search.jsf?query=' + $('#navbar_form\\:searchfield').val();return false;"/>
            </div>

            <ul class="navbar-nav ms-auto">
                <ui:fragment rendered="#{userBean.loggedIn}">
                    <li class="nav-item"><a class="nav-link fs-1 lh-1" href="#{request.contextPath}/lw/myhome/notification.jsf">
                        <i class="fas fa-envelope #{messageBean.howManyNewMessages gt 0 ? ' has-badge' : null}" data-count="#{messageBean.howManyNewMessages}" aria-hidden="true"></i>
                    </a></li>
                </ui:fragment>

                <ui:include src="language_switch.xhtml"/>

                <ui:fragment rendered="#{userBean.loggedIn}">
                    <li class="nav-item dropdown">
                        <a class="nav-link nav-link-profile" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            <img src="${userBean.user.imageUrl}" class="profile-picture rounded-circle" alt="Profile picture" title="#{userBean.user.fullName}"/>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-dark dropdown-menu-end" aria-labelledby="userDropdown">
                            <li><a href="#{request.contextPath}/lw/user/detail.jsf?user_id=#{userBean.user.id}" class="dropdown-item">
                                <i class="fas fa-fw fa-portrait" aria-hidden="true"></i> #{msg.myProfileTitle}
                            </a></li>
                            <li><a href="#{request.contextPath}/lw/myhome/profile.jsf" class="dropdown-item guide-profile-page">
                                <i class="fas fa-fw fa-user-cog" aria-hidden="true"></i> #{msg.settings}
                            </a></li>
                            <li><a href="#{request.contextPath}/lw/dashboard/index.jsf" class="dropdown-item">
                                <i class="fas fa-fw fa-tachometer-alt" aria-hidden="true"></i> #{msg.myDashboardTitle}
                            </a></li>
                            <li><a href="#{request.contextPath}/lw/myhome/search_history.jsf" class="dropdown-item">
                                <i class="fas fa-fw fa-history" aria-hidden="true"></i> #{msg['search_history.title']}
                            </a></li>
                            <ui:fragment rendered="#{userBean.eyesTrackingEnabled or config.development}">
                                <li><a href="#{request.contextPath}/lw/calibrate.jsf" class="dropdown-item">
                                    <i class="fas fa-fw fa-eye" aria-hidden="true"></i> Calibrate Eyes Tracker
                                </a></li>
                            </ui:fragment>
                            <li><h:commandLink action="#{loginBean.logout}" styleClass="dropdown-item">
                                <i class="fas fa-fw fa-sign-out-alt" aria-hidden="true"></i> #{msg.logout}
                            </h:commandLink></li>
                        </ul>
                    </li>
                </ui:fragment>
            </ul>
        </h:form>
    </nav>

</ui:composition>
